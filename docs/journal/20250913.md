# 作業履歴 2025-09-13

## 概要

2025-09-13の作業内容をまとめています。

## コミット: d8e9601

### メッセージ

```
style: レジストリクラスのコードフォーマット改善
- GenericShardingMessageExtractorにShardingEnvelopeのimportを追加
- クラス定義のフォーマットを改善
- 不要な空行を削除
- scalafmtによる自動フォーマット適用
```

### 変更されたファイル

- M	modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/registry/GenericClusterSharding.scala
- M	modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/registry/GenericShardingMessageExtractor.scala

### 変更内容

```diff
commit d8e9601ffb3aa4676fb9b8ecf6e31c8a2f4b346d
Author: Junichi Kato <j5ik2o@gmail.com>
Date:   Sat Sep 13 20:06:11 2025 +0900

    style: レジストリクラスのコードフォーマット改善
    
    - GenericShardingMessageExtractorにShardingEnvelopeのimportを追加
    - クラス定義のフォーマットを改善
    - 不要な空行を削除
    - scalafmtによる自動フォーマット適用

diff --git a/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/registry/GenericClusterSharding.scala b/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/registry/GenericClusterSharding.scala
index 59f247a..18cca6a 100644
--- a/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/registry/GenericClusterSharding.scala
+++ b/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/registry/GenericClusterSharding.scala
@@ -206,5 +206,3 @@ object GenericClusterSharding {
     clusterSharding.entityRefFor(typeKey, aggregateId.asString)
   }
 }
-
-
diff --git a/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/registry/GenericShardingMessageExtractor.scala b/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/registry/GenericShardingMessageExtractor.scala
index 5a3db3e..667d599 100644
--- a/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/registry/GenericShardingMessageExtractor.scala
+++ b/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/registry/GenericShardingMessageExtractor.scala
@@ -1,23 +1,24 @@
 package io.github.j5ik2o.pcqrses.command.interfaceAdapter.registry
 
 import io.github.j5ik2o.pcqrses.command.domain.support.EntityId
+import org.apache.pekko.cluster.sharding.typed.ShardingEnvelope
 
 /**
  * 汎用メッセージエクストラクター メッセージから集約IDとシャードIDを抽出
  *
  * @param numberOfShards
- * シャード数
+ *   シャード数
  * @tparam ID
- * 集約IDの型
+ *   集約IDの型
  * @tparam CMD
- * コマンドの型
+ *   コマンドの型
  */
-private class GenericShardingMessageExtractor[ID <: EntityId, CMD <: {def id: ID}](
-                                                                                    numberOfShards: Int
-                                                                                  ) extends org.apache.pekko.cluster.sharding.typed.ShardingMessageExtractor[
-  ShardingEnvelope[CMD],
-  CMD
-] {
+private[registry] class GenericShardingMessageExtractor[ID <: EntityId, CMD <: { def id: ID }](
+  numberOfShards: Int
+) extends org.apache.pekko.cluster.sharding.typed.ShardingMessageExtractor[
+    ShardingEnvelope[CMD],
+    CMD
+  ] {
 
   override def entityId(envelope: ShardingEnvelope[CMD]): String =
     envelope.entityId

```

## コミット: 2a233da

### メッセージ

```
refactor: レジストリとドメインクラスのコード改善
- ドメインValueObjectsのbreachEncapsulationメソッドを追加
- レジストリクラスのimportを整理
- ActorSpecのコードフォーマットを改善
- 不要なコメントとデバッグコードを削除
```

### 変更されたファイル

- M	modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/FirstName.scala
- M	modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/LastName.scala
- M	modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/UserAccount.scala
- M	modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/UserAccountName.scala
- M	modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/aggregate/users/UserAccountSnapshotSerializer.scala
- M	modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/registry/GenericClusterSharding.scala
- M	modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/registry/GenericLocalRegistry.scala
- M	modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/registry/GenericRegistry.scala
- M	modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/registry/GenericShardingMessageExtractor.scala
- M	modules/command/interface-adapter/src/test/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/test/ActorSpec.scala

### 変更内容

```diff
commit 2a233dac144b0b9051a086fda467a2babd7ab987
Author: Junichi Kato <j5ik2o@gmail.com>
Date:   Sat Sep 13 20:02:59 2025 +0900

    refactor: レジストリとドメインクラスのコード改善
    
    - ドメインValueObjectsのbreachEncapsulationメソッドを追加
    - レジストリクラスのimportを整理
    - ActorSpecのコードフォーマットを改善
    - 不要なコメントとデバッグコードを削除

diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/FirstName.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/FirstName.scala
index 5941e8e..1b3d31a 100644
--- a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/FirstName.scala
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/FirstName.scala
@@ -10,11 +10,13 @@ object FirstName {
     case Left(e) => throw new IllegalArgumentException(e.message)
   }
 
+  def unapply(self: FirstName): Option[String] = Some(self.asString)
+
   def parseFromString(value: String): Either[FirstNameError, FirstName] =
     if (value.length > 256) Left(FirstNameError.TooLong)
     else Right(FirstNameImpl(value))
 
-  private case class FirstNameImpl(value: String) extends FirstName {
+  private final case class FirstNameImpl(value: String) extends FirstName {
     override def asString: String = value
   }
 }
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/LastName.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/LastName.scala
index dc5cf68..a386506 100644
--- a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/LastName.scala
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/LastName.scala
@@ -10,11 +10,13 @@ object LastName {
     case Left(e) => throw new IllegalArgumentException(e.message)
   }
 
+  def unapply(self: LastName): Option[String] = Some(self.asString)
+
   def parseFromString(value: String): Either[LastNameError, LastName] =
     if (value.length > 256) Left(LastNameError.TooLong)
     else Right(LastNameImpl(value))
 
-  private case class LastNameImpl(value: String) extends LastName {
+  private final case class LastNameImpl(value: String) extends LastName {
     override def asString: String = value
   }
 }
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/UserAccount.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/UserAccount.scala
index cc4cdb8..b609199 100644
--- a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/UserAccount.scala
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/UserAccount.scala
@@ -32,6 +32,7 @@ object UserAccount {
         emailAddress = emailAddress,
         occurredAt = DateTime.now()
       ))
+
   def unapply(
     self: UserAccount): Option[(UserAccountId, UserAccountName, EmailAddress, DateTime, DateTime)] =
     Some((self.id, self.name, self.emailAddress, self.createdAt, self.updatedAt))
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/UserAccountName.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/UserAccountName.scala
index 78bf390..1fefa7c 100644
--- a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/UserAccountName.scala
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/UserAccountName.scala
@@ -9,6 +9,7 @@ trait UserAccountName {
 object UserAccountName {
   def apply(firstName: FirstName, lastName: LastName): UserAccountName =
     UserAccountNameImpl(firstName, lastName)
+
   def unapply(self: UserAccountName): Option[(FirstName, LastName)] =
     Some((self.breachEncapsulationOfFirstName, self.breachEncapsulationOfLastName))
 
diff --git a/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/aggregate/users/UserAccountSnapshotSerializer.scala b/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/aggregate/users/UserAccountSnapshotSerializer.scala
index 02686ed..c9547df 100644
--- a/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/aggregate/users/UserAccountSnapshotSerializer.scala
+++ b/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/aggregate/users/UserAccountSnapshotSerializer.scala
@@ -15,11 +15,7 @@ import io.github.j5ik2o.pcqrses.command.domain.users.{
   UserAccountId as DomainUserAccountId,
   UserAccountName as DomainUserAccountName
 }
-import UserAccountAggregateState.{
-  Created,
-  Deleted,
-  NotCreated
-}
+import UserAccountAggregateState.{Created, Deleted, NotCreated}
 import org.apache.pekko.serialization.SerializerWithStringManifest
 
 class UserAccountSnapshotSerializer extends SerializerWithStringManifest {
diff --git a/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/registry/GenericClusterSharding.scala b/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/registry/GenericClusterSharding.scala
index 9a464aa..59f247a 100644
--- a/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/registry/GenericClusterSharding.scala
+++ b/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/registry/GenericClusterSharding.scala
@@ -1,6 +1,6 @@
-package com.precena.macaron.command.interfaceAdapter.registry
+package io.github.j5ik2o.pcqrses.command.interfaceAdapter.registry
 
-import com.precena.macaron.domain.support.AggregateId
+import io.github.j5ik2o.pcqrses.command.domain.support.EntityId
 import org.apache.pekko.actor.typed.{ActorRef, ActorSystem, Behavior}
 import org.apache.pekko.actor.typed.scaladsl.Behaviors
 import org.apache.pekko.cluster.sharding.typed.ShardingEnvelope
@@ -65,7 +65,7 @@ object GenericClusterSharding {
    * @return
    *   シャーディングエンベロープのActorRef
    */
-  def init[ID <: AggregateId, CMD <: { def id: ID } : ClassTag](
+  def init[ID <: EntityId, CMD <: { def id: ID } : ClassTag](
     aggregateName: String,
     clusterSharding: ClusterSharding,
     aggregateBehavior: ID => Behavior[CMD],
@@ -165,7 +165,7 @@ object GenericClusterSharding {
    * @return
    *   プロキシBehavior
    */
-  def ofProxy[ID <: AggregateId, CMD <: { def id: ID } : ClassTag](
+  def ofProxy[ID <: EntityId, CMD <: { def id: ID } : ClassTag](
     aggregateName: String,
     clusterSharding: ClusterSharding
   ): Behavior[CMD] =
@@ -197,7 +197,7 @@ object GenericClusterSharding {
    * @return
    *   集約への参照
    */
-  def entityRefFor[ID <: AggregateId, CMD <: { def id: ID } : ClassTag](
+  def entityRefFor[ID <: EntityId, CMD <: { def id: ID } : ClassTag](
     aggregateName: String,
     clusterSharding: ClusterSharding,
     aggregateId: ID
@@ -207,32 +207,4 @@ object GenericClusterSharding {
   }
 }
 
-/**
- * 汎用メッセージエクストラクター メッセージから集約IDとシャードIDを抽出
- *
- * @param numberOfShards
- *   シャード数
- * @tparam ID
- *   集約IDの型
- * @tparam CMD
- *   コマンドの型
- */
-private class GenericShardingMessageExtractor[ID <: AggregateId, CMD <: { def id: ID }](
-  numberOfShards: Int
-) extends org.apache.pekko.cluster.sharding.typed.ShardingMessageExtractor[
-    ShardingEnvelope[CMD],
-    CMD
-  ] {
-
-  override def entityId(envelope: ShardingEnvelope[CMD]): String =
-    envelope.entityId
-
-  override def shardId(entityId: String): String = {
-    // エンティティIDのハッシュ値を使用してシャードIDを決定
-    val shardNumber = math.abs(entityId.hashCode) % numberOfShards
-    shardNumber.toString
-  }
 
-  override def unwrapMessage(envelope: ShardingEnvelope[CMD]): CMD =
-    envelope.message
-}
diff --git a/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/registry/GenericLocalRegistry.scala b/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/registry/GenericLocalRegistry.scala
index 78f34ed..5e505ef 100644
--- a/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/registry/GenericLocalRegistry.scala
+++ b/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/registry/GenericLocalRegistry.scala
@@ -1,8 +1,9 @@
-package com.precena.macaron.command.interfaceAdapter.registry
+package io.github.j5ik2o.pcqrses.command.interfaceAdapter.registry
 
-import com.precena.macaron.domain.support.AggregateId
+import io.github.j5ik2o.pcqrses.command.domain.support.EntityId
 import org.apache.pekko.actor.typed.scaladsl.Behaviors
 import org.apache.pekko.actor.typed.{ActorRef, Behavior}
+
 import scala.reflect.Selectable.reflectiveSelectable
 
 /**
@@ -28,7 +29,7 @@ object GenericLocalRegistry {
    * @return
    *   レジストリのBehavior
    */
-  def create[ID <: AggregateId, CMD <: { def id: ID }](
+  def create[ID <: EntityId, CMD <: { def id: ID }](
     name: String
   )(
     nameF: ID => String
diff --git a/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/registry/GenericRegistry.scala b/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/registry/GenericRegistry.scala
index 4b2bb52..ff0596b 100644
--- a/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/registry/GenericRegistry.scala
+++ b/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/registry/GenericRegistry.scala
@@ -1,8 +1,9 @@
-package com.precena.macaron.command.interfaceAdapter.registry
+package io.github.j5ik2o.pcqrses.command.interfaceAdapter.registry
 
-import com.precena.macaron.domain.support.AggregateId
+import io.github.j5ik2o.pcqrses.command.domain.support.EntityId
 import org.apache.pekko.actor.typed.{ActorSystem, Behavior}
 import org.apache.pekko.cluster.sharding.typed.scaladsl.ClusterSharding
+
 import scala.reflect.ClassTag
 import scala.util.Try
 import scala.concurrent.duration.FiniteDuration
@@ -46,7 +47,7 @@ object GenericRegistry {
    * @return
    *   レジストリのBehavior
    */
-  def create[ID <: AggregateId, CMD <: { def id: ID } : ClassTag](
+  def create[ID <: EntityId, CMD <: { def id: ID } : ClassTag](
     aggregateName: String,
     mode: Mode = Mode.LocalMode,
     idleTimeout: Option[FiniteDuration] = None,
diff --git a/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/registry/GenericShardingMessageExtractor.scala b/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/registry/GenericShardingMessageExtractor.scala
index e8644f1..5a3db3e 100644
--- a/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/registry/GenericShardingMessageExtractor.scala
+++ b/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/registry/GenericShardingMessageExtractor.scala
@@ -1,5 +1,7 @@
 package io.github.j5ik2o.pcqrses.command.interfaceAdapter.registry
 
+import io.github.j5ik2o.pcqrses.command.domain.support.EntityId
+
 /**
  * 汎用メッセージエクストラクター メッセージから集約IDとシャードIDを抽出
  *
diff --git a/modules/command/interface-adapter/src/test/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/test/ActorSpec.scala b/modules/command/interface-adapter/src/test/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/test/ActorSpec.scala
index 2da602a..cfd82d1 100644
--- a/modules/command/interface-adapter/src/test/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/test/ActorSpec.scala
+++ b/modules/command/interface-adapter/src/test/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/test/ActorSpec.scala
@@ -37,20 +37,18 @@ abstract class ActorSpec(testKit: ActorTestKit)
 
   def this() = this(ActorTestKit(ActorTestKitBase.testNameFromCallStack()))
 
-  def this(config: String) = {
+  def this(config: String) =
     this(
       ActorTestKit(
         ActorTestKitBase.testNameFromCallStack(),
         ConfigFactory.parseString(config)
       )
     )
-  }
 
-  def this(config: Config) = {
+  def this(config: Config) =
     this(ActorTestKit(ActorTestKitBase.testNameFromCallStack(), config))
-  }
 
-  def this(config: Config, settings: TestKitSettings) = {
+  def this(config: Config, settings: TestKitSettings) =
     this(
       ActorTestKit(
         ActorTestKitBase.testNameFromCallStack(),
@@ -58,7 +56,6 @@ abstract class ActorSpec(testKit: ActorTestKit)
         settings
       )
     )
-  }
 
   implicit def classicSystem: ActorSystem = system.toClassic
 

```

## コミット: 95796c6

### メッセージ

```
feat: アクターレジストリシステムの実装を追加
Pekko ClusterShardingとローカルモードの両方に対応した
汎用的なアクターレジストリシステムを実装：

- GenericRegistry: レジストリの抽象基底trait
- GenericLocalRegistry: ローカルモード用の実装
- GenericClusterSharding: クラスターシャーディング用の実装
- GenericShardingMessageExtractor: メッセージ抽出器

これにより、環境に応じてローカル/クラスター構成を
切り替え可能なアーキテクチャを実現
```

### 変更されたファイル

- A	modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/registry/GenericClusterSharding.scala
- A	modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/registry/GenericLocalRegistry.scala
- A	modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/registry/GenericRegistry.scala
- A	modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/registry/GenericShardingMessageExtractor.scala

### 変更内容

```diff
commit 95796c6f80b3f33da265e18ee14d55de8999b033
Author: Junichi Kato <j5ik2o@gmail.com>
Date:   Sat Sep 13 20:02:33 2025 +0900

    feat: アクターレジストリシステムの実装を追加
    
    Pekko ClusterShardingとローカルモードの両方に対応した
    汎用的なアクターレジストリシステムを実装：
    
    - GenericRegistry: レジストリの抽象基底trait
    - GenericLocalRegistry: ローカルモード用の実装
    - GenericClusterSharding: クラスターシャーディング用の実装
    - GenericShardingMessageExtractor: メッセージ抽出器
    
    これにより、環境に応じてローカル/クラスター構成を
    切り替え可能なアーキテクチャを実現

diff --git a/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/registry/GenericClusterSharding.scala b/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/registry/GenericClusterSharding.scala
new file mode 100644
index 0000000..9a464aa
--- /dev/null
+++ b/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/registry/GenericClusterSharding.scala
@@ -0,0 +1,238 @@
+package com.precena.macaron.command.interfaceAdapter.registry
+
+import com.precena.macaron.domain.support.AggregateId
+import org.apache.pekko.actor.typed.{ActorRef, ActorSystem, Behavior}
+import org.apache.pekko.actor.typed.scaladsl.Behaviors
+import org.apache.pekko.cluster.sharding.typed.ShardingEnvelope
+import org.apache.pekko.cluster.sharding.typed.scaladsl.{
+  ClusterSharding,
+  Entity,
+  EntityContext,
+  EntityTypeKey
+}
+
+import scala.concurrent.duration.*
+import scala.reflect.ClassTag
+import scala.reflect.Selectable.reflectiveSelectable
+import scala.util.{Failure, Success, Try}
+
+/**
+ * クラスターモードで集約アクターを分散管理する汎用シャーディング設定
+ *
+ * このオブジェクトは以下の責務を持つ：
+ *   - クラスターシャーディングの初期化と設定
+ *   - 集約のライフサイクル管理（パッシベーション）
+ *   - シャーディングプロキシによるメッセージルーティング
+ */
+object GenericClusterSharding {
+
+  /**
+   * デフォルトのアイドルタイムアウト
+   */
+  final val DefaultIdleTimeout: FiniteDuration = 120.seconds
+
+  /**
+   * アイドルタイムアウトを無効化するための特別な値
+   */
+  final val NoIdleTimeout: FiniteDuration = Duration.Zero
+
+  /**
+   * デフォルトのシャード数
+   */
+  final val DefaultNumberOfShards: Int = 100
+
+  /**
+   * クラスターシャーディングを初期化
+   *
+   * @param aggregateName
+   *   集約名（例: "StaffAggregate", "EmployeeAggregate"）
+   * @param clusterSharding
+   *   ClusterShardingインスタンス
+   * @param aggregateBehavior
+   *   集約IDからBehaviorを生成する関数
+   * @param extractId
+   *   文字列から集約IDを抽出する関数
+   * @param createIdleMessage
+   *   アイドル時のメッセージを生成する関数
+   * @param numberOfShards
+   *   シャード数（デフォルト: 100）
+   * @param idleTimeout
+   *   アイドルタイムアウト（デフォルト: 120秒）
+   * @tparam ID
+   *   集約IDの型
+   * @tparam CMD
+   *   コマンドの型
+   * @return
+   *   シャーディングエンベロープのActorRef
+   */
+  def init[ID <: AggregateId, CMD <: { def id: ID } : ClassTag](
+    aggregateName: String,
+    clusterSharding: ClusterSharding,
+    aggregateBehavior: ID => Behavior[CMD],
+    extractId: String => Try[ID],
+    createIdleMessage: ID => CMD,
+    stopMessageId: Option[ID] = None,
+    numberOfShards: Int = DefaultNumberOfShards,
+    idleTimeout: FiniteDuration = DefaultIdleTimeout,
+    enablePassivation: Boolean = true
+  )(implicit system: ActorSystem[?]): ActorRef[ShardingEnvelope[CMD]] = {
+
+    val typeKey = EntityTypeKey[CMD](aggregateName)
+
+    /**
+     * 集約の振る舞いを定義 子アクターとして集約アクターを生成し、メッセージを転送する
+     */
+    def aggregateWrapper(entityContext: EntityContext[CMD]): Behavior[CMD] =
+      Behaviors.setup { context =>
+        context.log.info(s"Starting $aggregateName aggregate: ${entityContext.entityId}")
+
+        // 集約IDをパース
+        val aggregateId = extractId(entityContext.entityId) match {
+          case Success(id) => id
+          case Failure(exception) =>
+            throw new IllegalArgumentException(
+              s"Invalid aggregate ID: ${entityContext.entityId}",
+              exception
+            )
+        }
+
+        // 集約アクターを子アクターとして生成
+        val childRef = context.spawn(
+          aggregateBehavior(aggregateId),
+          s"$aggregateName-${entityContext.entityId}"
+        )
+
+        // アイドルタイムアウトとパッシベーションの設定
+        if (idleTimeout > Duration.Zero && enablePassivation) {
+          val timeoutMessage = createIdleMessage(aggregateId)
+          context.setReceiveTimeout(idleTimeout, timeoutMessage)
+
+          Behaviors.receiveMessage[CMD] { msg =>
+            if (msg == timeoutMessage) {
+              // タイムアウト時はパッシベーションを開始
+              context.log.debug(s"Aggregate ${entityContext.entityId} is idle, passivating...")
+              entityContext.shard ! ClusterSharding.Passivate(context.self)
+              Behaviors.same
+            } else {
+              childRef ! msg
+              Behaviors.same
+            }
+          }
+        } else {
+          // タイムアウトまたはパッシベーションが無効な場合
+          if (!enablePassivation) {
+            context.log.debug(s"Passivation disabled for $aggregateName aggregate")
+          } else {
+            context.log.debug(s"Idle timeout disabled for $aggregateName aggregate")
+          }
+          Behaviors.receiveMessage[CMD] { msg =>
+            childRef ! msg
+            Behaviors.same
+          }
+        }
+      }
+
+    // エンティティを初期化
+    val entity = Entity(typeKey)(aggregateWrapper)
+      .withMessageExtractor(
+        new GenericShardingMessageExtractor[ID, CMD](numberOfShards)
+      )
+      .withStopMessage(
+        createIdleMessage(
+          stopMessageId.getOrElse(
+            // デフォルトの停止用IDを生成（ULIDのゼロ値）
+            extractId("00000000000000000000000000").getOrElse(
+              throw new IllegalArgumentException("Failed to create stop message ID")
+            )
+          )
+        )
+      )
+
+    clusterSharding.init(entity)
+  }
+
+  /**
+   * プロキシBehaviorを作成 クラスターシャーディングへメッセージを転送する
+   *
+   * @param aggregateName
+   *   集約名
+   * @param clusterSharding
+   *   ClusterShardingインスタンス
+   * @tparam ID
+   *   集約IDの型
+   * @tparam CMD
+   *   コマンドの型
+   * @return
+   *   プロキシBehavior
+   */
+  def ofProxy[ID <: AggregateId, CMD <: { def id: ID } : ClassTag](
+    aggregateName: String,
+    clusterSharding: ClusterSharding
+  ): Behavior[CMD] =
+    Behaviors.setup { context =>
+      context.log.info(s"Starting $aggregateName sharding proxy")
+
+      val typeKey = EntityTypeKey[CMD](aggregateName)
+
+      Behaviors.receiveMessage { msg =>
+        val entityRef = clusterSharding.entityRefFor(typeKey, msg.id.asString)
+        entityRef ! msg
+        Behaviors.same
+      }
+    }
+
+  /**
+   * 特定の集約への参照を取得
+   *
+   * @param aggregateName
+   *   集約名
+   * @param clusterSharding
+   *   ClusterShardingインスタンス
+   * @param aggregateId
+   *   集約ID
+   * @tparam ID
+   *   集約IDの型
+   * @tparam CMD
+   *   コマンドの型
+   * @return
+   *   集約への参照
+   */
+  def entityRefFor[ID <: AggregateId, CMD <: { def id: ID } : ClassTag](
+    aggregateName: String,
+    clusterSharding: ClusterSharding,
+    aggregateId: ID
+  ): org.apache.pekko.cluster.sharding.typed.scaladsl.EntityRef[CMD] = {
+    val typeKey = EntityTypeKey[CMD](aggregateName)
+    clusterSharding.entityRefFor(typeKey, aggregateId.asString)
+  }
+}
+
+/**
+ * 汎用メッセージエクストラクター メッセージから集約IDとシャードIDを抽出
+ *
+ * @param numberOfShards
+ *   シャード数
+ * @tparam ID
+ *   集約IDの型
+ * @tparam CMD
+ *   コマンドの型
+ */
+private class GenericShardingMessageExtractor[ID <: AggregateId, CMD <: { def id: ID }](
+  numberOfShards: Int
+) extends org.apache.pekko.cluster.sharding.typed.ShardingMessageExtractor[
+    ShardingEnvelope[CMD],
+    CMD
+  ] {
+
+  override def entityId(envelope: ShardingEnvelope[CMD]): String =
+    envelope.entityId
+
+  override def shardId(entityId: String): String = {
+    // エンティティIDのハッシュ値を使用してシャードIDを決定
+    val shardNumber = math.abs(entityId.hashCode) % numberOfShards
+    shardNumber.toString
+  }
+
+  override def unwrapMessage(envelope: ShardingEnvelope[CMD]): CMD =
+    envelope.message
+}
diff --git a/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/registry/GenericLocalRegistry.scala b/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/registry/GenericLocalRegistry.scala
new file mode 100644
index 0000000..78f34ed
--- /dev/null
+++ b/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/registry/GenericLocalRegistry.scala
@@ -0,0 +1,70 @@
+package com.precena.macaron.command.interfaceAdapter.registry
+
+import com.precena.macaron.domain.support.AggregateId
+import org.apache.pekko.actor.typed.scaladsl.Behaviors
+import org.apache.pekko.actor.typed.{ActorRef, Behavior}
+import scala.reflect.Selectable.reflectiveSelectable
+
+/**
+ * ローカルモードで集約アクターを管理する汎用レジストリ
+ *
+ * 各集約IDに対応するアクターへのルーティングを行う。 集約アクターは遅延作成され、必要に応じてspawnされる。
+ */
+object GenericLocalRegistry {
+
+  /**
+   * ローカルレジストリのBehaviorを作成
+   *
+   * @param name
+   *   レジストリの名前（例: "staff-aggregates", "employee-aggregates"）
+   * @param nameF
+   *   集約IDからアクター名を生成する関数
+   * @param childBehavior
+   *   集約IDからBehaviorを生成する関数
+   * @tparam ID
+   *   集約IDの型
+   * @tparam CMD
+   *   コマンドの型
+   * @return
+   *   レジストリのBehavior
+   */
+  def create[ID <: AggregateId, CMD <: { def id: ID }](
+    name: String
+  )(
+    nameF: ID => String
+  )(
+    childBehavior: ID => Behavior[CMD]
+  ): Behavior[CMD] =
+    Behaviors.setup { context =>
+      context.log.info(s"Starting local registry: $name")
+
+      /**
+       * 集約アクターを取得または作成
+       *
+       * @param aggregateId
+       *   集約ID
+       * @return
+       *   集約アクターのActorRef
+       */
+      def getOrCreateRef(aggregateId: ID): ActorRef[CMD] = {
+        val actorName = nameF(aggregateId)
+        context.child(actorName) match {
+          case Some(ref) =>
+            context.log.debug(s"Found existing actor: $actorName")
+            ref.unsafeUpcast[CMD]
+          case None =>
+            context.log.info(
+              s"Creating new actor: $actorName for aggregate: ${aggregateId.asString}")
+            context.spawn(childBehavior(aggregateId), actorName)
+        }
+      }
+
+      Behaviors.receiveMessage { msg =>
+        val aggregateId = msg.id.asInstanceOf[ID]
+        val actorRef = getOrCreateRef(aggregateId)
+        context.log.debug(s"Routing message to aggregate: ${aggregateId.asString}")
+        actorRef ! msg
+        Behaviors.same
+      }
+    }
+}
diff --git a/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/registry/GenericRegistry.scala b/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/registry/GenericRegistry.scala
new file mode 100644
index 0000000..4b2bb52
--- /dev/null
+++ b/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/registry/GenericRegistry.scala
@@ -0,0 +1,103 @@
+package com.precena.macaron.command.interfaceAdapter.registry
+
+import com.precena.macaron.domain.support.AggregateId
+import org.apache.pekko.actor.typed.{ActorSystem, Behavior}
+import org.apache.pekko.cluster.sharding.typed.scaladsl.ClusterSharding
+import scala.reflect.ClassTag
+import scala.util.Try
+import scala.concurrent.duration.FiniteDuration
+
+/**
+ * 汎用レジストリファサード
+ *
+ * 環境に応じてローカルモードまたはクラスターモードを選択し、 集約アクターへのアクセスを統一的に提供する。
+ */
+object GenericRegistry {
+
+  /**
+   * 動作モード
+   */
+  enum Mode {
+    case LocalMode
+    case ClusterMode
+  }
+
+  /**
+   * モードに応じたBehaviorを作成 呼び出し側がspawnのタイミングとアクター名を制御できる
+   *
+   * @param aggregateName
+   *   集約名（例: "StaffAggregate", "EmployeeAggregate"）
+   * @param mode
+   *   動作モード（LocalMode または ClusterMode）
+   * @param nameF
+   *   集約IDからアクター名を生成する関数（ローカルモード用）
+   * @param aggregateBehavior
+   *   集約IDからBehaviorを生成する関数
+   * @param extractId
+   *   文字列から集約IDを抽出する関数（クラスターモード用）
+   * @param createIdleMessage
+   *   アイドル時のメッセージを生成する関数（クラスターモード用）
+   * @param system
+   *   ActorSystem（クラスターモード用）
+   * @tparam ID
+   *   集約IDの型
+   * @tparam CMD
+   *   コマンドの型
+   * @return
+   *   レジストリのBehavior
+   */
+  def create[ID <: AggregateId, CMD <: { def id: ID } : ClassTag](
+    aggregateName: String,
+    mode: Mode = Mode.LocalMode,
+    idleTimeout: Option[FiniteDuration] = None,
+    enablePassivation: Boolean = true
+  )(
+    nameF: ID => String,
+    aggregateBehavior: ID => Behavior[CMD],
+    extractId: String => Try[ID],
+    createIdleMessage: ID => CMD,
+    stopMessageId: Option[ID] = None
+  )(implicit system: ActorSystem[?]): Behavior[CMD] =
+    mode match {
+      case Mode.LocalMode =>
+        // ローカルモード：GenericLocalRegistryを使用
+        GenericLocalRegistry.create[ID, CMD](s"$aggregateName-registry")(nameF)(aggregateBehavior)
+
+      case Mode.ClusterMode =>
+        // クラスターモード：GenericClusterShardingを使用
+        val clusterSharding = ClusterSharding(system)
+
+        // クラスターシャーディングの初期化（アプリケーション起動時に一度だけ実行）
+        GenericClusterSharding.init(
+          aggregateName = aggregateName,
+          clusterSharding = clusterSharding,
+          aggregateBehavior = aggregateBehavior,
+          extractId = extractId,
+          createIdleMessage = createIdleMessage,
+          stopMessageId = stopMessageId,
+          idleTimeout = idleTimeout.getOrElse(GenericClusterSharding.DefaultIdleTimeout),
+          enablePassivation = enablePassivation
+        )
+
+        // プロキシBehaviorを返す
+        GenericClusterSharding.ofProxy(aggregateName, clusterSharding)
+    }
+
+  /**
+   * 設定から動作モードを決定
+   *
+   * @param system
+   *   ActorSystem
+   * @return
+   *   動作モード
+   */
+  def modeFromConfig(system: ActorSystem[?]): Mode = {
+    val config = system.settings.config
+    if (config.hasPath("pekko.cluster.enabled") &&
+      config.getBoolean("pekko.cluster.enabled")) {
+      Mode.ClusterMode
+    } else {
+      Mode.LocalMode
+    }
+  }
+}
diff --git a/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/registry/GenericShardingMessageExtractor.scala b/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/registry/GenericShardingMessageExtractor.scala
new file mode 100644
index 0000000..e8644f1
--- /dev/null
+++ b/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/registry/GenericShardingMessageExtractor.scala
@@ -0,0 +1,31 @@
+package io.github.j5ik2o.pcqrses.command.interfaceAdapter.registry
+
+/**
+ * 汎用メッセージエクストラクター メッセージから集約IDとシャードIDを抽出
+ *
+ * @param numberOfShards
+ * シャード数
+ * @tparam ID
+ * 集約IDの型
+ * @tparam CMD
+ * コマンドの型
+ */
+private class GenericShardingMessageExtractor[ID <: EntityId, CMD <: {def id: ID}](
+                                                                                    numberOfShards: Int
+                                                                                  ) extends org.apache.pekko.cluster.sharding.typed.ShardingMessageExtractor[
+  ShardingEnvelope[CMD],
+  CMD
+] {
+
+  override def entityId(envelope: ShardingEnvelope[CMD]): String =
+    envelope.entityId
+
+  override def shardId(entityId: String): String = {
+    // エンティティIDのハッシュ値を使用してシャードIDを決定
+    val shardNumber = math.abs(entityId.hashCode) % numberOfShards
+    shardNumber.toString
+  }
+
+  override def unwrapMessage(envelope: ShardingEnvelope[CMD]): CMD =
+    envelope.message
+}

```

## コミット: cc20c74

### メッセージ

```
refactor: commandモジュールのパッケージ構造を統一
すべてのcommandモジュールでパッケージ名に'command'を追加し、
一貫性のある構造に変更:

- domain: io.github.j5ik2o.pcqrses.domain → io.github.j5ik2o.pcqrses.command.domain
- interface-adapter: interfaceAdapter → command.interfaceAdapter
- interface-adapter-contract: interfaceAdapter → command.interfaceAdapter
- interface-adapter-event-serializer: interfaceAdapter → command.interfaceAdapter

影響範囲:
- 20個のdomainファイルのパッケージ構造を変更
- 各モジュール間のimport文を更新
- ディレクトリ構造を再編成
- テストファイルのパッケージも統一
```

### 変更されたファイル

- A	modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/RenameError.scala
- D	modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/RenameError.scala
- A	modules/command/interface-adapter-event-serializer/src/main/resources/reference.conf
- A	modules/command/interface-adapter/src/main/resources/reference.conf

### 変更内容

```diff
commit cc20c74c8a2f14f18dd9b0bf6bc2f17cc223e27e
Author: Junichi Kato <j5ik2o@gmail.com>
Date:   Sat Sep 13 15:56:21 2025 +0900

    refactor: commandモジュールのパッケージ構造を統一
    
    すべてのcommandモジュールでパッケージ名に'command'を追加し、
    一貫性のある構造に変更:
    
    - domain: io.github.j5ik2o.pcqrses.domain → io.github.j5ik2o.pcqrses.command.domain
    - interface-adapter: interfaceAdapter → command.interfaceAdapter
    - interface-adapter-contract: interfaceAdapter → command.interfaceAdapter
    - interface-adapter-event-serializer: interfaceAdapter → command.interfaceAdapter
    
    影響範囲:
    - 20個のdomainファイルのパッケージ構造を変更
    - 各モジュール間のimport文を更新
    - ディレクトリ構造を再編成
    - テストファイルのパッケージも統一

diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/basic/DateTime.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/basic/DateTime.scala
similarity index 97%
rename from modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/basic/DateTime.scala
rename to modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/basic/DateTime.scala
index 51f18ab..bd73959 100644
--- a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/basic/DateTime.scala
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/basic/DateTime.scala
@@ -1,4 +1,4 @@
-package io.github.j5ik2o.pcqrses.domain.basic
+package io.github.j5ik2o.pcqrses.command.domain.basic
 
 import java.time.format.DateTimeParseException
 import java.time.{Instant, LocalDateTime, ZoneId, ZonedDateTime}
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/basic/DateTimeError.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/basic/DateTimeError.scala
similarity index 63%
rename from modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/basic/DateTimeError.scala
rename to modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/basic/DateTimeError.scala
index 536d992..e1ff996 100644
--- a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/basic/DateTimeError.scala
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/basic/DateTimeError.scala
@@ -1,6 +1,6 @@
-package io.github.j5ik2o.pcqrses.domain.basic
+package io.github.j5ik2o.pcqrses.command.domain.basic
 
-import io.github.j5ik2o.pcqrses.domain.support.DomainError
+import io.github.j5ik2o.pcqrses.command.domain.support.DomainError
 
 enum DateTimeError extends DomainError {
   case InvalidFormat(value: String)
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/DomainError.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/support/DomainError.scala
similarity index 88%
rename from modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/DomainError.scala
rename to modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/support/DomainError.scala
index 1b44355..582c256 100644
--- a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/DomainError.scala
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/support/DomainError.scala
@@ -1,4 +1,4 @@
-package io.github.j5ik2o.pcqrses.domain.support
+package io.github.j5ik2o.pcqrses.command.domain.support
 
 /**
  * ドメインエラーの共通インターフェース
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/DomainEvent.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/support/DomainEvent.scala
similarity index 53%
rename from modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/DomainEvent.scala
rename to modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/support/DomainEvent.scala
index 79f19a1..4d10b89 100644
--- a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/DomainEvent.scala
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/support/DomainEvent.scala
@@ -1,6 +1,6 @@
-package io.github.j5ik2o.pcqrses.domain.support
+package io.github.j5ik2o.pcqrses.command.domain.support
 
-import io.github.j5ik2o.pcqrses.domain.basic.DateTime
+import io.github.j5ik2o.pcqrses.command.domain.basic.DateTime
 
 trait DomainEvent {
   type EntityIdType <: EntityId
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/DomainEventId.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/support/DomainEventId.scala
similarity index 91%
rename from modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/DomainEventId.scala
rename to modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/support/DomainEventId.scala
index 2d27a2f..36aefaf 100644
--- a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/DomainEventId.scala
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/support/DomainEventId.scala
@@ -1,4 +1,4 @@
-package io.github.j5ik2o.pcqrses.domain.support
+package io.github.j5ik2o.pcqrses.command.domain.support
 
 import wvlet.airframe.ulid.ULID
 
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/Entity.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/support/Entity.scala
similarity index 52%
rename from modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/Entity.scala
rename to modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/support/Entity.scala
index c8a32ba..66ef115 100644
--- a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/Entity.scala
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/support/Entity.scala
@@ -1,4 +1,4 @@
-package io.github.j5ik2o.pcqrses.domain.support
+package io.github.j5ik2o.pcqrses.command.domain.support
 
 trait Entity {
   type IdType <: EntityId
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/EntityId.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/support/EntityId.scala
similarity index 56%
rename from modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/EntityId.scala
rename to modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/support/EntityId.scala
index 1f1270e..8345cde 100644
--- a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/EntityId.scala
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/support/EntityId.scala
@@ -1,4 +1,4 @@
-package io.github.j5ik2o.pcqrses.domain.support
+package io.github.j5ik2o.pcqrses.command.domain.support
 
 trait EntityId {
   def entityTypeName: String
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/DeleteError.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/DeleteError.scala
similarity index 59%
rename from modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/DeleteError.scala
rename to modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/DeleteError.scala
index c05300b..087b758 100644
--- a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/DeleteError.scala
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/DeleteError.scala
@@ -1,6 +1,6 @@
-package io.github.j5ik2o.pcqrses.domain.users
+package io.github.j5ik2o.pcqrses.command.domain.users
 
-import io.github.j5ik2o.pcqrses.domain.support.DomainError
+import io.github.j5ik2o.pcqrses.command.domain.support.DomainError
 
 enum DeleteError extends DomainError {
 
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/EmailAddress.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/EmailAddress.scala
similarity index 94%
rename from modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/EmailAddress.scala
rename to modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/EmailAddress.scala
index 542ceb5..a7d479c 100644
--- a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/EmailAddress.scala
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/EmailAddress.scala
@@ -1,4 +1,4 @@
-package io.github.j5ik2o.pcqrses.domain.users
+package io.github.j5ik2o.pcqrses.command.domain.users
 
 trait EmailAddress {
 
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/EmailAddressError.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/EmailAddressError.scala
similarity index 76%
rename from modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/EmailAddressError.scala
rename to modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/EmailAddressError.scala
index daf4271..33769f3 100644
--- a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/EmailAddressError.scala
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/EmailAddressError.scala
@@ -1,6 +1,6 @@
-package io.github.j5ik2o.pcqrses.domain.users
+package io.github.j5ik2o.pcqrses.command.domain.users
 
-import io.github.j5ik2o.pcqrses.domain.support.DomainError
+import io.github.j5ik2o.pcqrses.command.domain.support.DomainError
 
 enum EmailAddressError extends DomainError {
   case Empty
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/FirstName.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/FirstName.scala
similarity index 90%
rename from modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/FirstName.scala
rename to modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/FirstName.scala
index a03893d..5941e8e 100644
--- a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/FirstName.scala
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/FirstName.scala
@@ -1,4 +1,4 @@
-package io.github.j5ik2o.pcqrses.domain.users
+package io.github.j5ik2o.pcqrses.command.domain.users
 
 trait FirstName {
   def asString: String
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/FirstNameError.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/FirstNameError.scala
similarity index 57%
rename from modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/FirstNameError.scala
rename to modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/FirstNameError.scala
index 2514fb4..7aee915 100644
--- a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/FirstNameError.scala
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/FirstNameError.scala
@@ -1,6 +1,6 @@
-package io.github.j5ik2o.pcqrses.domain.users
+package io.github.j5ik2o.pcqrses.command.domain.users
 
-import io.github.j5ik2o.pcqrses.domain.support.DomainError
+import io.github.j5ik2o.pcqrses.command.domain.support.DomainError
 
 enum FirstNameError extends DomainError {
   case TooLong
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/LastName.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/LastName.scala
similarity index 90%
rename from modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/LastName.scala
rename to modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/LastName.scala
index 0ed7f61..dc5cf68 100644
--- a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/LastName.scala
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/LastName.scala
@@ -1,4 +1,4 @@
-package io.github.j5ik2o.pcqrses.domain.users
+package io.github.j5ik2o.pcqrses.command.domain.users
 
 trait LastName {
   def asString: String
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/LastNameError.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/LastNameError.scala
similarity index 57%
rename from modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/LastNameError.scala
rename to modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/LastNameError.scala
index eac9d93..1349b42 100644
--- a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/LastNameError.scala
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/LastNameError.scala
@@ -1,6 +1,6 @@
-package io.github.j5ik2o.pcqrses.domain.users
+package io.github.j5ik2o.pcqrses.command.domain.users
 
-import io.github.j5ik2o.pcqrses.domain.support.DomainError
+import io.github.j5ik2o.pcqrses.command.domain.support.DomainError
 
 enum LastNameError extends DomainError {
   case TooLong
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/RenameError.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/RenameError.scala
new file mode 100644
index 0000000..6733df3
--- /dev/null
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/RenameError.scala
@@ -0,0 +1,5 @@
+package io.github.j5ik2o.pcqrses.command.domain.users
+
+enum RenameError {
+  case FamilyNameSame
+}
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccount.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/UserAccount.scala
similarity index 92%
rename from modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccount.scala
rename to modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/UserAccount.scala
index 54c8f66..cc4cdb8 100644
--- a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccount.scala
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/UserAccount.scala
@@ -1,7 +1,7 @@
-package io.github.j5ik2o.pcqrses.domain.users
+package io.github.j5ik2o.pcqrses.command.domain.users
 
-import io.github.j5ik2o.pcqrses.domain.basic.DateTime
-import io.github.j5ik2o.pcqrses.domain.support.{DomainEventId, Entity}
+import io.github.j5ik2o.pcqrses.command.domain.basic.DateTime
+import io.github.j5ik2o.pcqrses.command.domain.support.{DomainEventId, Entity}
 
 trait UserAccount extends Entity {
   override type IdType = UserAccountId
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccountEvent.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/UserAccountEvent.scala
similarity index 71%
rename from modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccountEvent.scala
rename to modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/UserAccountEvent.scala
index 6335733..4d34a33 100644
--- a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccountEvent.scala
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/UserAccountEvent.scala
@@ -1,7 +1,7 @@
-package io.github.j5ik2o.pcqrses.domain.users
+package io.github.j5ik2o.pcqrses.command.domain.users
 
-import io.github.j5ik2o.pcqrses.domain.basic.DateTime
-import io.github.j5ik2o.pcqrses.domain.support.{DomainEvent, DomainEventId}
+import io.github.j5ik2o.pcqrses.command.domain.basic.DateTime
+import io.github.j5ik2o.pcqrses.command.domain.support.{DomainEvent, DomainEventId}
 
 enum UserAccountEvent extends DomainEvent {
   override type EntityIdType = UserAccountId
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccountId.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/UserAccountId.scala
similarity index 90%
rename from modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccountId.scala
rename to modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/UserAccountId.scala
index d000bdb..0f3e0b8 100644
--- a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccountId.scala
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/UserAccountId.scala
@@ -1,6 +1,6 @@
-package io.github.j5ik2o.pcqrses.domain.users
+package io.github.j5ik2o.pcqrses.command.domain.users
 
-import io.github.j5ik2o.pcqrses.domain.support.EntityId
+import io.github.j5ik2o.pcqrses.command.domain.support.EntityId
 import wvlet.airframe.ulid.{CrockfordBase32, ULID}
 
 trait UserAccountId extends EntityId {
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccountIdError.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/UserAccountIdError.scala
similarity index 72%
rename from modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccountIdError.scala
rename to modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/UserAccountIdError.scala
index 5076d2a..dc65a8a 100644
--- a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccountIdError.scala
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/UserAccountIdError.scala
@@ -1,6 +1,6 @@
-package io.github.j5ik2o.pcqrses.domain.users
+package io.github.j5ik2o.pcqrses.command.domain.users
 
-import io.github.j5ik2o.pcqrses.domain.support.DomainError
+import io.github.j5ik2o.pcqrses.command.domain.support.DomainError
 
 enum UserAccountIdError extends DomainError {
   case Empty
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccountName.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/UserAccountName.scala
similarity index 93%
rename from modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccountName.scala
rename to modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/UserAccountName.scala
index 9ffe878..78bf390 100644
--- a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccountName.scala
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/command/domain/users/UserAccountName.scala
@@ -1,4 +1,4 @@
-package io.github.j5ik2o.pcqrses.domain.users
+package io.github.j5ik2o.pcqrses.command.domain.users
 
 trait UserAccountName {
   def breachEncapsulationOfFirstName: FirstName
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/RenameError.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/RenameError.scala
deleted file mode 100644
index 47b141d..0000000
--- a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/RenameError.scala
+++ /dev/null
@@ -1,5 +0,0 @@
-package io.github.j5ik2o.pcqrses.domain.users
-
-enum RenameError {
-  case FamilyNameSame
-}
diff --git a/modules/command/interface-adapter-contract/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/contract/users/UserAccountProtocol.scala b/modules/command/interface-adapter-contract/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/contract/users/UserAccountProtocol.scala
similarity index 84%
rename from modules/command/interface-adapter-contract/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/contract/users/UserAccountProtocol.scala
rename to modules/command/interface-adapter-contract/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/contract/users/UserAccountProtocol.scala
index 381566a..d4c3b87 100644
--- a/modules/command/interface-adapter-contract/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/contract/users/UserAccountProtocol.scala
+++ b/modules/command/interface-adapter-contract/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/contract/users/UserAccountProtocol.scala
@@ -1,6 +1,6 @@
-package io.github.j5ik2o.pcqrses.interfaceAdapter.contract.users
+package io.github.j5ik2o.pcqrses.command.interfaceAdapter.contract.users
 
-import io.github.j5ik2o.pcqrses.domain.users.{DeleteError, EmailAddress, RenameError, UserAccount, UserAccountId, UserAccountName}
+import io.github.j5ik2o.pcqrses.command.domain.users.{DeleteError, EmailAddress, RenameError, UserAccount, UserAccountId, UserAccountName}
 import org.apache.pekko.actor.typed.ActorRef
 
 object UserAccountProtocol {
diff --git a/modules/command/interface-adapter-event-serializer/src/main/resources/reference.conf b/modules/command/interface-adapter-event-serializer/src/main/resources/reference.conf
new file mode 100644
index 0000000..6cec8ca
--- /dev/null
+++ b/modules/command/interface-adapter-event-serializer/src/main/resources/reference.conf
@@ -0,0 +1,11 @@
+pekko {
+  actor {
+    serialize-messages = off
+    serializers {
+      user-account-event = "io.github.j5ik2o.pcqrses.interfaceAdapter.aggregate.users.UserAccountEventSerializer"
+    }
+    serialization-bindings {
+      "io.github.j5ik2o.pcqrses.domain.users.UserAccountEvent" = user-account-event
+    }
+  }
+}
diff --git a/modules/command/interface-adapter-event-serializer/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountEventSerializer.scala b/modules/command/interface-adapter-event-serializer/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/aggregate/users/UserAccountEventSerializer.scala
similarity index 95%
rename from modules/command/interface-adapter-event-serializer/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountEventSerializer.scala
rename to modules/command/interface-adapter-event-serializer/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/aggregate/users/UserAccountEventSerializer.scala
index d20c0d3..45504c5 100644
--- a/modules/command/interface-adapter-event-serializer/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountEventSerializer.scala
+++ b/modules/command/interface-adapter-event-serializer/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/aggregate/users/UserAccountEventSerializer.scala
@@ -1,4 +1,4 @@
-package io.github.j5ik2o.pcqrses.interfaceAdapter.users
+package io.github.j5ik2o.pcqrses.command.interfaceAdapter.aggregate.users
 
 import io.github.j5ik2o.pcqrses.command.interfaceAdapter.persistence.users.{
   UserAccountEvent as ProtoUserAccountEvent,
@@ -8,9 +8,9 @@ import io.github.j5ik2o.pcqrses.command.interfaceAdapter.persistence.users.{
 }
 import io.github.j5ik2o.pcqrses.command.interfaceAdapter.persistence.basic.UserAccountName as ProtoUserAccountName
 
-import io.github.j5ik2o.pcqrses.domain.basic.DateTime
-import io.github.j5ik2o.pcqrses.domain.support.DomainEventId
-import io.github.j5ik2o.pcqrses.domain.users.{
+import io.github.j5ik2o.pcqrses.command.domain.basic.DateTime
+import io.github.j5ik2o.pcqrses.command.domain.support.DomainEventId
+import io.github.j5ik2o.pcqrses.command.domain.users.{
   EmailAddress as DomainEmailAddress,
   FirstName,
   LastName,
@@ -127,4 +127,4 @@ class UserAccountEventSerializer extends SerializerWithStringManifest {
         throw new IllegalArgumentException("Unexpected Empty event in UserAccountEvent")
     }
   }
-}
\ No newline at end of file
+}
diff --git a/modules/command/interface-adapter/src/main/resources/reference.conf b/modules/command/interface-adapter/src/main/resources/reference.conf
new file mode 100644
index 0000000..09fdcdf
--- /dev/null
+++ b/modules/command/interface-adapter/src/main/resources/reference.conf
@@ -0,0 +1,11 @@
+pekko {
+  actor {
+    serialize-messages = off
+    serializers {
+      user-account-snapshot = "io.github.j5ik2o.pcqrses.interfaceAdapter.aggregate.users.UserAccountSnapshotSerializer"
+    }
+    serialization-bindings {
+      "io.github.j5ik2o.pcqrses.interfaceAdapter.aggregate.users.UserAccountAggregateState" = user-account-snapshot
+    }
+  }
+}
diff --git a/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountAggregate.scala b/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/aggregate/users/UserAccountAggregate.scala
similarity index 93%
rename from modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountAggregate.scala
rename to modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/aggregate/users/UserAccountAggregate.scala
index f7c7bfa..c202c0d 100644
--- a/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountAggregate.scala
+++ b/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/aggregate/users/UserAccountAggregate.scala
@@ -1,4 +1,4 @@
-package io.github.j5ik2o.pcqrses.interfaceAdapter.users
+package io.github.j5ik2o.pcqrses.command.interfaceAdapter.aggregate.users
 
 import com.github.j5ik2o.pekko.persistence.effector.scaladsl.{
   PersistenceEffector,
@@ -7,8 +7,8 @@ import com.github.j5ik2o.pekko.persistence.effector.scaladsl.{
   RetentionCriteria,
   SnapshotCriteria
 }
-import io.github.j5ik2o.pcqrses.domain.users.{UserAccount, UserAccountEvent, UserAccountId}
-import io.github.j5ik2o.pcqrses.interfaceAdapter.contract.users.UserAccountProtocol.*
+import io.github.j5ik2o.pcqrses.command.domain.users.{UserAccount, UserAccountEvent, UserAccountId}
+import io.github.j5ik2o.pcqrses.command.interfaceAdapter.contract.users.UserAccountProtocol.*
 import org.apache.pekko.actor.typed.{Behavior, SupervisorStrategy}
 import org.apache.pekko.actor.typed.scaladsl.Behaviors
 import org.apache.pekko.persistence.typed.PersistenceId
diff --git a/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountAggregateState.scala b/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/aggregate/users/UserAccountAggregateState.scala
similarity index 89%
rename from modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountAggregateState.scala
rename to modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/aggregate/users/UserAccountAggregateState.scala
index 439964c..393f3b8 100644
--- a/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountAggregateState.scala
+++ b/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/aggregate/users/UserAccountAggregateState.scala
@@ -1,6 +1,6 @@
-package io.github.j5ik2o.pcqrses.interfaceAdapter.users
+package io.github.j5ik2o.pcqrses.command.interfaceAdapter.aggregate.users
 
-import io.github.j5ik2o.pcqrses.domain.users.{UserAccount, UserAccountEvent, UserAccountId}
+import io.github.j5ik2o.pcqrses.command.domain.users.{UserAccount, UserAccountEvent, UserAccountId}
 
 enum UserAccountAggregateState {
   case NotCreated(id: UserAccountId)
diff --git a/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountSnapshotSerializer.scala b/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/aggregate/users/UserAccountSnapshotSerializer.scala
similarity index 95%
rename from modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountSnapshotSerializer.scala
rename to modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/aggregate/users/UserAccountSnapshotSerializer.scala
index 0a626f2..02686ed 100644
--- a/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountSnapshotSerializer.scala
+++ b/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/aggregate/users/UserAccountSnapshotSerializer.scala
@@ -1,4 +1,4 @@
-package io.github.j5ik2o.pcqrses.interfaceAdapter.users
+package io.github.j5ik2o.pcqrses.command.interfaceAdapter.aggregate.users
 
 import io.github.j5ik2o.pcqrses.command.interfaceAdapter.persistence.users.{
   UserAccountSnapshot,
@@ -6,8 +6,8 @@ import io.github.j5ik2o.pcqrses.command.interfaceAdapter.persistence.users.{
 }
 import io.github.j5ik2o.pcqrses.command.interfaceAdapter.persistence.basic.UserAccountName as ProtoUserAccountName
 
-import io.github.j5ik2o.pcqrses.domain.basic.DateTime
-import io.github.j5ik2o.pcqrses.domain.users.{
+import io.github.j5ik2o.pcqrses.command.domain.basic.DateTime
+import io.github.j5ik2o.pcqrses.command.domain.users.{
   EmailAddress as DomainEmailAddress,
   FirstName,
   LastName,
@@ -15,7 +15,7 @@ import io.github.j5ik2o.pcqrses.domain.users.{
   UserAccountId as DomainUserAccountId,
   UserAccountName as DomainUserAccountName
 }
-import io.github.j5ik2o.pcqrses.interfaceAdapter.users.UserAccountAggregateState.{
+import UserAccountAggregateState.{
   Created,
   Deleted,
   NotCreated
diff --git a/modules/command/interface-adapter/src/test/scala/io/github/j5ik2o/pcqrses/query/interfaceAdapter/test/ActorSpec.scala b/modules/command/interface-adapter/src/test/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/test/ActorSpec.scala
similarity index 90%
rename from modules/command/interface-adapter/src/test/scala/io/github/j5ik2o/pcqrses/query/interfaceAdapter/test/ActorSpec.scala
rename to modules/command/interface-adapter/src/test/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/test/ActorSpec.scala
index 2293cae..2da602a 100644
--- a/modules/command/interface-adapter/src/test/scala/io/github/j5ik2o/pcqrses/query/interfaceAdapter/test/ActorSpec.scala
+++ b/modules/command/interface-adapter/src/test/scala/io/github/j5ik2o/pcqrses/command/interfaceAdapter/test/ActorSpec.scala
@@ -1,4 +1,4 @@
-package io.github.j5ik2o.pcqrses.query.interfaceAdapter.test
+package io.github.j5ik2o.pcqrses.command.interfaceAdapter.test
 
 import com.typesafe.config.{Config, ConfigFactory}
 import org.apache.pekko.actor.ActorSystem
@@ -37,18 +37,20 @@ abstract class ActorSpec(testKit: ActorTestKit)
 
   def this() = this(ActorTestKit(ActorTestKitBase.testNameFromCallStack()))
 
-  def this(config: String) =
+  def this(config: String) = {
     this(
       ActorTestKit(
         ActorTestKitBase.testNameFromCallStack(),
         ConfigFactory.parseString(config)
       )
     )
+  }
 
-  def this(config: Config) =
+  def this(config: Config) = {
     this(ActorTestKit(ActorTestKitBase.testNameFromCallStack(), config))
+  }
 
-  def this(config: Config, settings: TestKitSettings) =
+  def this(config: Config, settings: TestKitSettings) = {
     this(
       ActorTestKit(
         ActorTestKitBase.testNameFromCallStack(),
@@ -56,6 +58,7 @@ abstract class ActorSpec(testKit: ActorTestKit)
         settings
       )
     )
+  }
 
   implicit def classicSystem: ActorSystem = system.toClassic
 

```

## コミット: b56d0e8

### メッセージ

```
chore: stashされた変更を適用
```

### 変更されたファイル

- M	build.sbt
- M	modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/basic/DateTime.scala
- M	modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/basic/DateTimeError.scala
- M	modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/DeleteError.scala
- M	modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccount.scala
- M	modules/command/interface-adapter-contract/src/main/protobuf/basic/basic.proto
- M	modules/command/interface-adapter/src/test/scala/io/github/j5ik2o/pcqrses/query/interfaceAdapter/test/ActorSpec.scala

### 変更内容

```diff
commit b56d0e8c7ed7773e93772cdf335de3f24e05f3cc
Author: Junichi Kato <j5ik2o@gmail.com>
Date:   Sat Sep 13 13:20:59 2025 +0900

    chore: stashされた変更を適用

diff --git a/build.sbt b/build.sbt
index 7b55626..802d9f0 100644
--- a/build.sbt
+++ b/build.sbt
@@ -95,7 +95,7 @@ lazy val commandDomain = (project in file("modules/command/domain"))
 
 lazy val commandInterfaceAdapterContract =
   (project in file("modules/command/interface-adapter-contract"))
-    .enablePlugins(JacocoPlugin)
+    .enablePlugins(JacocoPlugin, PekkoGrpcPlugin)
     .settings(commonSettings)
     .settings(
       name := "command-interface-adapter-contract",
@@ -475,4 +475,3 @@ addCommandAlias(
   ";queryFlywayMigration/flywayClean;queryFlywayMigration/flywayMigrate")
 
 addCommandAlias("dockerBuildAll", ";commandApi/docker:publishLocal;queryApi/docker:publishLocal")
-
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/basic/DateTime.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/basic/DateTime.scala
index 18f7a7a..51f18ab 100644
--- a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/basic/DateTime.scala
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/basic/DateTime.scala
@@ -30,13 +30,16 @@ object DateTime {
   def from(value: Instant, zoneId: ZoneId = ZoneId.systemDefault()): DateTime =
     apply(LocalDateTime.ofInstant(value, zoneId))
   def from(value: ZonedDateTime): DateTime = apply(value.toLocalDateTime)
-  def fromSecondsAndNanos(seconds: Long, nanos: Int, zoneId: ZoneId = ZoneId.systemDefault()): DateTime =
+  def fromSecondsAndNanos(
+    seconds: Long,
+    nanos: Int,
+    zoneId: ZoneId = ZoneId.systemDefault()): DateTime =
     apply(LocalDateTime.ofInstant(Instant.ofEpochSecond(seconds, nanos.toLong), zoneId))
 
   def parseFromString(value: String): Either[DateTimeError, DateTime] =
-    try {
+    try
       Right(DateTimeImpl(LocalDateTime.parse(value)))
-    } catch {
+    catch {
       case e: DateTimeParseException => Left(DateTimeError.InvalidFormat(e.getMessage))
     }
 
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/basic/DateTimeError.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/basic/DateTimeError.scala
index b6f32b8..536d992 100644
--- a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/basic/DateTimeError.scala
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/basic/DateTimeError.scala
@@ -5,9 +5,8 @@ import io.github.j5ik2o.pcqrses.domain.support.DomainError
 enum DateTimeError extends DomainError {
   case InvalidFormat(value: String)
 
-  override def message: String = {
+  override def message: String =
     this match {
       case InvalidFormat(value) => s"Invalid date time format: $value"
     }
-  }
 }
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/DeleteError.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/DeleteError.scala
index 2a9f92f..c05300b 100644
--- a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/DeleteError.scala
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/DeleteError.scala
@@ -2,7 +2,7 @@ package io.github.j5ik2o.pcqrses.domain.users
 
 import io.github.j5ik2o.pcqrses.domain.support.DomainError
 
-enum DeleteError extends DomainError{
+enum DeleteError extends DomainError {
 
   case AlreadyDeleted
 
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccount.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccount.scala
index d5e701d..54c8f66 100644
--- a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccount.scala
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccount.scala
@@ -60,7 +60,7 @@ object UserAccount {
         Right((updated, event))
       }
 
-    override def delete: Either[DeleteError, (UserAccount, UserAccountEvent)] = {
+    override def delete: Either[DeleteError, (UserAccount, UserAccountEvent)] =
       if (deleted) {
         Left(DeleteError.AlreadyDeleted)
       } else {
@@ -72,6 +72,5 @@ object UserAccount {
         )
         Right((updated, event))
       }
-    }
   }
 }
diff --git a/modules/command/interface-adapter-contract/src/main/protobuf/basic/basic.proto b/modules/command/interface-adapter-contract/src/main/protobuf/basic/basic.proto
index 60cecdb..2c0375e 100644
--- a/modules/command/interface-adapter-contract/src/main/protobuf/basic/basic.proto
+++ b/modules/command/interface-adapter-contract/src/main/protobuf/basic/basic.proto
@@ -1,6 +1,6 @@
 syntax = "proto3";
 
-package io.github.j5ik2o.pcqrses.command.interfaceAdapter.persistence.users;
+package io.github.j5ik2o.pcqrses.command.interfaceAdapter.persistence.basic;
 
 message UserAccountName {
   string first_name = 1;
diff --git a/modules/command/interface-adapter/src/test/scala/io/github/j5ik2o/pcqrses/query/interfaceAdapter/test/ActorSpec.scala b/modules/command/interface-adapter/src/test/scala/io/github/j5ik2o/pcqrses/query/interfaceAdapter/test/ActorSpec.scala
index 5aa3c4c..2293cae 100644
--- a/modules/command/interface-adapter/src/test/scala/io/github/j5ik2o/pcqrses/query/interfaceAdapter/test/ActorSpec.scala
+++ b/modules/command/interface-adapter/src/test/scala/io/github/j5ik2o/pcqrses/query/interfaceAdapter/test/ActorSpec.scala
@@ -3,7 +3,11 @@ package io.github.j5ik2o.pcqrses.query.interfaceAdapter.test
 import com.typesafe.config.{Config, ConfigFactory}
 import org.apache.pekko.actor.ActorSystem
 import org.apache.pekko.actor.testkit.typed.TestKitSettings
-import org.apache.pekko.actor.testkit.typed.scaladsl.{ActorTestKit, ActorTestKitBase, ScalaTestWithActorTestKit}
+import org.apache.pekko.actor.testkit.typed.scaladsl.{
+  ActorTestKit,
+  ActorTestKitBase,
+  ScalaTestWithActorTestKit
+}
 import org.apache.pekko.actor.typed.ActorRef
 import org.apache.pekko.actor.typed.scaladsl.adapter.*
 import org.scalatest.concurrent.{PatienceConfiguration, ScalaFutures}
@@ -33,20 +37,18 @@ abstract class ActorSpec(testKit: ActorTestKit)
 
   def this() = this(ActorTestKit(ActorTestKitBase.testNameFromCallStack()))
 
-  def this(config: String) = {
+  def this(config: String) =
     this(
       ActorTestKit(
         ActorTestKitBase.testNameFromCallStack(),
         ConfigFactory.parseString(config)
       )
     )
-  }
 
-  def this(config: Config) = {
+  def this(config: Config) =
     this(ActorTestKit(ActorTestKitBase.testNameFromCallStack(), config))
-  }
 
-  def this(config: Config, settings: TestKitSettings) = {
+  def this(config: Config, settings: TestKitSettings) =
     this(
       ActorTestKit(
         ActorTestKitBase.testNameFromCallStack(),
@@ -54,7 +56,6 @@ abstract class ActorSpec(testKit: ActorTestKit)
         settings
       )
     )
-  }
 
   implicit def classicSystem: ActorSystem = system.toClassic
 

```

## コミット: a326ab0

### メッセージ

```
refactor: スナップショットのProtobuf定義を簡素化し、イベントシリアライザーを追加
- UserAccount_NotCreatedSnapshotメッセージを削除し、ステータスフィールドベースの設計に変更
- 削除状態でも全データを保持することでリカバリコマンドに対応
- UserAccountEventSerializerを新規実装
- CLAUDE.mdファイルを作成してプロジェクト構造とコマンドをドキュメント化
```

### 変更されたファイル

- A	CLAUDE.md
- A	modules/command/interface-adapter-event-serializer/src/main/protobuf/users/event.proto
- A	modules/command/interface-adapter-event-serializer/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountEventSerializer.scala
- M	modules/command/interface-adapter/src/main/protobuf/users/snapshot.proto
- M	modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountAggregate.scala
- M	modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountAggregateState.scala
- M	modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountSnapshotSerializer.scala

### 変更内容

```diff
commit a326ab0986aaeed06586aa8131d4e4c5e1b94b40
Author: Junichi Kato <j5ik2o@gmail.com>
Date:   Sat Sep 13 13:06:19 2025 +0900

    refactor: スナップショットのProtobuf定義を簡素化し、イベントシリアライザーを追加
    
    - UserAccount_NotCreatedSnapshotメッセージを削除し、ステータスフィールドベースの設計に変更
    - 削除状態でも全データを保持することでリカバリコマンドに対応
    - UserAccountEventSerializerを新規実装
    - CLAUDE.mdファイルを作成してプロジェクト構造とコマンドをドキュメント化

diff --git a/CLAUDE.md b/CLAUDE.md
new file mode 100644
index 0000000..feeb66c
--- /dev/null
+++ b/CLAUDE.md
@@ -0,0 +1,141 @@
+# CLAUDE.md
+
+このファイルは、このリポジトリでClaude Code (claude.ai/code) を使用する際のガイダンスを提供します。
+
+## 注意事項
+
+- 日本語で応対すること
+
+## プロジェクト概要
+
+Apache Pekko（Akkaからのフォーク）を使用したScala 3のCQRS/イベントソーシング実装例です。コマンド側とクエリ側を適切に分離したクリーンアーキテクチャを実証しています。
+
+## ビルドシステム
+
+このプロジェクトはSBTをビルドツールとして使用しています。バージョン情報は`project/build.properties`および`project/Dependencies.scala`を参照してください。
+
+### 必須コマンド
+
+```bash
+# 全モジュールのコンパイル
+sbt compile
+
+# テストの実行
+sbt test
+
+# カバレッジ付きテストの実行
+sbt testCoverage
+
+# コードフォーマット
+sbt fmt
+
+# フォーマットとリントのチェック
+sbt lint
+
+# クリーンとコンパイル
+sbt clean compile
+
+# 単一テストの実行
+sbt "testOnly <完全修飾クラス名>"
+
+# 特定モジュールのテスト実行
+sbt "commandDomain/test"
+sbt "queryInterfaceAdapter/test"
+
+# データベースマイグレーション（クエリ側）
+sbt migrateQuery        # マイグレーション実行
+sbt infoQuery          # マイグレーション情報表示
+sbt validateQuery      # マイグレーション検証
+sbt cleanMigrateQuery  # クリーン後マイグレーション
+
+# Docker操作
+sbt dockerBuildAll     # 全サービスのDockerイメージビルド
+
+# DAO生成（クエリ側）
+sbt "queryInterfaceAdapter/generateAllWithDb"
+```
+
+## アーキテクチャ
+
+このシステムはCQRS（コマンドクエリ責任分離）とイベントソーシングパターンを採用したレイヤードアーキテクチャに従っています：
+
+### モジュール構造
+
+```
+modules/
+├── infrastructure/           # 共有インフラコード（シリアライゼーション、ユーティリティ）
+├── command/                 # コマンド側（書き込みモデル）
+│   ├── domain/              # ドメインエンティティ、値オブジェクト、集約
+│   ├── use-case/            # アプリケーションサービス、コマンドハンドラ
+│   ├── interface-adapter/   # Pekkoアクター、永続化、HTTP/gRPCエンドポイント
+│   ├── interface-adapter-contract/  # コマンド用Protobuf定義
+│   └── interface-adapter-event-serializer/  # イベントシリアライゼーション
+└── query/                   # クエリ側（読み取りモデル）
+    ├── interface-adapter/   # GraphQL API、Slick DAO、プロジェクション
+    └── flyway-migration/    # データベースマイグレーション
+
+apps/
+├── command-api/            # コマンド側HTTP/gRPCサーバー
+├── query-api/             # クエリ側GraphQLサーバー
+└── read-model-updater/    # イベントプロセッサ（イベントから読み取りモデルを更新）
+```
+
+### 主要アーキテクチャパターン
+
+1. **イベントソーシング**: Pekko Persistenceを使用して全ての状態変更をイベントとして記録
+2. **CQRS**: 書き込み（コマンド）と読み取り（クエリ）のモデルを分離
+3. **アクターモデル**: コマンド処理にPekko型付きアクターを使用
+4. **イベント駆動**: イベント処理により読み取りモデルを非同期に更新
+5. **Protobuf**: イベント/スナップショットのシリアライゼーションに使用
+6. **GraphQL**: Sangria GraphQLでクエリAPIを公開
+
+### 技術スタック
+
+- **言語**: Scala 3
+- **ビルドツール**: SBT
+- **アクターフレームワーク**: Apache Pekko (型付きアクター、永続化、クラスター)
+- **シリアライゼーション**: Protocol Buffers (ScalaPB経由)
+- **クエリAPI**: GraphQL (Sangria)
+- **データベースアクセス**: Slick
+- **データベース**: PostgreSQL
+- **HTTP**: Pekko HTTP
+- **非同期/エフェクト**: ZIO
+- **テスティング**: ScalaTest
+
+
+## 実装上の重要事項
+
+### Protobufファイル
+- Protocol Buffer定義は `src/main/protobuf/` ディレクトリに配置
+- `.proto` ファイル変更後は `sbt compile` でScalaコードを再生成
+- 生成コードは `target/scala-*/pekko-grpc/main/` に出力される
+
+### イベントシリアライゼーション
+- イベントはProtocol Buffersでシリアライズ
+- カスタムシリアライザは `SerializerWithStringManifest` を継承
+- シリアライザIDは一意である必要がある（application.confで設定）
+
+### データベーススキーマ
+- クエリ側はPostgreSQLとFlywayマイグレーションを使用
+- DAOクラスはsbt-dao-generatorでデータベーススキーマから自動生成
+- スキーマ変更後は `sbt "queryInterfaceAdapter/generateAllWithDb"` でDAOを再生成
+
+### テスティング
+- ユニットテストはScalaTestを使用
+- Pekkoアクターは `ActorTestKit` でテスト
+- JVM状態の問題を避けるため、テストでは `fork := true` を使用
+
+### Gitコミットガイドライン
+- Conventional Commits形式を使用
+- コミットメッセージは日本語で記述
+- コミットに「Claude Code」への参照を含めない
+
+## 開発ワークフロー
+
+1. まずドメイン層またはユースケース層を変更
+2. 新機能を公開するためインターフェースアダプターを更新
+3. イベント変更時はprotobuf定義とシリアライザを更新
+4. クエリ側変更時はマイグレーション更新後にDAOを再生成
+5. `sbt compile` でビルドが通ることを確認
+6. `sbt test` でテストが通ることを確認
+7. コミット前に `sbt lint` でコードスタイルをチェック
\ No newline at end of file
diff --git a/modules/command/interface-adapter/src/main/protobuf/users/basic.proto b/modules/command/interface-adapter-contract/src/main/protobuf/basic/basic.proto
similarity index 100%
rename from modules/command/interface-adapter/src/main/protobuf/users/basic.proto
rename to modules/command/interface-adapter-contract/src/main/protobuf/basic/basic.proto
diff --git a/modules/command/interface-adapter-event-serializer/src/main/protobuf/users/event.proto b/modules/command/interface-adapter-event-serializer/src/main/protobuf/users/event.proto
new file mode 100644
index 0000000..e59222b
--- /dev/null
+++ b/modules/command/interface-adapter-event-serializer/src/main/protobuf/users/event.proto
@@ -0,0 +1,36 @@
+syntax = "proto3";
+
+package io.github.j5ik2o.pcqrses.command.interfaceAdapter.persistence.users;
+
+import "google/protobuf/timestamp.proto";
+import "basic/basic.proto";
+
+message UserAccountEvent {
+  oneof event {
+    UserAccount_CreatedEvent created = 1;
+    UserAccount_RenamedEvent renamed = 2;
+    UserAccount_DeletedEvent deleted = 3;
+  }
+}
+
+message UserAccount_CreatedEvent {
+  string event_id = 1;
+  string user_account_id = 2;
+  basic.UserAccountName user_name = 3;
+  string email_address = 4;
+  google.protobuf.Timestamp occurred_at = 5;
+}
+
+message UserAccount_RenamedEvent {
+  string event_id = 1;
+  string user_account_id = 2;
+  basic.UserAccountName old_name = 3;
+  basic.UserAccountName new_name = 4;
+  google.protobuf.Timestamp occurred_at = 5;
+}
+
+message UserAccount_DeletedEvent {
+  string event_id = 1;
+  string user_account_id = 2;
+  google.protobuf.Timestamp occurred_at = 3;
+}
\ No newline at end of file
diff --git a/modules/command/interface-adapter-event-serializer/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountEventSerializer.scala b/modules/command/interface-adapter-event-serializer/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountEventSerializer.scala
new file mode 100644
index 0000000..d20c0d3
--- /dev/null
+++ b/modules/command/interface-adapter-event-serializer/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountEventSerializer.scala
@@ -0,0 +1,130 @@
+package io.github.j5ik2o.pcqrses.interfaceAdapter.users
+
+import io.github.j5ik2o.pcqrses.command.interfaceAdapter.persistence.users.{
+  UserAccountEvent as ProtoUserAccountEvent,
+  UserAccount_CreatedEvent,
+  UserAccount_RenamedEvent,
+  UserAccount_DeletedEvent
+}
+import io.github.j5ik2o.pcqrses.command.interfaceAdapter.persistence.basic.UserAccountName as ProtoUserAccountName
+
+import io.github.j5ik2o.pcqrses.domain.basic.DateTime
+import io.github.j5ik2o.pcqrses.domain.support.DomainEventId
+import io.github.j5ik2o.pcqrses.domain.users.{
+  EmailAddress as DomainEmailAddress,
+  FirstName,
+  LastName,
+  UserAccountEvent as DomainUserAccountEvent,
+  UserAccountId as DomainUserAccountId,
+  UserAccountName as DomainUserAccountName
+}
+import org.apache.pekko.serialization.SerializerWithStringManifest
+
+class UserAccountEventSerializer extends SerializerWithStringManifest {
+
+  override def identifier: Int = 20002
+
+  override def manifest(o: AnyRef): String = {
+    o match {
+      case _: DomainUserAccountEvent.Created => "Created"
+      case _: DomainUserAccountEvent.Renamed => "Renamed"
+      case _: DomainUserAccountEvent.Deleted => "Deleted"
+    }
+  }
+
+  override def toBinary(o: AnyRef): Array[Byte] = {
+    val protoEvent = o match {
+      case DomainUserAccountEvent.Created(id, entityId, name, emailAddress, occurredAt) =>
+        ProtoUserAccountEvent(
+          event = ProtoUserAccountEvent.Event.Created(
+            UserAccount_CreatedEvent(
+              eventId = id.asString,
+              userAccountId = entityId.asString,
+              userName = Some(ProtoUserAccountName(
+                name.breachEncapsulationOfFirstName.asString,
+                name.breachEncapsulationOfLastName.asString
+              )),
+              emailAddress = emailAddress.asString,
+              occurredAt = {
+                val sn = occurredAt.toSecondsAndNanos
+                Some(com.google.protobuf.timestamp.Timestamp(sn._1, sn._2))
+              }
+            )
+          )
+        )
+      case DomainUserAccountEvent.Renamed(id, entityId, oldName, newName, occurredAt) =>
+        ProtoUserAccountEvent(
+          event = ProtoUserAccountEvent.Event.Renamed(
+            UserAccount_RenamedEvent(
+              eventId = id.asString,
+              userAccountId = entityId.asString,
+              oldName = Some(ProtoUserAccountName(
+                oldName.breachEncapsulationOfFirstName.asString,
+                oldName.breachEncapsulationOfLastName.asString
+              )),
+              newName = Some(ProtoUserAccountName(
+                newName.breachEncapsulationOfFirstName.asString,
+                newName.breachEncapsulationOfLastName.asString
+              )),
+              occurredAt = {
+                val sn = occurredAt.toSecondsAndNanos
+                Some(com.google.protobuf.timestamp.Timestamp(sn._1, sn._2))
+              }
+            )
+          )
+        )
+      case DomainUserAccountEvent.Deleted(id, entityId, occurredAt) =>
+        ProtoUserAccountEvent(
+          event = ProtoUserAccountEvent.Event.Deleted(
+            UserAccount_DeletedEvent(
+              eventId = id.asString,
+              userAccountId = entityId.asString,
+              occurredAt = {
+                val sn = occurredAt.toSecondsAndNanos
+                Some(com.google.protobuf.timestamp.Timestamp(sn._1, sn._2))
+              }
+            )
+          )
+        )
+    }
+    protoEvent.toByteArray
+  }
+
+  override def fromBinary(bytes: Array[Byte], manifest: String): AnyRef = {
+    ProtoUserAccountEvent.parseFrom(bytes).event match {
+      case ProtoUserAccountEvent.Event.Created(value) =>
+        DomainUserAccountEvent.Created(
+          id = DomainEventId.from(value.eventId),
+          entityId = DomainUserAccountId.from(value.userAccountId),
+          name = DomainUserAccountName(
+            FirstName(value.userName.get.firstName),
+            LastName(value.userName.get.lastName)
+          ),
+          emailAddress = DomainEmailAddress(value.emailAddress),
+          occurredAt = DateTime.fromSecondsAndNanos(value.occurredAt.get.seconds, value.occurredAt.get.nanos)
+        )
+      case ProtoUserAccountEvent.Event.Renamed(value) =>
+        DomainUserAccountEvent.Renamed(
+          id = DomainEventId.from(value.eventId),
+          entityId = DomainUserAccountId.from(value.userAccountId),
+          oldName = DomainUserAccountName(
+            FirstName(value.oldName.get.firstName),
+            LastName(value.oldName.get.lastName)
+          ),
+          newName = DomainUserAccountName(
+            FirstName(value.newName.get.firstName),
+            LastName(value.newName.get.lastName)
+          ),
+          occurredAt = DateTime.fromSecondsAndNanos(value.occurredAt.get.seconds, value.occurredAt.get.nanos)
+        )
+      case ProtoUserAccountEvent.Event.Deleted(value) =>
+        DomainUserAccountEvent.Deleted(
+          id = DomainEventId.from(value.eventId),
+          entityId = DomainUserAccountId.from(value.userAccountId),
+          occurredAt = DateTime.fromSecondsAndNanos(value.occurredAt.get.seconds, value.occurredAt.get.nanos)
+        )
+      case ProtoUserAccountEvent.Event.Empty =>
+        throw new IllegalArgumentException("Unexpected Empty event in UserAccountEvent")
+    }
+  }
+}
\ No newline at end of file
diff --git a/modules/command/interface-adapter/src/main/protobuf/users/snapshot.proto b/modules/command/interface-adapter/src/main/protobuf/users/snapshot.proto
index 0e4b7da..41229cc 100644
--- a/modules/command/interface-adapter/src/main/protobuf/users/snapshot.proto
+++ b/modules/command/interface-adapter/src/main/protobuf/users/snapshot.proto
@@ -1,33 +1,23 @@
 syntax = "proto3";
 
-// Brought in from scalapb-runtime
-import "google/protobuf/timestamp.proto";
-import "users/basic.proto";
-
 package io.github.j5ik2o.pcqrses.command.interfaceAdapter.persistence.users;
 
-message UserAccountSnapshot {
-  oneof state {
-    UserAccount_NotCreatedSnapshot not_created = 1;
-    UserAccount_CreatedSnapshot created = 2;
-    UserAccount_DeletedSnapshot deleted = 3;
-  }
-}
-
-message UserAccount_NotCreatedSnapshot {
-  string user_account_id = 1;
-}
+// Brought in from scalapb-runtime
+import "google/protobuf/timestamp.proto";
+import "basic/basic.proto";
 
-message UserAccount_CreatedSnapshot {
-  string user_account_id = 1;
-  UserAccountName user_name = 2;
-  string email_address = 3;
-  google.protobuf.Timestamp created_at = 4;
-  google.protobuf.Timestamp updated_at = 5;
+enum UserAccountStatus {
+  UNKNOWN = 0;  // protobufのデフォルト値として予約
+  CREATED = 1;
+  DELETED = 2;
 }
 
-message UserAccount_DeletedSnapshot {
+message UserAccountSnapshot {
   string user_account_id = 1;
-  google.protobuf.Timestamp created_at = 4;
-  google.protobuf.Timestamp updated_at = 5;
+  UserAccountStatus status = 2;
+  // 以下のフィールドはstatusがCREATED以上の時に設定される
+  basic.UserAccountName user_name = 3;
+  string email_address = 4;
+  google.protobuf.Timestamp created_at = 5;
+  google.protobuf.Timestamp updated_at = 6;
 }
diff --git a/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountAggregate.scala b/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountAggregate.scala
index 3a02d6d..f7c7bfa 100644
--- a/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountAggregate.scala
+++ b/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountAggregate.scala
@@ -55,7 +55,7 @@ object UserAccountAggregate {
           case Right((newUser, event)) =>
             effector.persistEvent(event) { _ =>
               replyTo ! DeleteSucceeded(id)
-              handleDeleted(UserAccountAggregateState.Deleted(newUser.id), effector)
+              handleDeleted(UserAccountAggregateState.Deleted(newUser), effector)
             }
         }
       case Get(id, replyTo) if state.user.id == id =>
@@ -66,10 +66,9 @@ object UserAccountAggregate {
   private def handleDeleted(
     state: UserAccountAggregateState.Deleted,
     effector: PersistenceEffector[UserAccountAggregateState, UserAccountEvent, Command])
-    : Behavior[Command] = Behaviors.receiveMessagePartial {
-    case Get(id, replyTo) =>
-      replyTo ! GetNotFoundFailed(id)
-      Behaviors.same
+    : Behavior[Command] = Behaviors.receiveMessagePartial { case Get(id, replyTo) =>
+    replyTo ! GetNotFoundFailed(id)
+    Behaviors.same
   }
 
   def apply(id: UserAccountId): Behavior[Command] = {
@@ -93,6 +92,8 @@ object UserAccountAggregate {
                 handleNotCreated(initialState, effector)
               case (initialState: UserAccountAggregateState.Created, effector) =>
                 handleCreated(initialState, effector)
+              case (initialState: UserAccountAggregateState.Deleted, effector) =>
+                handleDeleted(initialState, effector)
             })
         .onFailure[IllegalArgumentException](
           SupervisorStrategy.restart
diff --git a/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountAggregateState.scala b/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountAggregateState.scala
index 188cd93..439964c 100644
--- a/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountAggregateState.scala
+++ b/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountAggregateState.scala
@@ -5,14 +5,15 @@ import io.github.j5ik2o.pcqrses.domain.users.{UserAccount, UserAccountEvent, Use
 enum UserAccountAggregateState {
   case NotCreated(id: UserAccountId)
   case Created(user: UserAccount)
-  case Deleted(id: UserAccountId)
+  case Deleted(user: UserAccount) // 削除状態でも全情報を保持
 
   def applyEvent(event: UserAccountEvent): UserAccountAggregateState = (this, event) match {
     case (NotCreated(id), UserAccountEvent.Created(_, entityId, name, emailAddress, _))
         if id == entityId =>
       Created(UserAccount(entityId, name, emailAddress)._1)
 
-    case (Created(user), UserAccountEvent.Renamed(_, entityId, _, newName, _)) if user.id == entityId =>
+    case (Created(user), UserAccountEvent.Renamed(_, entityId, _, newName, _))
+        if user.id == entityId =>
       Created(user.rename(newName) match {
         case Right((u, _)) => u
         case Left(error) =>
@@ -21,7 +22,7 @@ enum UserAccountAggregateState {
 
     case (Created(user), UserAccountEvent.Deleted(_, entityId, _)) if user.id == entityId =>
       Deleted(user.delete match {
-        case Right((u, _)) => u.id
+        case Right((deletedUser, _)) => deletedUser
         case Left(error) =>
           throw new IllegalStateException(s"Failed to delete user: $error")
       })
diff --git a/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountSnapshotSerializer.scala b/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountSnapshotSerializer.scala
index 93b35b0..0a626f2 100644
--- a/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountSnapshotSerializer.scala
+++ b/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountSnapshotSerializer.scala
@@ -1,77 +1,124 @@
 package io.github.j5ik2o.pcqrses.interfaceAdapter.users
 
-import io.github.j5ik2o.pcqrses.command.interfaceAdapter.persistence.users.{UserAccountSnapshot, UserAccount_CreatedSnapshot, UserAccount_DeletedSnapshot, UserAccount_NotCreatedSnapshot, UserAccountName as ProtoUserAccountName}
+import io.github.j5ik2o.pcqrses.command.interfaceAdapter.persistence.users.{
+  UserAccountSnapshot,
+  UserAccountStatus
+}
+import io.github.j5ik2o.pcqrses.command.interfaceAdapter.persistence.basic.UserAccountName as ProtoUserAccountName
+
 import io.github.j5ik2o.pcqrses.domain.basic.DateTime
-import io.github.j5ik2o.pcqrses.domain.users.{EmailAddress as DomainEmailAddress, FirstName, LastName, UserAccount as DomainUserAccount, UserAccountId as DomainUserAccountId, UserAccountName as DomainUserAccountName}
-import io.github.j5ik2o.pcqrses.interfaceAdapter.users.UserAccountAggregateState.{Created, Deleted, NotCreated}
+import io.github.j5ik2o.pcqrses.domain.users.{
+  EmailAddress as DomainEmailAddress,
+  FirstName,
+  LastName,
+  UserAccount as DomainUserAccount,
+  UserAccountId as DomainUserAccountId,
+  UserAccountName as DomainUserAccountName
+}
+import io.github.j5ik2o.pcqrses.interfaceAdapter.users.UserAccountAggregateState.{
+  Created,
+  Deleted,
+  NotCreated
+}
 import org.apache.pekko.serialization.SerializerWithStringManifest
 
 class UserAccountSnapshotSerializer extends SerializerWithStringManifest {
 
   override def identifier: Int = 20001
 
-  override def manifest(o: AnyRef): String = {
+  override def manifest(o: AnyRef): String =
     o match {
-      case _: NotCreated => "NotCreated"
       case _: Created => "Created"
       case _: Deleted => "Deleted"
+      case _: NotCreated =>
+        throw new IllegalArgumentException("NotCreated state should not be serialized")
     }
-  }
 
   override def toBinary(o: AnyRef): Array[Byte] = {
     val snapshot = o match {
-      case NotCreated(id) =>
-        UserAccountSnapshot(
-          state = UserAccountSnapshot.State.NotCreated(UserAccount_NotCreatedSnapshot(id.asString))
-        )
       case Created(userAccount) =>
         UserAccountSnapshot(
-          state = UserAccountSnapshot.State.Created(
-            UserAccount_CreatedSnapshot(
-              userAccountId = userAccount.id.asString,
-              userName = Some(ProtoUserAccountName(userAccount.name.breachEncapsulationOfFirstName.asString, userAccount.name.breachEncapsulationOfLastName.asString)),
-              emailAddress = userAccount.emailAddress.asString,
-              createdAt = {
-                val sn = userAccount.createdAt.toSecondsAndNanos
-                Some(com.google.protobuf.timestamp.Timestamp(sn._1, sn._2))
-              },
-              updatedAt = {
-                val sn = userAccount.updatedAt.toSecondsAndNanos
-                Some(com.google.protobuf.timestamp.Timestamp(sn._1, sn._2))
-              }
-            )
-          ))
-      case Deleted(id) =>
+          userAccountId = userAccount.id.asString,
+          status = UserAccountStatus.CREATED,
+          userName = Some(
+            ProtoUserAccountName(
+              userAccount.name.breachEncapsulationOfFirstName.asString,
+              userAccount.name.breachEncapsulationOfLastName.asString
+            )),
+          emailAddress = userAccount.emailAddress.asString,
+          createdAt = {
+            val sn = userAccount.createdAt.toSecondsAndNanos
+            Some(com.google.protobuf.timestamp.Timestamp(sn._1, sn._2))
+          },
+          updatedAt = {
+            val sn = userAccount.updatedAt.toSecondsAndNanos
+            Some(com.google.protobuf.timestamp.Timestamp(sn._1, sn._2))
+          }
+        )
+      case Deleted(userAccount) =>
+        // Deleted状態でも全情報を保持（リカバリ用）
         UserAccountSnapshot(
-          state = UserAccountSnapshot.State.Deleted(
-            UserAccount_DeletedSnapshot(
-              userAccountId = id.asString,
-            )
-          ))
+          userAccountId = userAccount.id.asString,
+          status = UserAccountStatus.DELETED,
+          userName = Some(
+            ProtoUserAccountName(
+              userAccount.name.breachEncapsulationOfFirstName.asString,
+              userAccount.name.breachEncapsulationOfLastName.asString
+            )),
+          emailAddress = userAccount.emailAddress.asString,
+          createdAt = {
+            val sn = userAccount.createdAt.toSecondsAndNanos
+            Some(com.google.protobuf.timestamp.Timestamp(sn._1, sn._2))
+          },
+          updatedAt = {
+            val sn = userAccount.updatedAt.toSecondsAndNanos
+            Some(com.google.protobuf.timestamp.Timestamp(sn._1, sn._2))
+          }
+        )
+      case NotCreated(_) =>
+        throw new IllegalArgumentException("NotCreated state should not be serialized")
     }
     snapshot.toByteArray
   }
 
   override def fromBinary(bytes: Array[Byte], manifest: String): AnyRef = {
-    UserAccountSnapshot.parseFrom(bytes).state match {
-      case UserAccountSnapshot.State.NotCreated(value) =>
-        NotCreated(DomainUserAccountId.from(value.userAccountId))
-      case UserAccountSnapshot.State.Created(value) =>
+    val snapshot = UserAccountSnapshot.parseFrom(bytes)
+    snapshot.status match {
+      case UserAccountStatus.CREATED =>
         val (userAccount, _) = DomainUserAccount(
-          id = DomainUserAccountId.from(value.userAccountId),
+          id = DomainUserAccountId.from(snapshot.userAccountId),
           name = DomainUserAccountName(
-            FirstName(value.userName.get.firstName),
-            LastName(value.userName.get.lastName)
+            FirstName(snapshot.userName.get.firstName),
+            LastName(snapshot.userName.get.lastName)
           ),
-          emailAddress = DomainEmailAddress(value.emailAddress),
-          createdAt = DateTime.fromSecondsAndNanos(value.createdAt.get.seconds, value.createdAt.get.nanos),
-          updatedAt = DateTime.fromSecondsAndNanos(value.updatedAt.get.seconds, value.updatedAt.get.nanos),
+          emailAddress = DomainEmailAddress(snapshot.emailAddress),
+          createdAt = DateTime.fromSecondsAndNanos(
+            snapshot.createdAt.get.seconds,
+            snapshot.createdAt.get.nanos),
+          updatedAt = DateTime.fromSecondsAndNanos(
+            snapshot.updatedAt.get.seconds,
+            snapshot.updatedAt.get.nanos)
         )
         Created(userAccount)
-      case UserAccountSnapshot.State.Deleted(value) =>
-        Deleted(DomainUserAccountId.from(value.userAccountId))
-      case UserAccountSnapshot.State.Empty =>
-        throw new IllegalArgumentException("Unexpected Empty state in snapshot")
+      case UserAccountStatus.DELETED =>
+        // Deleted状態でも全情報から復元
+        val (userAccount, _) = DomainUserAccount(
+          id = DomainUserAccountId.from(snapshot.userAccountId),
+          name = DomainUserAccountName(
+            FirstName(snapshot.userName.get.firstName),
+            LastName(snapshot.userName.get.lastName)
+          ),
+          emailAddress = DomainEmailAddress(snapshot.emailAddress),
+          createdAt = DateTime.fromSecondsAndNanos(
+            snapshot.createdAt.get.seconds,
+            snapshot.createdAt.get.nanos),
+          updatedAt = DateTime.fromSecondsAndNanos(
+            snapshot.updatedAt.get.seconds,
+            snapshot.updatedAt.get.nanos)
+        )
+        Deleted(userAccount)
+      case UserAccountStatus.UNKNOWN | UserAccountStatus.Unrecognized(_) =>
+        throw new IllegalArgumentException(s"Unexpected status: ${snapshot.status}")
     }
   }
 }

```

## コミット: 47e10de

### メッセージ

```
test: ActorSpecテスト基底クラスを追加
Pekko Actorのテスト用基底クラスを追加:
- テストキット設定
- 共通セットアップ/クリーンアップ
```

### 変更されたファイル

- A	modules/command/interface-adapter/src/test/scala/io/github/j5ik2o/pcqrses/query/interfaceAdapter/test/ActorSpec.scala

### 変更内容

```diff
commit 47e10dec54bfc4265725c13420ab58a6ca564d67
Author: Junichi Kato <j5ik2o@gmail.com>
Date:   Sat Sep 13 09:30:07 2025 +0900

    test: ActorSpecテスト基底クラスを追加
    
    Pekko Actorのテスト用基底クラスを追加:
    - テストキット設定
    - 共通セットアップ/クリーンアップ

diff --git a/modules/command/interface-adapter/src/test/scala/io/github/j5ik2o/pcqrses/query/interfaceAdapter/test/ActorSpec.scala b/modules/command/interface-adapter/src/test/scala/io/github/j5ik2o/pcqrses/query/interfaceAdapter/test/ActorSpec.scala
new file mode 100644
index 0000000..5aa3c4c
--- /dev/null
+++ b/modules/command/interface-adapter/src/test/scala/io/github/j5ik2o/pcqrses/query/interfaceAdapter/test/ActorSpec.scala
@@ -0,0 +1,63 @@
+package io.github.j5ik2o.pcqrses.query.interfaceAdapter.test
+
+import com.typesafe.config.{Config, ConfigFactory}
+import org.apache.pekko.actor.ActorSystem
+import org.apache.pekko.actor.testkit.typed.TestKitSettings
+import org.apache.pekko.actor.testkit.typed.scaladsl.{ActorTestKit, ActorTestKitBase, ScalaTestWithActorTestKit}
+import org.apache.pekko.actor.typed.ActorRef
+import org.apache.pekko.actor.typed.scaladsl.adapter.*
+import org.scalatest.concurrent.{PatienceConfiguration, ScalaFutures}
+import org.scalatest.freespec.AnyFreeSpecLike
+import org.scalatest.time.{Millis, Seconds, Span}
+
+import scala.concurrent.duration.FiniteDuration
+
+/**
+ * Pekkoアクターテスト用の基底クラス
+ *
+ * テスト設定の共通化とヘルパーメソッドを提供
+ */
+abstract class ActorSpec(testKit: ActorTestKit)
+  extends ScalaTestWithActorTestKit(testKit)
+  with AnyFreeSpecLike
+  with ScalaFutures
+  with PatienceConfiguration {
+
+  def testTimeFactor: Double = testKit.testKitSettings.TestTimeFactor
+
+  implicit override val patienceConfig: PatienceConfig =
+    PatienceConfig(
+      timeout = scaled(Span(15 * testTimeFactor, Seconds)),
+      interval = scaled(Span(15 * testTimeFactor, Millis))
+    )
+
+  def this() = this(ActorTestKit(ActorTestKitBase.testNameFromCallStack()))
+
+  def this(config: String) = {
+    this(
+      ActorTestKit(
+        ActorTestKitBase.testNameFromCallStack(),
+        ConfigFactory.parseString(config)
+      )
+    )
+  }
+
+  def this(config: Config) = {
+    this(ActorTestKit(ActorTestKitBase.testNameFromCallStack(), config))
+  }
+
+  def this(config: Config, settings: TestKitSettings) = {
+    this(
+      ActorTestKit(
+        ActorTestKitBase.testNameFromCallStack(),
+        config,
+        settings
+      )
+    )
+  }
+
+  implicit def classicSystem: ActorSystem = system.toClassic
+
+  def killActors(actors: ActorRef[?]*)(maxDuration: FiniteDuration = timeout.duration): Unit =
+    actors.foreach(actorRef => testKit.stop(actorRef, maxDuration))
+}

```

## コミット: 76b6aa8

### メッセージ

```
feat: SBTプロジェクト設定を追加
- build.sbt: プロジェクト構成とモジュール定義
- Dependencies.scala: 依存関係の管理
- plugins.sbt: SBTプラグインの設定
- build.properties: SBTバージョン指定
```

### 変更されたファイル

- A	build.sbt
- A	project/Dependencies.scala
- A	project/build.properties
- A	project/plugins.sbt

### 変更内容

```diff
commit 76b6aa8f27efe2fad72a8110da0aa93bc1c47bac
Author: Junichi Kato <j5ik2o@gmail.com>
Date:   Sat Sep 13 09:29:48 2025 +0900

    feat: SBTプロジェクト設定を追加
    
    - build.sbt: プロジェクト構成とモジュール定義
    - Dependencies.scala: 依存関係の管理
    - plugins.sbt: SBTプラグインの設定
    - build.properties: SBTバージョン指定

diff --git a/build.sbt b/build.sbt
new file mode 100644
index 0000000..7b55626
--- /dev/null
+++ b/build.sbt
@@ -0,0 +1,478 @@
+import Dependencies.*
+import jp.co.septeni_original.sbt.dao.generator.model.ColumnDesc
+
+import scala.sys.process.Process
+
+val basename = "pcqrses"
+val scala3Version = "3.6.2"
+val databaseName = s"${basename}_development"
+val generatorPortNumber = 55432 // DAO生成専用ポート
+lazy val generatorDatabaseUrl =
+  s"jdbc:postgresql://localhost:${generatorPortNumber}/${databaseName}?user=postgres&password=postgres"
+
+ThisBuild / organization := "io.github.j5ik2o"
+ThisBuild / scalaVersion := scala3Version
+ThisBuild / version := "0.1.0"
+
+ThisBuild / Test / fork := true
+ThisBuild / Test / testOptions += Tests.Argument(TestFrameworks.ScalaTest, "-oD")
+ThisBuild / Test / javaOptions += s"-Djacoco-agent.destfile=target/scala-${scalaVersion.value}/jacoco/data/jacoco.exec"
+
+// Lint warning の回避: これらの設定は jacoco プラグインで使用される可能性があるため残しておく
+Global / excludeLintKeys ++= Set(
+  jacocoIncludes,
+  jacocoExcludes,
+  Docker / dockerBaseImage
+)
+
+ThisBuild / jacocoIncludes := Seq("*io.github.j5ik2o*")
+ThisBuild / jacocoExcludes := Seq()
+
+// 共通の依存関係
+lazy val commonDependencies = Seq(
+  logback.classic,
+  slf4j.api,
+  slf4j.julToSlf4J,
+  scalatest.scalatest % Test
+)
+
+lazy val commonSettings = Seq(
+  libraryDependencies ++= commonDependencies,
+  scalacOptions ++= Seq(
+    "-encoding",
+    "utf8", // ソースファイルの文字コード指定
+    "-feature", // 言語機能使用時に警告
+    "-deprecation", // 非推奨API使用時に警告
+    "-unchecked", // 型消去によって型安全が損なわれる場合に詳細情報
+    "-source:3.4-migration", // 3.4へのマイグレーションモード
+    "-language:implicitConversions", // 暗黙の型変換を許可
+    "-language:higherKinds", // 高階型を許可
+    "-language:postfixOps", // 後置演算子を許可
+    "-explain", // コンパイルエラーと警告に詳細な説明を追加
+    "-explain-types", // 型関連のエラーで詳細な型情報を表示
+    "-Wunused:imports,privates", // 使用されていないインポートとプライベートメンバーに警告
+    "-rewrite", // 書き換えを有効に
+    "-no-indent", // インデント構文を拒否し、中括弧に変換
+    "-experimental"
+  ),
+  semanticdbEnabled := true,
+  semanticdbVersion := scalafixSemanticdb.revision
+)
+
+// Docker image common settings
+// Keep images free of secrets; pass credentials at runtime via compose/env.
+val dockerSettings = Seq(
+  Docker / dockerBaseImage := "eclipse-temurin:17-jre-focal"
+)
+
+lazy val infrastructure = (project in file("modules/infrastructure"))
+  .enablePlugins(JacocoPlugin)
+  .settings(commonSettings)
+  .settings(
+    name := "infrastructure",
+    libraryDependencies ++= Seq(
+      circe.core,
+      circe.generic,
+      circe.parser,
+      airframe.ulid,
+      zio.core,
+      zio.interopReactiveStreams
+    )
+  )
+
+// command modules
+
+lazy val commandDomain = (project in file("modules/command/domain"))
+  .enablePlugins(JacocoPlugin)
+  .settings(commonSettings)
+  .settings(
+    name := "command-domain",
+    libraryDependencies ++= Seq(
+      apache.commonsLang3
+    )
+  )
+  .dependsOn(infrastructure)
+
+lazy val commandInterfaceAdapterContract =
+  (project in file("modules/command/interface-adapter-contract"))
+    .enablePlugins(JacocoPlugin)
+    .settings(commonSettings)
+    .settings(
+      name := "command-interface-adapter-contract",
+      libraryDependencies ++= Seq(apachePekko.actorTyped)
+    )
+    .dependsOn(commandDomain, infrastructure)
+
+lazy val commandUseCase = (project in file("modules/command/use-case"))
+  .enablePlugins(JacocoPlugin)
+  .settings(commonSettings)
+  .settings(
+    name := "command-use-case",
+    libraryDependencies ++= Seq(
+      zio.core,
+      zio.streams,
+      zio.interopReactiveStreams,
+      apachePekko.actorTestKitTyped % Test,
+      scalatest.scalatest % Test,
+      zio.test % Test,
+      zio.testSbt % Test
+    )
+  )
+  .dependsOn(
+    commandDomain,
+    commandInterfaceAdapterContract,
+    infrastructure
+  )
+
+lazy val commandInterfaceAdapterEventSerializer =
+  (project in file("modules/command/interface-adapter-event-serializer"))
+    .enablePlugins(JacocoPlugin, PekkoGrpcPlugin)
+    .settings(commonSettings)
+    .settings(
+      name := "command-interface-adapter-event-serializer",
+      libraryDependencies ++= Seq(
+        apachePekko.grpcRuntime,
+        apachePekko.slf4j,
+        apachePekko.serializationJackson,
+        thesametScalapb.runtime % "protobuf",
+        thesametScalapb.grpcRuntime
+      ),
+      Compile / pekkoGrpcGeneratedSources := Seq(PekkoGrpc.Server),
+      PB.protocExecutable := file(sys.env.getOrElse("PROTOC_PATH", "/usr/bin/protoc")),
+      // 自動生成コードの警告を抑制（pekko-grpcディレクトリ内のみ）
+      Compile / scalacOptions ++= Seq(
+        "-Wconf:src=.*/target/.*pekko-grpc/.*:silent"
+      )
+    )
+    .dependsOn(commandUseCase, commandInterfaceAdapterContract, infrastructure)
+
+lazy val commandInterfaceAdapter = (project in file("modules/command/interface-adapter"))
+  .enablePlugins(JacocoPlugin, PekkoGrpcPlugin)
+  .settings(commonSettings)
+  .settings(
+    name := "command-interface-adapter",
+    libraryDependencies ++= Seq(
+      apachePekko.actorTyped,
+      apachePekko.stream,
+      zio.core,
+      zio.prelude,
+      zio.interopReactiveStreams,
+      apachePekko.http,
+      apachePekko.httpSprayJson,
+      apachePekko.persistenceTyped,
+      apachePekko.actorTestKitTyped % Test,
+      apachePekko.persistenceTestkit % Test,
+      apachePekko.discovery,
+      apachePekko.clusterTyped,
+      apachePekko.clusterShardingTyped,
+      githubJ5ik2o.pekkoPersistenceEffector,
+      googleapis.commonProtos
+    ),
+    Compile / pekkoGrpcGeneratedSources := Seq(PekkoGrpc.Server),
+    PB.protocExecutable := file(sys.env.getOrElse("PROTOC_PATH", "/usr/bin/protoc")),
+    // 自動生成コードの警告を抑制（pekko-grpcディレクトリ内のみ）
+    Compile / scalacOptions ++= Seq(
+      "-Wconf:src=.*/target/.*pekko-grpc/.*:silent"
+    )
+  )
+  .dependsOn(
+    commandUseCase,
+    commandInterfaceAdapterContract,
+    commandInterfaceAdapterEventSerializer,
+    infrastructure)
+
+lazy val commandApi = (project in file("apps/command-api"))
+  .enablePlugins(JacocoPlugin, JavaAppPackaging, DockerPlugin)
+  .settings(commonSettings)
+  .settings(dockerSettings)
+  .settings(
+    name := "command-api",
+    Compile / mainClass := Some("io.github.j5ik2o.pcqrses.commandapi.Main"),
+    Docker / packageName := s"${basename}-command-api",
+    Docker / version := "0.1.0",
+    Docker / dockerExposedPorts := Seq(18080),
+    dockerBaseImage := "eclipse-temurin:17-jre-focal",
+    libraryDependencies ++= Seq(
+      zio.core
+    )
+  )
+  .settings(
+    libraryDependencies ++= Seq(
+      githubJ5ik2o.pekkoPersistenceDynamoDBJournal,
+      githubJ5ik2o.pekkoPersistenceDynamoDBSnapshot,
+      apachePekko.clusterTyped,
+      apachePekko.clusterShardingTyped,
+      apachePekko.discovery,
+      apachePekko.pekkoManagement,
+      apachePekko.pekkoManagementClusterBootstrap,
+      apachePekko.pekkoManagementClusterHttp
+    )
+  )
+  .dependsOn(commandInterfaceAdapter, infrastructure)
+
+// --- query modules
+
+val TypeExtractor = ".*?/TYPE:(.*?)/.*".r
+
+lazy val queryInterfaceAdapter = (project in file("modules/query/interface-adapter"))
+  .enablePlugins(JacocoPlugin, SbtDaoGeneratorPlugin)
+  .settings(commonSettings)
+  .settings(
+    name := "query-interface-adapter",
+    libraryDependencies ++= Seq(
+      apachePekko.actorTyped,
+      apachePekko.stream,
+      apachePekko.http,
+      apachePekko.httpSprayJson,
+      apachePekko.grpcRuntime,
+      apachePekko.slf4j,
+      sangria.sangria,
+      sangria.sangriaCirce,
+      pekkoHttpCirce.pekkoHttpCirce,
+      slick.slick,
+      slick.hikariCP,
+      postgresql.postgresql
+    ),
+    generator / tableNameFilter := { tableName =>
+      tableName.toUpperCase != "SCHEMA_VERSION" && tableName.toUpperCase != "FLYWAY_SCHEMA_HISTORY"
+    },
+    generator / advancedPropertyTypeNameMapper := {
+      case (_, _, ColumnDesc(_, _, _, _, _, Some(TypeExtractor(t)), _)) => t.trim
+      case (s, _, _) if s.toUpperCase() == "BIGINT" => "Long"
+      case (s, _, _) if s.toUpperCase() == "INT4" => "Int"
+      case (s, _, _) if s.toUpperCase() == "NUMERIC" => "Int"
+      case (s, _, _) if s.toUpperCase() == "VARCHAR" => "String"
+      case (s, _, _) if s.toUpperCase() == "BPCHAR" => "String" // CHAR型をStringに変換
+      case (s, _, _) if s.toUpperCase() == "CHAR" => "String"
+      case (s, _, _) if s.toUpperCase() == "TEXT" => "String"
+      case (s, _, _) if s.toUpperCase() == "BOOLEAN" => "Boolean"
+      case (s, _, _) if s.toUpperCase() == "BOOL" => "Boolean"
+      case (s, _, _) if s.toUpperCase() == "DATE" => "java.time.LocalDate"
+      case (s, _, _) if s.toUpperCase() == "TIMESTAMP" => "java.sql.Timestamp"
+      case (s, _, _) if s.toUpperCase() == "TIMESTAMPTZ" => "java.sql.Timestamp"
+      case (s, _, _) if s.toUpperCase() == "DECIMAL" => "BigDecimal"
+      case (s, _, _) if s.toUpperCase() == "UUID" => "java.util.UUID"
+      case (s, _, _) if s.toUpperCase() == "INT2" => "Short"
+      case (s, _, _) if s.toUpperCase() == "INT8" => "Long"
+      case (s, _, _) if s.toUpperCase() == "FLOAT4" => "Float"
+      case (s, _, _) if s.toUpperCase() == "FLOAT8" => "Double"
+      case (s, _, _) if s.toUpperCase() == "JSON" => "String"
+      case (s, _, _) if s.toUpperCase() == "JSONB" => "String"
+      case (s, _, _) => s
+    },
+    generator / templateDirectory := baseDirectory.value / "templates",
+    generator / templateNameMapper := { (_: String) => "template.ftl" },
+    generator / outputDirectoryMapper := { (_: String) =>
+      (Compile / sourceDirectory).value / "scala" / "io" / "github" / "j5ik2o" / basename / "query" / "interfaceAdapter" / "dao"
+    },
+    // DAO生成用のJDBC設定（別ポート）
+    generator / driverClassName := "org.postgresql.Driver",
+    generator / jdbcUrl := generatorDatabaseUrl,
+    generator / jdbcUser := "postgres",
+    generator / jdbcPassword := "postgres",
+    // PostgreSQL起動タスク（DAO生成用）
+    TaskKey[Unit]("startPostgresForGenerate") := {
+      Process(s"docker rm -f ${generatorDockerName}").!
+      val cmd = List(
+        "docker",
+        "run",
+        "--name",
+        generatorDockerName,
+        "-e",
+        s"POSTGRES_USER=postgres",
+        "-e",
+        s"POSTGRES_PASSWORD=postgres",
+        "-e",
+        s"POSTGRES_DB=$databaseName",
+        "-p",
+        s"${generatorPortNumber}:5432",
+        "-d",
+        "postgres:11.4"
+      )
+      streams.value.log.info(
+        s"Starting PostgreSQL container: $generatorDockerName on port $generatorPortNumber")
+      Process(cmd).!
+      Thread.sleep(5000) // PostgreSQL起動待機
+    },
+    // PostgreSQL停止タスク（DAO生成用）
+    TaskKey[Unit]("stopPostgresForGenerate") := {
+      streams.value.log.info(s"Stopping PostgreSQL container: $generatorDockerName")
+      Process(s"docker rm -f ${generatorDockerName}").!
+    },
+    // generateAllWithDbという新しいタスクを定義（PostgreSQL起動→マイグレーション→生成→PostgreSQL停止を順次実行）
+    TaskKey[Seq[File]]("generateAllWithDb") := Def
+      .sequential(
+        TaskKey[Unit]("startPostgresForGenerate"),
+        queryFlywayMigration / flywayMigrate,
+        generator / generateAll,
+        TaskKey[Unit]("stopPostgresForGenerate").map(_ => Seq.empty[File])
+      )
+      .value
+  )
+  .dependsOn(infrastructure)
+
+val generatorDockerName = s"${basename}_postgres_generator" // DAO生成専用コンテナ名
+
+lazy val queryFlywayMigration = (project in file("modules/query/flyway-migration"))
+  .enablePlugins(FlywayPlugin, JacocoPlugin)
+  .settings(commonSettings)
+  .settings(
+    name := "query-flyway-migration",
+    libraryDependencies += "org.postgresql" % "postgresql" % "42.7.4",
+    // 開発環境のポート（50504）を使用
+    flywayUrl := generatorDatabaseUrl,
+    flywayDriver := "org.postgresql.Driver",
+    flywayLocations := Seq("classpath:db/migration"),
+    flywayBaselineOnMigrate := true,
+    flywayCleanDisabled := false
+  )
+  .dependsOn(infrastructure)
+
+lazy val queryApi = (project in file("apps/query-api"))
+  .enablePlugins(JacocoPlugin, JavaAppPackaging, DockerPlugin)
+  .settings(commonSettings)
+  .settings(dockerSettings)
+  .settings(
+    name := "query-api",
+    Compile / mainClass := Some(s"io.github.j5ik2o.${basename}.queryapi.Main"),
+    Docker / packageName := s"${basename}-query-api",
+    Docker / version := "0.1.0",
+    Docker / dockerExposedPorts := Seq(18082),
+    dockerBaseImage := "eclipse-temurin:17-jre-focal",
+    libraryDependencies += "org.apache.pekko" %% "pekko-discovery" % Version.pekko
+  )
+  .dependsOn(queryInterfaceAdapter, infrastructure)
+
+// Read Model Updater
+lazy val readModelUpdater = (project in file("apps/read-model-updater"))
+  .enablePlugins(JacocoPlugin, JavaAppPackaging, DockerPlugin)
+  .settings(commonSettings)
+  .settings(dockerSettings)
+  .settings(
+    name := "read-model-updater",
+    Compile / mainClass := Some(s"io.github.j5ik2o.${basename}.readmodelupdater.Main"),
+    // Docker設定
+    Docker / packageName := s"${basename}-read-model-updater",
+    Docker / version := "0.1.0",
+    dockerBaseImage := "eclipse-temurin:17-jre-focal",
+    // AWS Lambda用の設定（仮）
+    // FIXME: インフラストラクチャーに設定ファイルを置くのはよくない…。あとで直す
+    Universal / mappings += file(
+      "modules/infrastructure/src/main/resources/application.conf") -> "conf/application.conf",
+    Universal / javaOptions ++= Seq("-Dconfig.file=conf/application.conf"),
+    assembly / assemblyJarName := "read-model-updater-lambda.jar",
+    assembly / mainClass := Some(s"io.github.j5ik2o.${basename}.readmodelupdater.LambdaHandler"),
+    assembly / assemblyMergeStrategy := {
+      case PathList("META-INF", xs @ _*) => MergeStrategy.discard
+      case PathList("reference.conf") => MergeStrategy.concat
+      case PathList("application.conf") => MergeStrategy.concat
+      case x if x.endsWith(".proto") => MergeStrategy.first
+      case x if x.endsWith(".class") => MergeStrategy.first
+      case x if x.endsWith(".properties") => MergeStrategy.concat
+      case x if x.endsWith(".xml") => MergeStrategy.first
+      case x if x.endsWith(".txt") => MergeStrategy.concat
+      case x if x.endsWith(".dtd") => MergeStrategy.first
+      case x if x.endsWith(".xsd") => MergeStrategy.first
+      case x if x.contains("module-info") => MergeStrategy.discard
+      case _ => MergeStrategy.first
+    },
+    assembly / assemblyExcludedJars := {
+      val cp = (assembly / fullClasspath).value
+      cp filter { f =>
+        val name = f.data.getName.toLowerCase
+        // Scala compiler関連
+        name.contains("scala-compiler") ||
+        name.contains("scala-reflect") ||
+        (name.contains("scalap") && !name.contains("scalapb")) ||
+        name.contains("scala-xml") ||
+        name.contains("scala-parser") ||
+        // Pekko Serializationは保持、それ以外のPekkoモジュールは除外
+        name.contains("pekko-http") ||
+        name.contains("pekko-cluster") ||
+        // pekko-remoteとpekko-streamは必要なので除外しない
+        // name.contains("pekko-remote") ||
+        // name.contains("pekko-stream") ||
+        name.contains("pekko-management") ||
+        name.contains("pekko-discovery") ||
+        name.contains("pekko-coordination") ||
+        name.contains("pekko-persistence-dynamodb") ||
+        name.contains("pekko-persistence-query") ||
+        name.contains("pekko-persistence-journal") ||
+        name.contains("pekko-persistence-snapshot") ||
+        name.contains("pekko-testkit") ||
+        name.contains("pekko-slf4j") ||
+        // pekko-protobuf-v3は必要なので除外しない
+        (name.contains("pekko-protobuf") && !name.contains("pekko-protobuf-v3")) ||
+        // 大きくて不要な一部ライブラリのみ除外（DB関連は含める）
+        name.contains("flyway") ||
+        // テスト関連は除外
+        name.contains("scalatest") ||
+        name.contains("scalacheck") ||
+        name.contains("jacoco") ||
+        // その他の大きなライブラリ
+        name.contains("netty") ||
+        name.contains("grpc-netty") ||
+        name.contains("grpc-core") ||
+        name.contains("grpc-api") ||
+        name.contains("grpc-context") ||
+        name.contains("swagger") ||
+        name.contains("unused") ||
+        name.contains("zio-") ||
+        name.contains("cats-") ||
+        name.contains("shapeless")
+      }
+    },
+    libraryDependencies ++= Seq(
+      awsLambda.core,
+      awsLambda.events,
+      awsSdkV2.dynamodb,
+      jackson.databind,
+      jackson.moduleScala,
+      logback.classic,
+      slf4j.api,
+      thesametScalapb.runtime,
+      thesametScalapb.grpcRuntime,
+      apachePekko.actorTyped,
+      apachePekko.persistenceTyped,
+      apachePekko.serializationJackson,
+      apachePekko.remote,
+      apachePekko.stream,
+      apachePekko.protobufV3
+    )
+  )
+  .dependsOn(commandDomain, commandInterfaceAdapterEventSerializer, queryInterfaceAdapter)
+
+lazy val root = (project in file("."))
+  .enablePlugins(JacocoPlugin)
+  .settings(
+    name := s"${basename}-root",
+    jacocoAggregateReportSettings := JacocoReportSettings(
+      title = basename,
+      formats = Seq(JacocoReportFormats.ScalaHTML)
+    )
+  )
+  .aggregate(
+    commandDomain,
+    commandUseCase,
+    commandInterfaceAdapter,
+    commandApi,
+    queryInterfaceAdapter,
+    queryFlywayMigration,
+    queryApi,
+    readModelUpdater
+  )
+  .settings(commonSettings)
+
+addCommandAlias("lint", ";scalafmtCheck;test:scalafmtCheck;scalafmtSbtCheck;scalafixAll --check")
+addCommandAlias("fmt", ";scalafmtAll;scalafmtSbt;scalafix RemoveUnused")
+addCommandAlias("testCoverage", ";test;jacocoAggregateReport")
+
+addCommandAlias("migrateQuery", "queryFlywayMigration/flywayMigrate")
+addCommandAlias("infoQuery", "queryFlywayMigration/flywayInfo")
+addCommandAlias("validateQuery", "queryFlywayMigration/flywayValidate")
+addCommandAlias(
+  "cleanMigrateQuery",
+  ";queryFlywayMigration/flywayClean;queryFlywayMigration/flywayMigrate")
+
+addCommandAlias("dockerBuildAll", ";commandApi/docker:publishLocal;queryApi/docker:publishLocal")
+
diff --git a/project/Dependencies.scala b/project/Dependencies.scala
new file mode 100644
index 0000000..6dae04e
--- /dev/null
+++ b/project/Dependencies.scala
@@ -0,0 +1,158 @@
+import sbt._
+
+object Version {
+  val scalaTest = "3.2.12"
+  val pekko = "1.1.3"
+  val pekkoHttp = "1.2.0"
+  val pekkoGrpc = "1.1.1"
+
+  val actorTyped = "1.1.3"
+  val httpSprayJson = "1.2.0"
+  val slf4jVersion = "1.7.36"
+
+  val managementVersion = "1.1.1" // Pekko Management最新安定版
+}
+
+object Dependencies {
+  object apachePekko {
+    val slf4j = "org.apache.pekko" %% "pekko-slf4j" % Version.pekko
+
+    val actorTyped = "org.apache.pekko" %% "pekko-actor-typed" % Version.pekko
+    val actorTestKitTyped = "org.apache.pekko" %% "pekko-actor-testkit-typed" % Version.pekko
+
+    val stream = "org.apache.pekko" %% "pekko-stream" % Version.pekko
+    val streamTestKit = "org.apache.pekko" %% "pekko-stream-testkit" % Version.pekko
+
+    val persistenceTyped = "org.apache.pekko" %% "pekko-persistence-typed" % Version.pekko
+    val persistenceTestkit = "org.apache.pekko" %% "pekko-persistence-testkit" % Version.pekko
+
+    val serializationJackson = "org.apache.pekko" %% "pekko-serialization-jackson" % Version.pekko
+
+    val http = "org.apache.pekko" %% "pekko-http" % Version.pekkoHttp
+    val httpTestKit = "org.apache.pekko" %% "pekko-http-testkit" % Version.pekkoHttp
+    val httpSprayJson = "org.apache.pekko" %% "pekko-http-spray-json" % Version.httpSprayJson
+    val grpcRuntime = "org.apache.pekko" %% "pekko-grpc-runtime" % Version.pekkoGrpc
+
+    val clusterTyped = "org.apache.pekko" %% "pekko-cluster-typed" % Version.pekko
+    val clusterShardingTyped = "org.apache.pekko" %% "pekko-cluster-sharding-typed" % Version.pekko
+
+    val discovery = "org.apache.pekko" %% "pekko-discovery" % Version.pekko
+    val remote = "org.apache.pekko" %% "pekko-remote" % Version.pekko
+    val protobufV3 = "org.apache.pekko" %% "pekko-protobuf-v3" % Version.pekko
+    val pekkoManagement = "org.apache.pekko" %% "pekko-management" % Version.managementVersion
+    val pekkoManagementClusterBootstrap =
+      "org.apache.pekko" %% "pekko-management-cluster-bootstrap" % Version.managementVersion
+    val pekkoManagementClusterHttp =
+      "org.apache.pekko" %% "pekko-management-cluster-http" % Version.managementVersion
+  }
+
+  object logback {
+    val classic = "ch.qos.logback" % "logback-classic" % "1.3.14"
+  }
+
+  object slf4j {
+    val api = "org.slf4j" % "slf4j-api" % Version.slf4jVersion
+    val julToSlf4J = "org.slf4j" % "jul-to-slf4j" % Version.slf4jVersion
+  }
+
+  object fasterxml {
+    val jacksonModuleScala = "com.fasterxml.jackson.module" %% "jackson-module-scala" % "2.18.2"
+  }
+
+  object postgresql {
+    val postgresql = "org.postgresql" % "postgresql" % "42.7.5"
+  }
+
+  object thesametScalapb {
+    val runtime =
+      "com.thesamet.scalapb" %% "scalapb-runtime" % scalapb.compiler.Version.scalapbVersion
+    val grpcRuntime =
+      "com.thesamet.scalapb" %% "scalapb-runtime-grpc" % scalapb.compiler.Version.scalapbVersion
+
+  }
+
+  object googleapis {
+    val commonProtos =
+      "com.thesamet.scalapb.common-protos" %% "proto-google-common-protos-scalapb_0.11" % "2.9.6-0"
+  }
+
+  object scalameta {
+    val munit = "org.scalameta" %% "munit" % "1.0.0"
+  }
+
+  object scalatest {
+    val scalatest = "org.scalatest" %% "scalatest" % Version.scalaTest
+  }
+
+  object githubJ5ik2o {
+    val pekkoPersistenceDynamoDBJournal =
+      "io.github.j5ik2o" %% s"pekko-persistence-dynamodb-journal-v2" % "1.0.57"
+    val pekkoPersistenceDynamoDBSnapshot =
+      "io.github.j5ik2o" %% s"pekko-persistence-dynamodb-snapshot-v2" % "1.0.57"
+    val pekkoPersistenceEffector = "io.github.j5ik2o" %% "pekko-persistence-effector" % "0.8.11"
+  }
+
+  object circe {
+    val core = "io.circe" %% "circe-core" % "0.14.12"
+    val generic = "io.circe" %% "circe-generic" % "0.14.12"
+    val parser = "io.circe" %% "circe-parser" % "0.14.12"
+  }
+
+  object airframe {
+    val ulid = "org.wvlet.airframe" %% "airframe-ulid" % "2025.1.8"
+  }
+
+  object apache {
+    val commonsLang3 = "org.apache.commons" % "commons-lang3" % "3.17.0"
+  }
+
+  object typelevel {
+    val catsCore = "org.typelevel" %% "cats-core" % "2.12.0"
+    val catsEffect = "org.typelevel" %% "cats-effect" % "3.5.7"
+    val catsEffectKernel = "org.typelevel" %% "cats-effect-kernel" % "3.5.7"
+    val catsEffectStd = "org.typelevel" %% "cats-effect-std" % "3.5.7"
+    val catsEffectTesting = "org.typelevel" %% "cats-effect-testing-scalatest" % "1.5.0"
+  }
+
+  object zio {
+    val core = "dev.zio" %% "zio" % "2.0.21"
+    val streams = "dev.zio" %% "zio-streams" % "2.0.21"
+    val test = "dev.zio" %% "zio-test" % "2.0.21"
+    val testSbt = "dev.zio" %% "zio-test-sbt" % "2.0.21"
+    val interopReactiveStreams = "dev.zio" %% "zio-interop-reactivestreams" % "2.0.2"
+    val prelude = "dev.zio" %% "zio-prelude" % "1.0.0-RC21"
+  }
+
+  object sangria {
+    val sangria = "org.sangria-graphql" %% "sangria" % "4.2.4"
+    val sangriaCirce = "org.sangria-graphql" %% "sangria-circe" % "1.3.2"
+  }
+
+  object pekkoHttpCirce {
+    val pekkoHttpCirce = "com.github.pjfanning" %% "pekko-http-circe" % "3.2.2"
+  }
+
+  object slick {
+    val slick = "com.typesafe.slick" %% "slick" % "3.6.1"
+    val hikariCP = "com.typesafe.slick" %% "slick-hikaricp" % "3.6.1"
+  }
+
+  object kinesis {
+    // https://mvnrepository.com/artifact/software.amazon.kinesis/amazon-kinesis-client
+    val client = "software.amazon.kinesis" % "amazon-kinesis-client" % "3.0.3"
+  }
+
+  object awsLambda {
+    val core = "com.amazonaws" % "aws-lambda-java-core" % "1.2.3"
+    val events = "com.amazonaws" % "aws-lambda-java-events" % "3.11.6"
+  }
+
+  object awsSdkV2 {
+    val dynamodb = "software.amazon.awssdk" % "dynamodb" % "2.20.162"
+  }
+
+  object jackson {
+    val databind = "com.fasterxml.jackson.core" % "jackson-databind" % "2.18.2"
+    val moduleScala = "com.fasterxml.jackson.module" %% "jackson-module-scala" % "2.18.2"
+  }
+}
diff --git a/project/build.properties b/project/build.properties
new file mode 100644
index 0000000..cc68b53
--- /dev/null
+++ b/project/build.properties
@@ -0,0 +1 @@
+sbt.version=1.10.11
diff --git a/project/plugins.sbt b/project/plugins.sbt
new file mode 100644
index 0000000..b5cfaf7
--- /dev/null
+++ b/project/plugins.sbt
@@ -0,0 +1,33 @@
+// Database migration
+// https://github.com/flyway/flyway-sbt
+addSbtPlugin("com.github.sbt" % "flyway-sbt" % "10.21.0")
+
+// Native Packager
+addSbtPlugin("com.github.sbt" % "sbt-native-packager" % "1.11.3")
+
+addSbtPlugin("com.thesamet" % "sbt-protoc" % "1.0.7")
+
+addSbtPlugin("org.apache.pekko" % "pekko-grpc-sbt-plugin" % "1.1.1")
+
+// この対応を行わないと、環境変数を読み込むことができない
+// https://github.com/Philippus/sbt-dotenv?tab=readme-ov-file#illegal-reflective-access-warnings-and-exceptions
+addSbtPlugin("nl.gn0s1s" % "sbt-dotenv" % "3.1.1")
+
+addSbtPlugin("ch.epfl.scala" % "sbt-scalafix" % "0.14.2")
+
+addSbtPlugin("org.scalameta" % "sbt-scalafmt" % "2.5.4")
+
+addSbtPlugin("com.github.sbt" % "sbt-jacoco" % "3.5.0")
+
+// Assembly plugin for creating fat JARs
+addSbtPlugin("com.eed3si9n" % "sbt-assembly" % "2.1.5")
+
+// DAO Generator - 最後に読み込む
+addSbtPlugin(
+  ("io.github.sbt-dao-generator" % "sbt-dao-generator" % "1.4.1")
+    .exclude("org.scalameta", "scalafmt-dynamic_2.12"))
+
+libraryDependencies ++= Seq(
+  "org.flywaydb" % "flyway-database-postgresql" % "10.21.0",
+  "com.thesamet.scalapb" %% "compilerplugin" % "0.11.17"
+)

```

## コミット: a68d688

### メッセージ

```
feat: SlickDaoSupportの基底実装を追加
```

### 変更されたファイル

- A	modules/query/driver/src/main/scala/io/github/j5ik2o/pcqrses/driver/dao/slick/support/SlickDaoSupport.scala

### 変更内容

```diff
commit a68d68820577ddefac993925171acfc8994f132d
Author: Junichi Kato <j5ik2o@gmail.com>
Date:   Sat Sep 13 13:18:47 2025 +0900

    feat: SlickDaoSupportの基底実装を追加

diff --git a/modules/query/driver/src/main/scala/io/github/j5ik2o/pcqrses/driver/dao/slick/support/SlickDaoSupport.scala b/modules/query/driver/src/main/scala/io/github/j5ik2o/pcqrses/driver/dao/slick/support/SlickDaoSupport.scala
new file mode 100644
index 0000000..8f50f58
--- /dev/null
+++ b/modules/query/driver/src/main/scala/io/github/j5ik2o/pcqrses/driver/dao/slick/support/SlickDaoSupport.scala
@@ -0,0 +1,13 @@
+package io.github.j5ik2o.pcqrses.driver.dao.slick.support
+
+import slick.jdbc.JdbcProfile
+
+trait SlickDaoSupport {
+  val profile: JdbcProfile
+  import profile.api._
+  
+  // Common database operations and utilities
+  def withTransaction[T](action: DBIO[T]): DBIO[T] = {
+    action.transactionally
+  }
+}
\ No newline at end of file

```

## コミット: 6def815

### メッセージ

```
chore: スクリプトとツールの更新
スクリプト:
- Lambda関数のデプロイスクリプトを改善
- E2Eテストの実行スクリプトを更新
- 共通処理の最適化

ツール:
- pgAdmin設定ファイルの更新
- データベース接続情報の整理
```

### 変更されたファイル

- A	modules/query/interface-adapter/templates/template.ftl
- M	scripts/run-common.sh
- M	tools/pgadmin/servers.json

### 変更内容

```diff
commit 6def815f61e93895854ba945479ba96144a78a21
Author: Junichi Kato <j5ik2o@gmail.com>
Date:   Sat Sep 13 09:26:35 2025 +0900

    chore: スクリプトとツールの更新
    
    スクリプト:
    - Lambda関数のデプロイスクリプトを改善
    - E2Eテストの実行スクリプトを更新
    - 共通処理の最適化
    
    ツール:
    - pgAdmin設定ファイルの更新
    - データベース接続情報の整理

diff --git a/modules/query/interface-adapter/templates/template.ftl b/modules/query/interface-adapter/templates/template.ftl
new file mode 100644
index 0000000..5a092db
--- /dev/null
+++ b/modules/query/interface-adapter/templates/template.ftl
@@ -0,0 +1,42 @@
+package io.github.j5ik2o.pcqrses.query.interfaceAdapter.dao
+// このファイルは自動生成ファイルなので直接編集しないでください。
+import slick.lifted.PrimaryKey
+import slick.lifted.ProvenShape
+
+<#assign softDelete=false>
+trait ${className}Component extends SlickDaoSupport with ${className}Extensions {
+  import profile.api._
+
+  final case class ${className}Record(
+<#list primaryKeys as primaryKey>
+      ${primaryKey.propertyName}: ${primaryKey.propertyTypeName}<#if primaryKey_has_next>,</#if></#list><#if primaryKeys?has_content>,</#if>
+<#list columns as column>
+    <#if column.columnName == "status">
+        <#assign softDelete=true>
+    </#if>
+    <#if column.nullable>      ${column.propertyName}: Option[${column.propertyTypeName}]<#if column_has_next>,</#if>
+    <#else>      ${column.propertyName}: ${column.propertyTypeName}<#if column_has_next>,</#if>
+    </#if>
+</#list>
+  ) extends <#if softDelete == false>Record<#else>SoftDeletableRecord</#if>
+
+  final case class ${className}(tag: Tag) extends TableBase[${className}Record](tag, "${tableName}")<#if softDelete == true> with SoftDeletableTableSupport[${className}Record]</#if> {
+<#list primaryKeys as primaryKey>
+    def ${primaryKey.propertyName}: Rep[${primaryKey.propertyTypeName}] = column[${primaryKey.propertyTypeName}]("${primaryKey.columnName}")
+</#list>
+<#list columns as column>
+    <#if column.nullable>
+    def ${column.propertyName}: Rep[Option[${column.propertyTypeName}]] = column[Option[${column.propertyTypeName}]]("${column.columnName}")
+    <#else>
+    def ${column.propertyName}: Rep[${column.propertyTypeName}] = column[${column.propertyTypeName}]("${column.columnName}")
+    </#if>
+</#list>
+
+    def pk: PrimaryKey = primaryKey("pk", (<#list primaryKeys as primaryKey>${primaryKey.propertyName}<#if primaryKey_has_next>, </#if></#list>))
+
+    override def * : ProvenShape[${className}Record] = (<#list primaryKeys as primaryKey>${primaryKey.propertyName}<#if primaryKey_has_next>, </#if></#list><#if primaryKeys?has_content>, </#if><#list columns as column>${column.propertyName}<#if column_has_next>, </#if></#list>) <> (${className}Record.apply, ${className}Record.unapply)
+  }
+
+  object ${className}Dao extends TableQuery(${className}.apply) with ${className}DaoExtensions
+
+}
diff --git a/scripts/run-common.sh b/scripts/run-common.sh
index ed05547..1c2736d 100755
--- a/scripts/run-common.sh
+++ b/scripts/run-common.sh
@@ -194,7 +194,7 @@ deploy_lambda_if_enabled() {
             echo "⏳ Retry deploy in 3s... ($tries/$max_tries)"
             sleep 3
         done
-        
+
         # Lambda関数の状態確認
         echo ""
         echo "⏳ Waiting for Lambda to be fully registered..."
@@ -271,7 +271,7 @@ show_common_access_points() {
 # ========================================
 prepare_docker_environment() {
     local compose_files="$1"
-    
+
     # Dockerイメージのビルド
     echo "🏗️  Building Docker images..."
     sbt dockerBuildAll
@@ -286,7 +286,7 @@ prepare_docker_environment() {
 # ========================================
 post_startup_tasks() {
     local compose_files="$1"
-    
+
     echo ""
     echo "🎉 Services are running!"
 
@@ -296,4 +296,4 @@ post_startup_tasks() {
     echo ""
     echo "🛑 To stop: $0 down"
     echo ""
-}
\ No newline at end of file
+}
diff --git a/tools/pgadmin/servers.json b/tools/pgadmin/servers.json
index f5c986c..7ff7aa3 100644
--- a/tools/pgadmin/servers.json
+++ b/tools/pgadmin/servers.json
@@ -1,7 +1,7 @@
 {
   "Servers": {
     "1": {
-      "Name": "PCQRSES PostgreSQL",
+      "Name": "Pcqrses PostgreSQL",
       "Group": "Servers",
       "Host": "postgres",
       "Port": 5432,

```

## コミット: 0a142d9

### メッセージ

```
chore: Docker Compose設定の更新
- docker-compose-common.yml: 共通サービスの定義を更新
- docker-compose-local.yml: ローカル開発環境用の設定を調整
- docker-compose-cluster.yml: クラスター構成の設定を最適化
  - ヘルスチェックの改善
  - 環境変数の整理
  - ネットワーク設定の最適化
```

### 変更されたファイル

- M	docker-compose-cluster.yml
- M	docker-compose-common.yml
- M	docker-compose-local.yml

### 変更内容

```diff
commit 0a142d9b797ec0060762f48da0e340ab65eb4198
Author: Junichi Kato <j5ik2o@gmail.com>
Date:   Sat Sep 13 09:25:50 2025 +0900

    chore: Docker Compose設定の更新
    
    - docker-compose-common.yml: 共通サービスの定義を更新
    - docker-compose-local.yml: ローカル開発環境用の設定を調整
    - docker-compose-cluster.yml: クラスター構成の設定を最適化
      - ヘルスチェックの改善
      - 環境変数の整理
      - ネットワーク設定の最適化

diff --git a/docker-compose-cluster.yml b/docker-compose-cluster.yml
index c1530bc..4f7f830 100644
--- a/docker-compose-cluster.yml
+++ b/docker-compose-cluster.yml
@@ -20,9 +20,9 @@ x-cluster-env: &cluster-env
   COMMAND_API_HEALTH_CHECK_GRACE_PERIOD: "10s"
 
 x-command-api-base: &command-api-base
-  image: pcqrses-command-api:0.1.0
+  image: p-cqrs-es-command-api:0.1.0
   networks:
-    - pcqrses-network
+    - p-cqrs-es-network
   environment:
     <<: [*dynamodb-env, *cluster-env]
   depends_on:
diff --git a/docker-compose-common.yml b/docker-compose-common.yml
index 29f67e4..418e2dd 100644
--- a/docker-compose-common.yml
+++ b/docker-compose-common.yml
@@ -27,7 +27,7 @@ services:
       - AWS_DEFAULT_REGION=ap-northeast-1
       - AWS_ACCESS_KEY_ID=dummy
       - AWS_SECRET_ACCESS_KEY=dummy
-      - LAMBDA_DOCKER_NETWORK=pcqrses_back_pcqrses-network
+      - LAMBDA_DOCKER_NETWORK=p-cqrs-es_back_p-cqrs-es-network
       - AWS_ENDPOINT_URL=http://localstack:4566
       - LOCALSTACK_HOST=localstack
       - HOSTNAME_FROM_LAMBDA=localstack
@@ -42,7 +42,7 @@ services:
     volumes:
       - "/var/run/docker.sock:/var/run/docker.sock"
     networks:
-      - pcqrses-network
+      - p-cqrs-es-network
     restart: unless-stopped
     healthcheck:
       test: ["CMD-SHELL", "python -c \"import socket,sys; s=socket.socket(); s.settimeout(2); s.connect(('localhost',4566)); sys.exit(0)\""]
@@ -56,7 +56,7 @@ services:
     build:
       context: ./tools/dynamodb-setup
     networks:
-      - pcqrses-network
+      - p-cqrs-es-network
     environment:
       AWS_ACCESS_KEY_ID: dummy
       AWS_SECRET_ACCESS_KEY: dummy
@@ -73,7 +73,7 @@ services:
     ports:
       - "${DOCKER_DYNAMODB_ADMIN_PORT:-50505}:8001"
     networks:
-      - pcqrses-network
+      - p-cqrs-es-network
     environment:
       DYNAMO_ENDPOINT: http://localstack:4566
       AWS_REGION: ap-northeast-1
@@ -89,16 +89,16 @@ services:
     environment:
       POSTGRES_USER: postgres
       POSTGRES_PASSWORD: postgres
-      POSTGRES_DB: pcqrses_development
+      POSTGRES_DB: p-cqrs-es_development
       # Simplify local dev: allow trust auth (no password prompt)
       POSTGRES_HOST_AUTH_METHOD: trust
     ports:
       - "${DOCKER_POSTGRES_PORT:-50504}:5432"
     restart: unless-stopped
     networks:
-      pcqrses-network:
+      p-cqrs-es-network:
         aliases:
-          - pcqrses_postgres
+          - p-cqrs-es_postgres
     healthcheck:
       test: ["CMD-SHELL", "pg_isready -U postgres"]
       interval: 10s
@@ -122,7 +122,7 @@ services:
     depends_on:
       - postgres
     networks:
-      - pcqrses-network
+      - p-cqrs-es-network
     restart: unless-stopped
     entrypoint:
       - "/bin/sh"
@@ -140,7 +140,7 @@ services:
     image: flyway/flyway:10
     command: migrate
     environment:
-      - FLYWAY_URL=jdbc:postgresql://postgres:5432/pcqrses_development
+      - FLYWAY_URL=jdbc:postgresql://postgres:5432/p-cqrs-es_development
       - FLYWAY_USER=postgres
       - FLYWAY_PASSWORD=postgres
       - FLYWAY_CONNECT_RETRIES=60
@@ -153,29 +153,29 @@ services:
       postgres:
         condition: service_healthy
     networks:
-      - pcqrses-network
+      - p-cqrs-es-network
 
   # Query API (Read側API) - 単一ノード
   query-api:
-    image: pcqrses-query-api:0.1.0
+    image: p-cqrs-es-query-api:0.1.0
     ports:
       - "${DOCKER_QUERY_API_PORT:-50502}:18082"
     depends_on:
       flyway:
         condition: service_completed_successfully
     networks:
-      - pcqrses-network
+      - p-cqrs-es-network
     environment:
       # サーバー設定
       QUERY_API_SERVER_HOST: 0.0.0.0
       QUERY_API_SERVER_PORT: 18082
       # データベース設定
-      DATABASE_URL: jdbc:postgresql://postgres:5432/pcqrses_development
+      DATABASE_URL: jdbc:postgresql://postgres:5432/p-cqrs-es_development
       DATABASE_USER: postgres
       DATABASE_PASSWORD: postgres
       # GraphQL設定
       GRAPHIQL_ENABLED: "true"  # 開発環境でGraphiQLを有効化
 
 networks:
-  pcqrses-network:
+  p-cqrs-es-network:
     driver: bridge
diff --git a/docker-compose-local.yml b/docker-compose-local.yml
index 86fc4a8..5c08a9f 100644
--- a/docker-compose-local.yml
+++ b/docker-compose-local.yml
@@ -2,14 +2,14 @@
 services:
   # Command API - 単一ノード（ローカル開発用）
   command-api-1:
-    image: pcqrses-command-api:0.1.0
+    image: p-cqrs-es-command-api:0.1.0
     ports:
       - "${DOCKER_COMMAND_API_PORT:-50501}:18080"
     depends_on:
       dynamodb-setup:
         condition: service_completed_successfully
     networks:
-      - pcqrses-network
+      - p-cqrs-es-network
     environment:
       # DynamoDB設定
       J5IK2O_DYNAMO_DB_JOURNAL_DYNAMO_DB_CLIENT_ENDPOINT: http://localstack:4566

```

## コミット: 1c3c322

### メッセージ

```
refactor: ドメイン層とインターフェースアダプター層のリファクタリング
ドメイン層の変更:
- EmailAddressにDomainError継承を追加
- UserAccountNameの実装を追加
- 各種エラータイプの定義を更新

インターフェースアダプター層の変更:
- UserAccountProtocolの更新
- UserAccountAggregateの実装変更
- Protobufスキーマの定義更新

Lambda関数の変更:
- LambdaHandlerの基本実装を更新
- レスポンス型の定義を追加
```

### 変更されたファイル

- M	apps/read-model-updater/src/main/scala/io/github/j5ik2o/pcqrses/readModelUpdater/LambdaHandler.scala
- M	apps/read-model-updater/src/main/scala/io/github/j5ik2o/pcqrses/readModelUpdater/LambdaResponse.scala
- M	apps/read-model-updater/src/main/scala/io/github/j5ik2o/pcqrses/readModelUpdater/ResponseBody.scala
- M	modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/basic/DateTime.scala
- M	modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/basic/DateTimeError.scala
- M	modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/DomainError.scala
- M	modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/DomainEvent.scala
- M	modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/DomainEventId.scala
- M	modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/Entity.scala
- M	modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/EntityId.scala
- M	modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/DeleteError.scala
- M	modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/EmailAddress.scala
- M	modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/EmailAddressError.scala
- M	modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/FirstName.scala
- M	modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/FirstNameError.scala
- M	modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/LastName.scala
- M	modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/LastNameError.scala
- M	modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/RenameError.scala
- M	modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccount.scala
- M	modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccountEvent.scala
- M	modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccountId.scala
- M	modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccountIdError.scala
- M	modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccountName.scala
- M	modules/command/interface-adapter-contract/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/contract/users/UserAccountProtocol.scala
- M	modules/command/interface-adapter/src/main/protobuf/users/basic.proto
- M	modules/command/interface-adapter/src/main/protobuf/users/snapshot.proto
- M	modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountAggregate.scala
- M	modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountAggregateState.scala
- M	modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountSnapshotSerializer.scala

### 変更内容

```diff
commit 1c3c322d8e0741755ba63d13774a1c5ef5139342
Author: Junichi Kato <j5ik2o@gmail.com>
Date:   Sat Sep 13 09:25:01 2025 +0900

    refactor: ドメイン層とインターフェースアダプター層のリファクタリング
    
    ドメイン層の変更:
    - EmailAddressにDomainError継承を追加
    - UserAccountNameの実装を追加
    - 各種エラータイプの定義を更新
    
    インターフェースアダプター層の変更:
    - UserAccountProtocolの更新
    - UserAccountAggregateの実装変更
    - Protobufスキーマの定義更新
    
    Lambda関数の変更:
    - LambdaHandlerの基本実装を更新
    - レスポンス型の定義を追加

diff --git a/apps/read-model-updater/src/main/scala/io/github/j5ik2o/pcqrses/readModelUpdater/LambdaHandler.scala b/apps/read-model-updater/src/main/scala/io/github/j5ik2o/pcqrses/readModelUpdater/LambdaHandler.scala
index 565a580..a13cc8a 100644
--- a/apps/read-model-updater/src/main/scala/io/github/j5ik2o/pcqrses/readModelUpdater/LambdaHandler.scala
+++ b/apps/read-model-updater/src/main/scala/io/github/j5ik2o/pcqrses/readModelUpdater/LambdaHandler.scala
@@ -1,5 +1,35 @@
 package io.github.j5ik2o.pcqrses.readModelUpdater
 
-class LambdaHandler {
+import com.amazonaws.services.lambda.runtime.{Context, RequestHandler}
+import com.amazonaws.services.lambda.runtime.events.DynamodbEvent
+import com.fasterxml.jackson.databind.ObjectMapper
+import com.fasterxml.jackson.module.scala.DefaultScalaModule
+import com.typesafe.config.ConfigFactory
+import org.apache.pekko.actor.ActorSystem
+import org.apache.pekko.serialization.SerializationExtension
+import org.slf4j.LoggerFactory
+import slick.basic.DatabaseConfig
+import slick.jdbc.JdbcProfile
 
+import scala.concurrent.duration.DurationLong
+
+class LambdaHandler extends RequestHandler[DynamodbEvent, LambdaResponse] {
+  LoggerFactory.getLogger(getClass)
+
+  private val objectMapper = new ObjectMapper()
+  objectMapper.registerModule(DefaultScalaModule)
+
+  private val config = ConfigFactory.load()
+  private lazy val system = ActorSystem("read-model-updater", config)
+  SerializationExtension(system)
+
+  config.getDuration("read-model-updater.timeouts.database-operation").getSeconds.seconds
+
+  config.getDuration("read-model-updater.timeouts.system-termination").getSeconds.seconds
+  private val databaseConfig: DatabaseConfig[JdbcProfile] =
+    DatabaseConfig.forConfig[JdbcProfile]("read-model-updater.slick", config)
+  databaseConfig.db
+  val profile: slick.jdbc.JdbcProfile = databaseConfig.profile
+
+  override def handleRequest(input: DynamodbEvent, context: Context): LambdaResponse = ???
 }
diff --git a/apps/read-model-updater/src/main/scala/io/github/j5ik2o/pcqrses/readModelUpdater/LambdaResponse.scala b/apps/read-model-updater/src/main/scala/io/github/j5ik2o/pcqrses/readModelUpdater/LambdaResponse.scala
index 5e70bb2..92f91c0 100644
--- a/apps/read-model-updater/src/main/scala/io/github/j5ik2o/pcqrses/readModelUpdater/LambdaResponse.scala
+++ b/apps/read-model-updater/src/main/scala/io/github/j5ik2o/pcqrses/readModelUpdater/LambdaResponse.scala
@@ -1,3 +1,3 @@
 package io.github.j5ik2o.pcqrses.readModelUpdater
 
-case class LambdaResponse(statusCode: Int, body: String)
+final case class LambdaResponse(statusCode: Int, body: String)
diff --git a/apps/read-model-updater/src/main/scala/io/github/j5ik2o/pcqrses/readModelUpdater/ResponseBody.scala b/apps/read-model-updater/src/main/scala/io/github/j5ik2o/pcqrses/readModelUpdater/ResponseBody.scala
index 4d376f4..a157aeb 100644
--- a/apps/read-model-updater/src/main/scala/io/github/j5ik2o/pcqrses/readModelUpdater/ResponseBody.scala
+++ b/apps/read-model-updater/src/main/scala/io/github/j5ik2o/pcqrses/readModelUpdater/ResponseBody.scala
@@ -1,3 +1,3 @@
 package io.github.j5ik2o.pcqrses.readModelUpdater
 
-case class ResponseBody(message: String, error: Option[String] = None)
+final case class ResponseBody(message: String, error: Option[String] = None)
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/basic/DateTime.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/basic/DateTime.scala
index 66bd140..18f7a7a 100644
--- a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/basic/DateTime.scala
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/basic/DateTime.scala
@@ -1,11 +1,19 @@
-package io.github.j5ik2o.pcqrses.domain.users
+package io.github.j5ik2o.pcqrses.domain.basic
 
+import java.time.format.DateTimeParseException
 import java.time.{Instant, LocalDateTime, ZoneId, ZonedDateTime}
 
 trait DateTime {
   def asLocalDateTime: LocalDateTime
-  def asZonedDateTime(zoneId: ZoneId = ZoneId.systemDefault()): ZonedDateTime = asLocalDateTime.atZone(zoneId)
-  def asInstant(zoneId: ZoneId = ZoneId.systemDefault()): Instant = asZonedDateTime(zoneId).toInstant
+  def asZonedDateTime(zoneId: ZoneId = ZoneId.systemDefault()): ZonedDateTime =
+    asLocalDateTime.atZone(zoneId)
+  def asInstant(zoneId: ZoneId = ZoneId.systemDefault()): Instant = asZonedDateTime(
+    zoneId).toInstant
+  def toEpochMilli(zoneId: ZoneId = ZoneId.systemDefault()): Long = asInstant(zoneId).toEpochMilli
+  def toSecondsAndNanos: (Long, Int) = {
+    val instant = asInstant()
+    (instant.getEpochSecond, instant.getNano)
+  }
 }
 
 object DateTime {
@@ -14,6 +22,24 @@ object DateTime {
 
   def now(): DateTime = DateTimeImpl(LocalDateTime.now())
 
+  def from(value: String): DateTime = parseFromString(value) match {
+    case Right(v) => v
+    case Left(e) => throw new IllegalArgumentException(e.message)
+  }
+
+  def from(value: Instant, zoneId: ZoneId = ZoneId.systemDefault()): DateTime =
+    apply(LocalDateTime.ofInstant(value, zoneId))
+  def from(value: ZonedDateTime): DateTime = apply(value.toLocalDateTime)
+  def fromSecondsAndNanos(seconds: Long, nanos: Int, zoneId: ZoneId = ZoneId.systemDefault()): DateTime =
+    apply(LocalDateTime.ofInstant(Instant.ofEpochSecond(seconds, nanos.toLong), zoneId))
+
+  def parseFromString(value: String): Either[DateTimeError, DateTime] =
+    try {
+      Right(DateTimeImpl(LocalDateTime.parse(value)))
+    } catch {
+      case e: DateTimeParseException => Left(DateTimeError.InvalidFormat(e.getMessage))
+    }
+
   private case class DateTimeImpl(value: LocalDateTime) extends DateTime {
     override def asLocalDateTime: LocalDateTime = value
   }
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/basic/DateTimeError.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/basic/DateTimeError.scala
index 0fed815..b6f32b8 100644
--- a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/basic/DateTimeError.scala
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/basic/DateTimeError.scala
@@ -1,5 +1,13 @@
 package io.github.j5ik2o.pcqrses.domain.basic
 
-enum DateTimeError {
+import io.github.j5ik2o.pcqrses.domain.support.DomainError
 
+enum DateTimeError extends DomainError {
+  case InvalidFormat(value: String)
+
+  override def message: String = {
+    this match {
+      case InvalidFormat(value) => s"Invalid date time format: $value"
+    }
+  }
 }
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/DomainError.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/DomainError.scala
index dd7c943..1b44355 100644
--- a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/DomainError.scala
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/DomainError.scala
@@ -1,5 +1,17 @@
 package io.github.j5ik2o.pcqrses.domain.support
 
+/**
+ * ドメインエラーの共通インターフェース
+ *
+ * すべてのドメインエラーが実装すべきトレイト。 エラーメッセージの統一的な取得方法を提供し、 エラーハンドリングの型安全性を向上させる。
+ */
 trait DomainError {
 
+  /**
+   * エラーメッセージを取得する
+   *
+   * @return
+   *   人間が読めるエラーメッセージ
+   */
+  def message: String
 }
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/DomainEvent.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/DomainEvent.scala
index cc7c9e5..79f19a1 100644
--- a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/DomainEvent.scala
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/DomainEvent.scala
@@ -1,10 +1,10 @@
 package io.github.j5ik2o.pcqrses.domain.support
 
-import java.time.Instant
+import io.github.j5ik2o.pcqrses.domain.basic.DateTime
 
-trait AggregateEvent {
-  type AggregateIdType <: AggregateId
-  def id: AggregateEventId
-  def aggregateId: AggregateIdType
-  def occurredAt: Instant
+trait DomainEvent {
+  type EntityIdType <: EntityId
+  def id: DomainEventId
+  def entityId: EntityIdType
+  def occurredAt: DateTime
 }
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/DomainEventId.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/DomainEventId.scala
index 6377100..2d27a2f 100644
--- a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/DomainEventId.scala
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/DomainEventId.scala
@@ -2,25 +2,25 @@ package io.github.j5ik2o.pcqrses.domain.support
 
 import wvlet.airframe.ulid.ULID
 
-trait AggregateEventId {
+trait DomainEventId {
   def asString: String
 }
 
-object AggregateEventId {
-  def apply(value: ULID): AggregateEventId = AggregateEventIdImpl(value)
+object DomainEventId {
+  def apply(value: ULID): DomainEventId = AggregateEventIdImpl(value)
 
-  def from(value: String): AggregateEventId = AggregateEventIdImpl(ULID.fromString(value))
+  def from(value: String): DomainEventId = AggregateEventIdImpl(ULID.fromString(value))
 
-  def generate(): AggregateEventId = AggregateEventIdImpl(ULID.newULID)
+  def generate(): DomainEventId = AggregateEventIdImpl(ULID.newULID)
 
-  def parse(value: String): Either[Exception, AggregateEventId] =
+  def parse(value: String): Either[Exception, DomainEventId] =
     try
       Right(from(value))
     catch {
       case e: IllegalArgumentException => Left(e)
     }
 
-  private final case class AggregateEventIdImpl(ulid: ULID) extends AggregateEventId {
+  private final case class AggregateEventIdImpl(ulid: ULID) extends DomainEventId {
     override def asString: String = ulid.toString
   }
 
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/Entity.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/Entity.scala
index 77dee5f..c8a32ba 100644
--- a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/Entity.scala
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/Entity.scala
@@ -1,6 +1,6 @@
 package io.github.j5ik2o.pcqrses.domain.support
 
-trait AggregateRoot {
-  type IdType <: AggregateId
+trait Entity {
+  type IdType <: EntityId
   def id: IdType
 }
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/EntityId.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/EntityId.scala
index c90a520..1f1270e 100644
--- a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/EntityId.scala
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/EntityId.scala
@@ -1,6 +1,6 @@
 package io.github.j5ik2o.pcqrses.domain.support
 
-trait AggregateId {
-  def aggregateTypeName: String
+trait EntityId {
+  def entityTypeName: String
   def asString: String
 }
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/DeleteError.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/DeleteError.scala
index a5a8fb8..2a9f92f 100644
--- a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/DeleteError.scala
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/DeleteError.scala
@@ -1,5 +1,12 @@
 package io.github.j5ik2o.pcqrses.domain.users
 
-class DeleteError {
+import io.github.j5ik2o.pcqrses.domain.support.DomainError
 
+enum DeleteError extends DomainError{
+
+  case AlreadyDeleted
+
+  override def message: String = this match {
+    case AlreadyDeleted => "The user has already been deleted"
+  }
 }
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/EmailAddress.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/EmailAddress.scala
index 38e6637..542ceb5 100644
--- a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/EmailAddress.scala
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/EmailAddress.scala
@@ -1,35 +1,14 @@
-package io.github.j5ik2o.pcqrses.domain.staff
+package io.github.j5ik2o.pcqrses.domain.users
 
-/**
- * メールアドレスを表現するValue Object。
- *
- * スタッフへの主要な連絡手段として機能し、 システム通知やパスワードリセット等の重要なプロセスで使用される。 RFC5322準拠のバリデーションにより有効性を保証する。
- */
 trait EmailAddress {
 
-  /** 文字列表現として取得する。メール送信やUI表示で使用 */
   def asString: String
 }
 
-/**
- * EmailAddressのファクトリーオブジェクト。
- *
- * RFC5322準拠のバリデーション機能により、 有効なメールアドレスのみを生成することを保証する。
- */
 object EmailAddress {
 
-  private[staff] final val MaxLength = 100
+  private[users] final val MaxLength = 100
 
-  /**
-   * 文字列からEmailAddressを作成する。
-   *
-   * @param value
-   *   メールアドレスの文字列
-   * @return
-   *   作成されたEmailAddressインスタンス
-   * @throws IllegalArgumentException
-   *   バリデーション失敗時
-   */
   def apply(value: String): EmailAddress =
     parseFromString(value) match {
       case Right(result) => result
@@ -40,16 +19,6 @@ object EmailAddress {
 
   private final val EmailRegex = "^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$".r
 
-  /**
-   * バリデーション付きでEmailAddressをパースする。
-   *
-   * 外部入力値の検証が必要な場面で使用し、 型安全なエラーハンドリングを提供する。
-   *
-   * @param value
-   *   パース対象の文字列
-   * @return
-   *   パース結果。成功時はEmailAddress、失敗時はEmailAddressError
-   */
   def parseFromString(value: String): Either[EmailAddressError, EmailAddress] =
     if (value.isEmpty) {
       Left(EmailAddressError.Empty)
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/EmailAddressError.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/EmailAddressError.scala
index d6384ab..daf4271 100644
--- a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/EmailAddressError.scala
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/EmailAddressError.scala
@@ -1,16 +1,13 @@
-package io.github.j5ik2o.pcqrses.domain.staff
+package io.github.j5ik2o.pcqrses.domain.users
+
+import io.github.j5ik2o.pcqrses.domain.support.DomainError
 
-/**
- * EmailAddress生成時のバリデーションエラー。
- *
- * メールアドレスの形式エラーを型安全に表現し、 不正なアドレスによるシステムエラーを防止する。
- */
 enum EmailAddressError extends DomainError {
   case Empty
   case TooLong(actualLength: Int)
   case InvalidFormat
 
-  def message: String = this match {
+  override def message: String = this match {
     case Empty => "Email address cannot be empty"
     case TooLong(actualLength) =>
       s"Email address is too long: $actualLength characters (max ${EmailAddress.MaxLength} characters)"
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/FirstName.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/FirstName.scala
index 671b600..a03893d 100644
--- a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/FirstName.scala
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/FirstName.scala
@@ -1,5 +1,20 @@
 package io.github.j5ik2o.pcqrses.domain.users
 
-class FirstName {
+trait FirstName {
+  def asString: String
+}
+
+object FirstName {
+  def apply(value: String): FirstName = parseFromString(value) match {
+    case Right(v) => v
+    case Left(e) => throw new IllegalArgumentException(e.message)
+  }
+
+  def parseFromString(value: String): Either[FirstNameError, FirstName] =
+    if (value.length > 256) Left(FirstNameError.TooLong)
+    else Right(FirstNameImpl(value))
 
+  private case class FirstNameImpl(value: String) extends FirstName {
+    override def asString: String = value
+  }
 }
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/FirstNameError.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/FirstNameError.scala
index 08e9c3a..2514fb4 100644
--- a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/FirstNameError.scala
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/FirstNameError.scala
@@ -1,5 +1,12 @@
 package io.github.j5ik2o.pcqrses.domain.users
 
-class FirstNameError {
+import io.github.j5ik2o.pcqrses.domain.support.DomainError
 
+enum FirstNameError extends DomainError {
+  case TooLong
+
+  override def message: String =
+    this match {
+      case TooLong => "First name is too long"
+    }
 }
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/LastName.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/LastName.scala
index becc7df..0ed7f61 100644
--- a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/LastName.scala
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/LastName.scala
@@ -1,5 +1,20 @@
 package io.github.j5ik2o.pcqrses.domain.users
 
 trait LastName {
+  def asString: String
+}
+
+object LastName {
+  def apply(value: String): LastName = parseFromString(value) match {
+    case Right(v) => v
+    case Left(e) => throw new IllegalArgumentException(e.message)
+  }
+
+  def parseFromString(value: String): Either[LastNameError, LastName] =
+    if (value.length > 256) Left(LastNameError.TooLong)
+    else Right(LastNameImpl(value))
 
+  private case class LastNameImpl(value: String) extends LastName {
+    override def asString: String = value
+  }
 }
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/LastNameError.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/LastNameError.scala
index da9d26b..eac9d93 100644
--- a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/LastNameError.scala
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/LastNameError.scala
@@ -1,5 +1,12 @@
 package io.github.j5ik2o.pcqrses.domain.users
 
-class LastNameError {
+import io.github.j5ik2o.pcqrses.domain.support.DomainError
 
+enum LastNameError extends DomainError {
+  case TooLong
+
+  override def message: String =
+    this match {
+      case TooLong => "Last name is too long"
+    }
 }
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/RenameError.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/RenameError.scala
index a2bbd26..47b141d 100644
--- a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/RenameError.scala
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/RenameError.scala
@@ -1,5 +1,5 @@
 package io.github.j5ik2o.pcqrses.domain.users
 
-class RenameError {
-
+enum RenameError {
+  case FamilyNameSame
 }
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccount.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccount.scala
index 1d398c2..d5e701d 100644
--- a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccount.scala
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccount.scala
@@ -1,5 +1,77 @@
 package io.github.j5ik2o.pcqrses.domain.users
 
-class UserAccount {
+import io.github.j5ik2o.pcqrses.domain.basic.DateTime
+import io.github.j5ik2o.pcqrses.domain.support.{DomainEventId, Entity}
 
+trait UserAccount extends Entity {
+  override type IdType = UserAccountId
+  def id: UserAccountId
+  def name: UserAccountName
+  def emailAddress: EmailAddress
+  def createdAt: DateTime
+  def updatedAt: DateTime
+
+  def rename(newName: UserAccountName): Either[RenameError, (UserAccount, UserAccountEvent)]
+  def delete: Either[DeleteError, (UserAccount, UserAccountEvent)]
+}
+
+object UserAccount {
+  def apply(
+    id: UserAccountId,
+    name: UserAccountName,
+    emailAddress: EmailAddress,
+    createdAt: DateTime = DateTime.now(),
+    updatedAt: DateTime = DateTime.now()
+  ): (UserAccount, UserAccountEvent) =
+    (
+      UserAccountImpl(id, false, name, emailAddress, createdAt, updatedAt),
+      UserAccountEvent.Created(
+        id = DomainEventId.generate(),
+        entityId = id,
+        name = name,
+        emailAddress = emailAddress,
+        occurredAt = DateTime.now()
+      ))
+  def unapply(
+    self: UserAccount): Option[(UserAccountId, UserAccountName, EmailAddress, DateTime, DateTime)] =
+    Some((self.id, self.name, self.emailAddress, self.createdAt, self.updatedAt))
+
+  private final case class UserAccountImpl(
+    id: UserAccountId,
+    deleted: Boolean,
+    name: UserAccountName,
+    emailAddress: EmailAddress,
+    createdAt: DateTime,
+    updatedAt: DateTime
+  ) extends UserAccount {
+    override def rename(
+      newName: UserAccountName): Either[RenameError, (UserAccount, UserAccountEvent)] =
+      if (name == newName) {
+        Left(RenameError.FamilyNameSame)
+      } else {
+        val updated = this.copy(name = newName, updatedAt = DateTime.now())
+        val event = UserAccountEvent.Renamed(
+          id = DomainEventId.generate(),
+          entityId = id,
+          oldName = name,
+          newName = newName,
+          occurredAt = DateTime.now()
+        )
+        Right((updated, event))
+      }
+
+    override def delete: Either[DeleteError, (UserAccount, UserAccountEvent)] = {
+      if (deleted) {
+        Left(DeleteError.AlreadyDeleted)
+      } else {
+        val updated = copy(deleted = true, updatedAt = DateTime.now())
+        val event = UserAccountEvent.Deleted(
+          id = DomainEventId.generate(),
+          entityId = id,
+          occurredAt = DateTime.now()
+        )
+        Right((updated, event))
+      }
+    }
+  }
 }
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccountEvent.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccountEvent.scala
index acae138..6335733 100644
--- a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccountEvent.scala
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccountEvent.scala
@@ -1,5 +1,27 @@
 package io.github.j5ik2o.pcqrses.domain.users
 
-class UserAccountEvent {
+import io.github.j5ik2o.pcqrses.domain.basic.DateTime
+import io.github.j5ik2o.pcqrses.domain.support.{DomainEvent, DomainEventId}
 
+enum UserAccountEvent extends DomainEvent {
+  override type EntityIdType = UserAccountId
+  case Created(
+    id: DomainEventId,
+    entityId: UserAccountId,
+    name: UserAccountName,
+    emailAddress: EmailAddress,
+    occurredAt: DateTime
+  )
+  case Renamed(
+    id: DomainEventId,
+    entityId: UserAccountId,
+    oldName: UserAccountName,
+    newName: UserAccountName,
+    occurredAt: DateTime
+  )
+  case Deleted(
+    id: DomainEventId,
+    entityId: UserAccountId,
+    occurredAt: DateTime
+  )
 }
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccountId.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccountId.scala
index b2c35d7..d000bdb 100644
--- a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccountId.scala
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccountId.scala
@@ -1,5 +1,38 @@
 package io.github.j5ik2o.pcqrses.domain.users
 
-class UserAccountId {
+import io.github.j5ik2o.pcqrses.domain.support.EntityId
+import wvlet.airframe.ulid.{CrockfordBase32, ULID}
 
+trait UserAccountId extends EntityId {
+  def entityTypeName: String
+  def asString: String
+}
+
+object UserAccountId {
+  def apply(value: ULID): UserAccountId = UserAccountIdImpl(value)
+
+  def unapply(self: UserAccountId): Option[String] = Some(self.asString)
+
+  def from(value: String): UserAccountId = parseFromString(value) match {
+    case Right(v) => v
+    case Left(e) => throw new IllegalArgumentException(e.message)
+  }
+
+  def generate(): UserAccountId = UserAccountIdImpl(ULID.newULID)
+
+  def parseFromString(value: String): Either[UserAccountIdError, UserAccountId] =
+    if (value.isEmpty) {
+      Left(UserAccountIdError.Empty)
+    } else if (value.length != 26) {
+      Left(UserAccountIdError.InvalidLength)
+    } else if (!CrockfordBase32.isValidBase32(value)) {
+      Left(UserAccountIdError.InvalidFormat)
+    } else {
+      Right(from(value))
+    }
+
+  private case class UserAccountIdImpl(ulid: ULID) extends UserAccountId {
+    override def entityTypeName: String = "UserAccount"
+    override def asString: String = ulid.toString
+  }
 }
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccountIdError.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccountIdError.scala
index b8c8252..5076d2a 100644
--- a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccountIdError.scala
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccountIdError.scala
@@ -1,5 +1,15 @@
 package io.github.j5ik2o.pcqrses.domain.users
 
-class UserAccountIdError {
+import io.github.j5ik2o.pcqrses.domain.support.DomainError
 
+enum UserAccountIdError extends DomainError {
+  case Empty
+  case InvalidLength
+  case InvalidFormat
+
+  override def message: String = this match {
+    case Empty => "Staff ID cannot be empty"
+    case InvalidLength => "Staff ID must be exactly 26 characters"
+    case InvalidFormat => "Invalid Staff ID format"
+  }
 }
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccountName.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccountName.scala
index cfb4911..9ffe878 100644
--- a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccountName.scala
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccountName.scala
@@ -1,5 +1,21 @@
 package io.github.j5ik2o.pcqrses.domain.users
 
-class UserAccountName {
+trait UserAccountName {
+  def breachEncapsulationOfFirstName: FirstName
+  def breachEncapsulationOfLastName: LastName
+  def asString: String
+}
+
+object UserAccountName {
+  def apply(firstName: FirstName, lastName: LastName): UserAccountName =
+    UserAccountNameImpl(firstName, lastName)
+  def unapply(self: UserAccountName): Option[(FirstName, LastName)] =
+    Some((self.breachEncapsulationOfFirstName, self.breachEncapsulationOfLastName))
 
+  private final case class UserAccountNameImpl(firstName: FirstName, lastName: LastName)
+    extends UserAccountName {
+    override def breachEncapsulationOfFirstName: FirstName = firstName
+    override def breachEncapsulationOfLastName: LastName = lastName
+    override def asString: String = s"${firstName.asString} ${lastName.asString}"
+  }
 }
diff --git a/modules/command/interface-adapter-contract/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/contract/users/UserAccountProtocol.scala b/modules/command/interface-adapter-contract/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/contract/users/UserAccountProtocol.scala
index 129d049..381566a 100644
--- a/modules/command/interface-adapter-contract/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/contract/users/UserAccountProtocol.scala
+++ b/modules/command/interface-adapter-contract/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/contract/users/UserAccountProtocol.scala
@@ -1,5 +1,27 @@
 package io.github.j5ik2o.pcqrses.interfaceAdapter.contract.users
 
-object UserAccountProcotol {
+import io.github.j5ik2o.pcqrses.domain.users.{DeleteError, EmailAddress, RenameError, UserAccount, UserAccountId, UserAccountName}
+import org.apache.pekko.actor.typed.ActorRef
 
+object UserAccountProtocol {
+  sealed trait Command
+  final case class Create(id: UserAccountId, name: UserAccountName, emailAddress: EmailAddress, replyTo: ActorRef[CreateReply]) extends Command
+  final case class Rename(id: UserAccountId, newName: UserAccountName, replyTo: ActorRef[RenameReply]) extends Command
+  final case class Delete(id: UserAccountId, replyTo: ActorRef[DeleteReply]) extends Command
+  final case class Get(id: UserAccountId, replyTo: ActorRef[GetReply]) extends Command
+
+  sealed trait CreateReply
+  final case class CreateSucceeded(id: UserAccountId) extends CreateReply
+
+  sealed trait RenameReply
+  final case class RenameSucceeded(id: UserAccountId) extends RenameReply
+  final case class RenameFailed(id: UserAccountId, reason: RenameError) extends RenameReply
+
+  sealed trait DeleteReply
+  final case class DeleteSucceeded(id: UserAccountId) extends DeleteReply
+  final case class DeleteFailed(id: UserAccountId, reason: DeleteError) extends DeleteReply
+
+  sealed trait GetReply
+  final case class GetSucceeded(value: UserAccount) extends GetReply
+  final case class GetNotFoundFailed(id: UserAccountId) extends GetReply
 }
diff --git a/modules/command/interface-adapter/src/main/protobuf/users/basic.proto b/modules/command/interface-adapter/src/main/protobuf/users/basic.proto
index e69de29..60cecdb 100644
--- a/modules/command/interface-adapter/src/main/protobuf/users/basic.proto
+++ b/modules/command/interface-adapter/src/main/protobuf/users/basic.proto
@@ -0,0 +1,8 @@
+syntax = "proto3";
+
+package io.github.j5ik2o.pcqrses.command.interfaceAdapter.persistence.users;
+
+message UserAccountName {
+  string first_name = 1;
+  string last_name = 2;
+}
diff --git a/modules/command/interface-adapter/src/main/protobuf/users/snapshot.proto b/modules/command/interface-adapter/src/main/protobuf/users/snapshot.proto
index e69de29..0e4b7da 100644
--- a/modules/command/interface-adapter/src/main/protobuf/users/snapshot.proto
+++ b/modules/command/interface-adapter/src/main/protobuf/users/snapshot.proto
@@ -0,0 +1,33 @@
+syntax = "proto3";
+
+// Brought in from scalapb-runtime
+import "google/protobuf/timestamp.proto";
+import "users/basic.proto";
+
+package io.github.j5ik2o.pcqrses.command.interfaceAdapter.persistence.users;
+
+message UserAccountSnapshot {
+  oneof state {
+    UserAccount_NotCreatedSnapshot not_created = 1;
+    UserAccount_CreatedSnapshot created = 2;
+    UserAccount_DeletedSnapshot deleted = 3;
+  }
+}
+
+message UserAccount_NotCreatedSnapshot {
+  string user_account_id = 1;
+}
+
+message UserAccount_CreatedSnapshot {
+  string user_account_id = 1;
+  UserAccountName user_name = 2;
+  string email_address = 3;
+  google.protobuf.Timestamp created_at = 4;
+  google.protobuf.Timestamp updated_at = 5;
+}
+
+message UserAccount_DeletedSnapshot {
+  string user_account_id = 1;
+  google.protobuf.Timestamp created_at = 4;
+  google.protobuf.Timestamp updated_at = 5;
+}
diff --git a/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountAggregate.scala b/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountAggregate.scala
index 8d0b2ed..3a02d6d 100644
--- a/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountAggregate.scala
+++ b/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountAggregate.scala
@@ -1,5 +1,102 @@
 package io.github.j5ik2o.pcqrses.interfaceAdapter.users
 
-class UserAccountAggregate {
+import com.github.j5ik2o.pekko.persistence.effector.scaladsl.{
+  PersistenceEffector,
+  PersistenceEffectorConfig,
+  PersistenceMode,
+  RetentionCriteria,
+  SnapshotCriteria
+}
+import io.github.j5ik2o.pcqrses.domain.users.{UserAccount, UserAccountEvent, UserAccountId}
+import io.github.j5ik2o.pcqrses.interfaceAdapter.contract.users.UserAccountProtocol.*
+import org.apache.pekko.actor.typed.{Behavior, SupervisorStrategy}
+import org.apache.pekko.actor.typed.scaladsl.Behaviors
+import org.apache.pekko.persistence.typed.PersistenceId
+
+object UserAccountAggregate {
+
+  private def handleNotCreated(
+    state: UserAccountAggregateState.NotCreated,
+    effector: PersistenceEffector[UserAccountAggregateState, UserAccountEvent, Command])
+    : Behavior[Command] = Behaviors.receiveMessagePartial {
+    case Create(id, name, emailAddress, replyTo) if state.id == id =>
+      val (newState, event) = UserAccount(id, name, emailAddress)
+      effector
+        .persistEvent(event) { _ =>
+          replyTo ! CreateSucceeded(id)
+          handleCreated(UserAccountAggregateState.Created(newState), effector)
+        }
+    case Get(id, replyTo) if state.id == id =>
+      replyTo ! GetNotFoundFailed(id)
+      Behaviors.same
+  }
+
+  private def handleCreated(
+    state: UserAccountAggregateState.Created,
+    effector: PersistenceEffector[UserAccountAggregateState, UserAccountEvent, Command])
+    : Behavior[Command] =
+    Behaviors.receiveMessagePartial {
+      case Rename(id, newName, replyTo) if state.user.id == id =>
+        state.user.rename(newName) match {
+          case Left(reason) =>
+            replyTo ! RenameFailed(id, reason)
+            Behaviors.same
+          case Right((newUser, event)) =>
+            effector.persistEvent(event) { _ =>
+              replyTo ! RenameSucceeded(id)
+              handleCreated(state.copy(user = newUser), effector)
+            }
+        }
+      case Delete(id, replyTo) if state.user.id == id =>
+        state.user.delete match {
+          case Left(reason) =>
+            replyTo ! DeleteFailed(id, reason)
+            Behaviors.same
+          case Right((newUser, event)) =>
+            effector.persistEvent(event) { _ =>
+              replyTo ! DeleteSucceeded(id)
+              handleDeleted(UserAccountAggregateState.Deleted(newUser.id), effector)
+            }
+        }
+      case Get(id, replyTo) if state.user.id == id =>
+        replyTo ! GetSucceeded(state.user)
+        Behaviors.same
+    }
+
+  private def handleDeleted(
+    state: UserAccountAggregateState.Deleted,
+    effector: PersistenceEffector[UserAccountAggregateState, UserAccountEvent, Command])
+    : Behavior[Command] = Behaviors.receiveMessagePartial {
+    case Get(id, replyTo) =>
+      replyTo ! GetNotFoundFailed(id)
+      Behaviors.same
+  }
 
+  def apply(id: UserAccountId): Behavior[Command] = {
+    val config = PersistenceEffectorConfig
+      .create[UserAccountAggregateState, UserAccountEvent, Command](
+        persistenceId = PersistenceId.of(id.entityTypeName, id.asString).id,
+        initialState = UserAccountAggregateState.NotCreated(id),
+        applyEvent = (state, event) => state.applyEvent(event)
+      )
+      .withPersistenceMode(PersistenceMode.Persisted)
+      .withSnapshotCriteria(SnapshotCriteria.every(1000))
+      .withRetentionCriteria(RetentionCriteria.snapshotEvery(2))
+    Behaviors.setup[Command] { implicit ctx =>
+      Behaviors
+        .supervise(
+          PersistenceEffector
+            .fromConfig[UserAccountAggregateState, UserAccountEvent, Command](
+              config
+            ) {
+              case (initialState: UserAccountAggregateState.NotCreated, effector) =>
+                handleNotCreated(initialState, effector)
+              case (initialState: UserAccountAggregateState.Created, effector) =>
+                handleCreated(initialState, effector)
+            })
+        .onFailure[IllegalArgumentException](
+          SupervisorStrategy.restart
+        )
+    }
+  }
 }
diff --git a/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountAggregateState.scala b/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountAggregateState.scala
index a2dc621..188cd93 100644
--- a/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountAggregateState.scala
+++ b/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountAggregateState.scala
@@ -1,5 +1,39 @@
 package io.github.j5ik2o.pcqrses.interfaceAdapter.users
 
-class UserAccountAggregateState {
+import io.github.j5ik2o.pcqrses.domain.users.{UserAccount, UserAccountEvent, UserAccountId}
+
+enum UserAccountAggregateState {
+  case NotCreated(id: UserAccountId)
+  case Created(user: UserAccount)
+  case Deleted(id: UserAccountId)
+
+  def applyEvent(event: UserAccountEvent): UserAccountAggregateState = (this, event) match {
+    case (NotCreated(id), UserAccountEvent.Created(_, entityId, name, emailAddress, _))
+        if id == entityId =>
+      Created(UserAccount(entityId, name, emailAddress)._1)
+
+    case (Created(user), UserAccountEvent.Renamed(_, entityId, _, newName, _)) if user.id == entityId =>
+      Created(user.rename(newName) match {
+        case Right((u, _)) => u
+        case Left(error) =>
+          throw new IllegalStateException(s"Failed to rename user: $error")
+      })
+
+    case (Created(user), UserAccountEvent.Deleted(_, entityId, _)) if user.id == entityId =>
+      Deleted(user.delete match {
+        case Right((u, _)) => u.id
+        case Left(error) =>
+          throw new IllegalStateException(s"Failed to delete user: $error")
+      })
+
+    case (NotCreated(id), _) =>
+      throw new IllegalStateException(s"Cannot apply event $event to NotCreated state with id $id")
+
+    case (Created(user), _) =>
+      throw new IllegalStateException(s"Cannot apply event $event to Created state with user $user")
+
+    case (Deleted(user), _) =>
+      throw new IllegalStateException(s"Cannot apply event $event to Deleted state with user $user")
+  }
 
 }
diff --git a/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountSnapshotSerializer.scala b/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountSnapshotSerializer.scala
index 6717c83..93b35b0 100644
--- a/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountSnapshotSerializer.scala
+++ b/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountSnapshotSerializer.scala
@@ -1,5 +1,77 @@
 package io.github.j5ik2o.pcqrses.interfaceAdapter.users
 
-class UserAccountSnapshotSerializer {
+import io.github.j5ik2o.pcqrses.command.interfaceAdapter.persistence.users.{UserAccountSnapshot, UserAccount_CreatedSnapshot, UserAccount_DeletedSnapshot, UserAccount_NotCreatedSnapshot, UserAccountName as ProtoUserAccountName}
+import io.github.j5ik2o.pcqrses.domain.basic.DateTime
+import io.github.j5ik2o.pcqrses.domain.users.{EmailAddress as DomainEmailAddress, FirstName, LastName, UserAccount as DomainUserAccount, UserAccountId as DomainUserAccountId, UserAccountName as DomainUserAccountName}
+import io.github.j5ik2o.pcqrses.interfaceAdapter.users.UserAccountAggregateState.{Created, Deleted, NotCreated}
+import org.apache.pekko.serialization.SerializerWithStringManifest
 
+class UserAccountSnapshotSerializer extends SerializerWithStringManifest {
+
+  override def identifier: Int = 20001
+
+  override def manifest(o: AnyRef): String = {
+    o match {
+      case _: NotCreated => "NotCreated"
+      case _: Created => "Created"
+      case _: Deleted => "Deleted"
+    }
+  }
+
+  override def toBinary(o: AnyRef): Array[Byte] = {
+    val snapshot = o match {
+      case NotCreated(id) =>
+        UserAccountSnapshot(
+          state = UserAccountSnapshot.State.NotCreated(UserAccount_NotCreatedSnapshot(id.asString))
+        )
+      case Created(userAccount) =>
+        UserAccountSnapshot(
+          state = UserAccountSnapshot.State.Created(
+            UserAccount_CreatedSnapshot(
+              userAccountId = userAccount.id.asString,
+              userName = Some(ProtoUserAccountName(userAccount.name.breachEncapsulationOfFirstName.asString, userAccount.name.breachEncapsulationOfLastName.asString)),
+              emailAddress = userAccount.emailAddress.asString,
+              createdAt = {
+                val sn = userAccount.createdAt.toSecondsAndNanos
+                Some(com.google.protobuf.timestamp.Timestamp(sn._1, sn._2))
+              },
+              updatedAt = {
+                val sn = userAccount.updatedAt.toSecondsAndNanos
+                Some(com.google.protobuf.timestamp.Timestamp(sn._1, sn._2))
+              }
+            )
+          ))
+      case Deleted(id) =>
+        UserAccountSnapshot(
+          state = UserAccountSnapshot.State.Deleted(
+            UserAccount_DeletedSnapshot(
+              userAccountId = id.asString,
+            )
+          ))
+    }
+    snapshot.toByteArray
+  }
+
+  override def fromBinary(bytes: Array[Byte], manifest: String): AnyRef = {
+    UserAccountSnapshot.parseFrom(bytes).state match {
+      case UserAccountSnapshot.State.NotCreated(value) =>
+        NotCreated(DomainUserAccountId.from(value.userAccountId))
+      case UserAccountSnapshot.State.Created(value) =>
+        val (userAccount, _) = DomainUserAccount(
+          id = DomainUserAccountId.from(value.userAccountId),
+          name = DomainUserAccountName(
+            FirstName(value.userName.get.firstName),
+            LastName(value.userName.get.lastName)
+          ),
+          emailAddress = DomainEmailAddress(value.emailAddress),
+          createdAt = DateTime.fromSecondsAndNanos(value.createdAt.get.seconds, value.createdAt.get.nanos),
+          updatedAt = DateTime.fromSecondsAndNanos(value.updatedAt.get.seconds, value.updatedAt.get.nanos),
+        )
+        Created(userAccount)
+      case UserAccountSnapshot.State.Deleted(value) =>
+        Deleted(DomainUserAccountId.from(value.userAccountId))
+      case UserAccountSnapshot.State.Empty =>
+        throw new IllegalArgumentException("Unexpected Empty state in snapshot")
+    }
+  }
 }

```

## コミット: afd9bf1

### メッセージ

```
chore: プロジェクト設定ファイルの追加
- EditorConfigでエディタ設定を統一
- Scalafmt/Scalafixでコードスタイルを標準化
- .gitignoreでビルド成果物やIDEファイルを除外
- .env.exampleで環境変数のテンプレートを提供
- Gitコミット用のClaude Codeコマンドを追加
- sbtオプションでJava互換性を設定
```

### 変更されたファイル

- A	.claude/commands/git-commit.md
- A	.editorconfig
- A	.env.example
- A	.gitignore
- A	.sbtopts
- A	.scalafix.conf
- A	.scalafmt.conf
- A	apps/read-model-updater/src/main/resources/application.conf
- A	apps/read-model-updater/src/main/scala/io/github/j5ik2o/pcqrses/readModelUpdater/LambdaHandler.scala
- A	apps/read-model-updater/src/main/scala/io/github/j5ik2o/pcqrses/readModelUpdater/LambdaResponse.scala
- A	apps/read-model-updater/src/main/scala/io/github/j5ik2o/pcqrses/readModelUpdater/ResponseBody.scala
- A	docker-compose-cluster.yml
- A	docker-compose-common.yml
- A	docker-compose-local.yml
- A	modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/basic/DateTime.scala
- A	modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/basic/DateTimeError.scala
- A	modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/DomainError.scala
- A	modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/DomainEvent.scala
- A	modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/DomainEventId.scala
- A	modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/Entity.scala
- A	modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/EntityId.scala
- A	modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/DeleteError.scala
- A	modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/EmailAddress.scala
- A	modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/EmailAddressError.scala
- A	modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/FirstName.scala
- A	modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/FirstNameError.scala
- A	modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/LastName.scala
- A	modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/LastNameError.scala
- A	modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/RenameError.scala
- A	modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccount.scala
- A	modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccountEvent.scala
- A	modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccountId.scala
- A	modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccountIdError.scala
- A	modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccountName.scala
- A	modules/command/interface-adapter-contract/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/contract/users/UserAccountProtocol.scala
- A	modules/command/interface-adapter/src/main/protobuf/users/basic.proto
- A	modules/command/interface-adapter/src/main/protobuf/users/snapshot.proto
- A	modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountAggregate.scala
- A	modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountAggregateState.scala
- A	modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountSnapshotSerializer.scala
- A	scripts/cleanup-lambda-localstack.sh
- A	scripts/common.sh
- A	scripts/deploy-lambda-localstack.sh
- A	scripts/lib/common.sh
- A	scripts/run-cluster.sh
- A	scripts/run-common.sh
- A	scripts/run-single.sh
- A	scripts/test-e2e.sh
- A	scripts/test-graphql.sh
- A	tools/dynamodb-setup/Dockerfile
- A	tools/dynamodb-setup/Makefile
- A	tools/dynamodb-setup/account-table.json
- A	tools/dynamodb-setup/config.env
- A	tools/dynamodb-setup/create-table.sh
- A	tools/dynamodb-setup/deploy.env
- A	tools/dynamodb-setup/journal-table.json
- A	tools/dynamodb-setup/scan.sh
- A	tools/dynamodb-setup/snapshot-table.json
- A	tools/dynamodb-setup/state-table.json
- A	tools/flyway/seed/V2__insert_staff_test_data.sql
- A	tools/pgadmin/pgpass
- A	tools/pgadmin/servers.json

### 変更内容

```diff
commit afd9bf13f45ae2c2e30560d1a7f1218f39b815aa
Author: Junichi Kato <j5ik2o@gmail.com>
Date:   Sat Sep 13 09:24:12 2025 +0900

    chore: プロジェクト設定ファイルの追加
    
    - EditorConfigでエディタ設定を統一
    - Scalafmt/Scalafixでコードスタイルを標準化
    - .gitignoreでビルド成果物やIDEファイルを除外
    - .env.exampleで環境変数のテンプレートを提供
    - Gitコミット用のClaude Codeコマンドを追加
    - sbtオプションでJava互換性を設定

diff --git a/.claude/commands/git-commit.md b/.claude/commands/git-commit.md
new file mode 100644
index 0000000..3c4315f
--- /dev/null
+++ b/.claude/commands/git-commit.md
@@ -0,0 +1,47 @@
+---
+allowed-tools: Bash(git:*), Bash(npm:*), Read(*.md), Fetch(*)
+description: "ワーキングディレクトリでの変更をコミットします"
+---
+
+意味のある変更単位ごとにコミットを行うことは、コードの履歴を明確にし、将来の変更を追跡しやすくするために重要です。
+
+以下の手順に従って、ワーキングディレクトリでの変更をコミットします。
+
+### 1. 変更を確認する
+
+まず、現在のワーキングディレクトリでの変更を確認します。以下のコマンドを実行してください：
+
+```bash
+git status
+```
+
+### 2. 変更をステージングする
+
+変更をコミットする前に、ステージングエリアに追加する必要があります。以下のコマンドを使用して、すべての変更をステージングします：
+
+```bash
+git add 対象ファイルやディレクトリ
+```
+
+意味のある変更単位ごとにファイルを指定すること。無条件にすべての変更を追加しないでください。
+
+### 3. コミットメッセージを作成する
+
+コミットメッセージは、変更内容を簡潔に説明する重要な部分です。以下のコマンドを使用して、コミットを作成します：
+
+```bash
+git commit -m "コミットメッセージをここに入力"
+```
+
+- コミットメッセージは日本語で記述してください。
+- Conventional Commitsのルールに従ってください。
+- co-authorやコミットメッセージに"Claude Code"のキーワードは含めないこと。
+
+### 4. コミットを確認する
+コミットが正しく行われたかを確認するために、以下のコマンドを実行します：
+
+```bash
+git log --oneline
+```
+
+これにより、最近のコミットの一覧が表示され、コミットメッセージとハッシュが確認できます。
diff --git a/.editorconfig b/.editorconfig
new file mode 100644
index 0000000..6379513
--- /dev/null
+++ b/.editorconfig
@@ -0,0 +1,30 @@
+# EditorConfig is awesome: https://EditorConfig.org
+
+# top-most EditorConfig file
+root = true
+
+# すべてのファイルに適用
+[*]
+charset = utf-8
+end_of_line = lf
+insert_final_newline = true
+trim_trailing_whitespace = true
+
+# Scalaファイル
+[*.{scala,sbt}]
+indent_style = space
+indent_size = 2
+
+# Markdownファイル（末尾の空白が意味を持つことがある）
+[*.md]
+trim_trailing_whitespace = false
+
+# YAMLファイル
+[*.{yml,yaml}]
+indent_style = space
+indent_size = 2
+
+# JSONファイル
+[*.json]
+indent_style = space
+indent_size = 2
\ No newline at end of file
diff --git a/.env.example b/.env.example
new file mode 100644
index 0000000..5c3e521
--- /dev/null
+++ b/.env.example
@@ -0,0 +1,42 @@
+# ========================================
+# 環境変数設定サンプル
+# ========================================
+# このファイルをコピーして .env として使用してください:
+#   cp .env.example .env
+#
+# docker composeとrun-single.shスクリプトで使用されます
+
+# Docker環境のポート設定
+# ※docker-compose-common.yml, docker-compose-local.ymlと連動
+DOCKER_COMMAND_API_PORT=50501
+DOCKER_QUERY_API_PORT=50502
+DOCKER_POSTGRES_PORT=50504
+DOCKER_LOCALSTACK_PORT=50503
+DOCKER_DYNAMODB_ADMIN_PORT=50505
+
+COMMAND_API_SERVER_HOST=127.0.0.1
+COMMAND_API_SERVER_PORT=18080
+
+# AWS設定（LocalStack用）
+AWS_REGION=ap-northeast-1
+AWS_ACCESS_KEY_ID=dummy
+AWS_SECRET_ACCESS_KEY=dummy
+
+# クラスター設定（./scripts/run-cluster.sh）
+# Node 1
+CLUSTER_NODE1_API_PORT=50501
+CLUSTER_NODE1_MANAGEMENT_PORT=8558
+CLUSTER_NODE1_REMOTE_PORT=2551
+
+# Node 2
+CLUSTER_NODE2_API_PORT=50511
+CLUSTER_NODE2_MANAGEMENT_PORT=8559
+CLUSTER_NODE2_REMOTE_PORT=2552
+
+# Node 3
+CLUSTER_NODE3_API_PORT=50521
+CLUSTER_NODE3_MANAGEMENT_PORT=8560
+CLUSTER_NODE3_REMOTE_PORT=2553
+
+# Protocol Buffers コンパイラパス（必要に応じて設定）
+# PROTOC_PATH=/opt/homebrew/bin/protoc
diff --git a/.gitignore b/.gitignore
new file mode 100644
index 0000000..5f95204
--- /dev/null
+++ b/.gitignore
@@ -0,0 +1,40 @@
+# macOS
+.DS_Store
+
+# sbt specific
+dist/*
+target/
+lib_managed/
+src_managed/
+project/boot/
+project/plugins/project/
+project/local-plugins.sbt
+.history
+.ensime
+.ensime_cache/
+.sbt-scripted/
+local.sbt
+
+# Bloop
+.bsp
+
+# VS Code
+.vscode/
+
+# Metals
+.bloop/
+.metals/
+metals.sbt
+
+# IDEA
+.idea
+.idea_modules
+/.worksheet/
+.env
+
+mise.toml
+.qodo
+
+volume/
+
+.claude/settings.local.json
diff --git a/.sbtopts b/.sbtopts
new file mode 100644
index 0000000..27f4f7b
--- /dev/null
+++ b/.sbtopts
@@ -0,0 +1,2 @@
+-J--add-opens=java.base/java.util=ALL-UNNAMED
+-J--add-opens=java.base/java.lang=ALL-UNNAMED
diff --git a/.scalafix.conf b/.scalafix.conf
new file mode 100644
index 0000000..ec3fcbd
--- /dev/null
+++ b/.scalafix.conf
@@ -0,0 +1,50 @@
+rules = [
+  // def/val に戻り型を明示しないと警告。型安全性・API可視性の向上に寄与。
+  ExplicitResultTypes,
+
+  // 未使用の import, val, param などを検出・削除。
+  RemoveUnused,
+
+  // 関数呼び出し時の暗黙のタプル変換を禁止（Scalaの罠を防止）。
+  NoAutoTupling,
+
+  // 禁止したい構文の指定（下で個別に設定）。
+  DisableSyntax,
+
+  // Scala 2 の古い def foo { ... } 構文を禁止（= 明示的な戻り型と = が必要）。
+  ProcedureSyntax,
+
+  // implicit class が内部で public な val を定義してしまうのを防止。
+  LeakingImplicitClassVal,
+
+  // for 内の `val` 宣言を禁止（副作用的記述の抑止）。
+  NoValInForComprehension
+]
+
+# ---------- DisableSyntax 詳細 ----------
+DisableSyntax.noIndentationSyntax = true
+# Scala 3 のインデント構文（オフサイドルール）を禁止。
+# → 中括弧 `{}` を必須とすることで、明示的なスコープを強制。
+
+DisableSyntax.noNull = true
+# null の使用を禁止（Option型や例外ベースのエラーハンドリングを推奨）。
+
+DisableSyntax.noVar = true
+# var の使用を禁止（不変性を重視した設計へ）。
+
+DisableSyntax.noFinalize = true
+# finalize() の使用を禁止（Java 互換の古い破棄モデルは非推奨）。
+
+DisableSyntax.noProcedureSyntax = true
+# def foo { ... } のような戻り型・ = のない構文を禁止。
+
+# ---------- OrganizeImports 設定（オプションでおすすめ） ----------
+OrganizeImports.groupedImports = Explode
+# import を1行ずつに分割（読みやすさ・git diff にも有利）。
+
+OrganizeImports.removeUnused = true
+# 未使用の import を自動で削除。
+
+# ---------- SemanticDB 必須 ----------
+semanticdb.symbols = all
+# SemanticDB は scalafix による構文解析・型解析の基盤。
diff --git a/.scalafmt.conf b/.scalafmt.conf
new file mode 100644
index 0000000..0c492b7
--- /dev/null
+++ b/.scalafmt.conf
@@ -0,0 +1,79 @@
+# ----------------------------------------
+# 使用する scalafmt のバージョン
+# ----------------------------------------
+version = "3.9.4"
+
+# ----------------------------------------
+# Scala 3 を使う。ただし中括弧スタイルを前提に。
+# ----------------------------------------
+runner.dialect = scala3
+
+# ----------------------------------------
+# 最大行長（読みやすさと diff のバランス）
+# ----------------------------------------
+maxColumn = 100
+
+# ----------------------------------------
+# インデント設定（すべて2スペースに統一）
+# ----------------------------------------
+indent.main = 2
+indent.callSite = 2
+indent.defnSite = 2
+indent.extendSite = 2
+indent.ctorSite = 2
+
+# ----------------------------------------
+# 整列を無効化（diff ノイズ防止）
+# ----------------------------------------
+align.preset = none
+
+# ----------------------------------------
+# 括弧の改行挙動
+# ----------------------------------------
+danglingParentheses.preset = false
+
+# ----------------------------------------
+# 中括弧スタイルの一貫性
+# ----------------------------------------
+includeCurlyBraceInSelectChains = true
+
+# ----------------------------------------
+# アノテーションを複数行で書く際に改行する
+# ----------------------------------------
+optIn.annotationNewlines = true
+
+# ----------------------------------------
+# スペースの挙動（重要な部分のみ設定）
+# ----------------------------------------
+spaces.inParentheses = false
+spaces.afterKeywordBeforeParen = true
+spaces.beforeContextBoundColon = true
+
+# ----------------------------------------
+# 複数行のリスト・引数などには末尾カンマを付ける
+# ----------------------------------------
+trailingCommas = never
+
+# ----------------------------------------
+# 自動リファクタリングルール
+# ----------------------------------------
+rewrite.rules = [
+  SortImports,        # import の整理とソート
+  RedundantParens,    # 不要な括弧の削除
+  RedundantBraces     # 不要な中括弧の削除（1行のみ対象）
+]
+
+# ----------------------------------------
+# 行末の空白を削除
+# ----------------------------------------
+rewrite.trailingCommas.allowFolding = false
+
+# ----------------------------------------
+# Scaladoc コメントスタイル（/** ... */）
+# ----------------------------------------
+docstrings.style = Asterisk
+
+# ----------------------------------------
+# Git リポジトリ用の最適化（.gitignore などの扱い）
+# ----------------------------------------
+project.git = true
diff --git a/apps/read-model-updater/src/main/resources/application.conf b/apps/read-model-updater/src/main/resources/application.conf
new file mode 100644
index 0000000..e69de29
diff --git a/apps/read-model-updater/src/main/scala/io/github/j5ik2o/pcqrses/readModelUpdater/LambdaHandler.scala b/apps/read-model-updater/src/main/scala/io/github/j5ik2o/pcqrses/readModelUpdater/LambdaHandler.scala
new file mode 100644
index 0000000..565a580
--- /dev/null
+++ b/apps/read-model-updater/src/main/scala/io/github/j5ik2o/pcqrses/readModelUpdater/LambdaHandler.scala
@@ -0,0 +1,5 @@
+package io.github.j5ik2o.pcqrses.readModelUpdater
+
+class LambdaHandler {
+
+}
diff --git a/apps/read-model-updater/src/main/scala/io/github/j5ik2o/pcqrses/readModelUpdater/LambdaResponse.scala b/apps/read-model-updater/src/main/scala/io/github/j5ik2o/pcqrses/readModelUpdater/LambdaResponse.scala
new file mode 100644
index 0000000..5e70bb2
--- /dev/null
+++ b/apps/read-model-updater/src/main/scala/io/github/j5ik2o/pcqrses/readModelUpdater/LambdaResponse.scala
@@ -0,0 +1,3 @@
+package io.github.j5ik2o.pcqrses.readModelUpdater
+
+case class LambdaResponse(statusCode: Int, body: String)
diff --git a/apps/read-model-updater/src/main/scala/io/github/j5ik2o/pcqrses/readModelUpdater/ResponseBody.scala b/apps/read-model-updater/src/main/scala/io/github/j5ik2o/pcqrses/readModelUpdater/ResponseBody.scala
new file mode 100644
index 0000000..4d376f4
--- /dev/null
+++ b/apps/read-model-updater/src/main/scala/io/github/j5ik2o/pcqrses/readModelUpdater/ResponseBody.scala
@@ -0,0 +1,3 @@
+package io.github.j5ik2o.pcqrses.readModelUpdater
+
+case class ResponseBody(message: String, error: Option[String] = None)
diff --git a/docker-compose-cluster.yml b/docker-compose-cluster.yml
new file mode 100644
index 0000000..c1530bc
--- /dev/null
+++ b/docker-compose-cluster.yml
@@ -0,0 +1,74 @@
+# クラスター構成（3ノード）用の設定
+# 共通設定をアンカーで定義
+x-dynamodb-env: &dynamodb-env
+  J5IK2O_DYNAMO_DB_JOURNAL_DYNAMO_DB_CLIENT_ENDPOINT: http://localstack:4566
+  J5IK2O_DYNAMO_DB_SNAPSHOT_DYNAMO_DB_CLIENT_ENDPOINT: http://localstack:4566
+  J5IK2O_DYNAMO_DB_STATE_DYNAMO_DB_CLIENT_ENDPOINT: http://localstack:4566
+  AWS_REGION: ap-northeast-1
+  AWS_ACCESS_KEY_ID: dummy
+  AWS_SECRET_ACCESS_KEY: dummy
+
+x-cluster-env: &cluster-env
+  PEKKO_CLUSTER_ENABLED: "true"
+  PEKKO_MANAGEMENT_HTTP_HOSTNAME: 0.0.0.0
+  PEKKO_MANAGEMENT_HTTP_PORT: 8558
+  PEKKO_CLUSTER_SEED_NODES: "pekko://command-api-system@command-api-1:2551"
+  PEKKO_CLUSTER_BOOTSTRAP_REQUIRED_CONTACTS: 2
+  COMMAND_API_SERVER_HOST: 0.0.0.0
+  COMMAND_API_SERVER_PORT: 18080
+  COMMAND_API_DETACH_WAIT_DURATION: "5s"
+  COMMAND_API_HEALTH_CHECK_GRACE_PERIOD: "10s"
+
+x-command-api-base: &command-api-base
+  image: pcqrses-command-api:0.1.0
+  networks:
+    - pcqrses-network
+  environment:
+    <<: [*dynamodb-env, *cluster-env]
+  depends_on:
+    dynamodb-setup:
+      condition: service_completed_successfully
+
+services:
+  # Command API Cluster - Node 1 (Seed Node)
+  command-api-1:
+    <<: *command-api-base
+    ports:
+      - "${CLUSTER_NODE1_API_PORT:-50501}:18080"  # HTTP/gRPC
+      - "${CLUSTER_NODE1_MANAGEMENT_PORT:-8558}:8558"    # Pekko Management
+      - "${CLUSTER_NODE1_REMOTE_PORT:-2551}:2551"    # Pekko Remote
+    environment:
+      <<: [*dynamodb-env, *cluster-env]
+      PEKKO_REMOTE_HOSTNAME: command-api-1
+      PEKKO_REMOTE_PORT: 2551
+      JAVA_OPTS: "-Dpekko.cluster.enabled=true -Dpekko.actor.provider=cluster -Dpekko.remote.artery.canonical.hostname=command-api-1 -Dpekko.remote.artery.canonical.port=2551 -Dpekko.cluster.seed-nodes.0=pekko://command-api-system@command-api-1:2551 -Dpekko.management.http.hostname=0.0.0.0 -Dpekko.management.http.port=8558 -Dcommand-api.detach-wait-duration=5s -Dcommand-api.health-check-grace-period=10s"
+
+  # Command API Cluster - Node 2
+  command-api-2:
+    <<: *command-api-base
+    ports:
+      - "${CLUSTER_NODE2_API_PORT:-50511}:18080"  # HTTP/gRPC
+      - "${CLUSTER_NODE2_MANAGEMENT_PORT:-8559}:8558"    # Pekko Management
+      - "${CLUSTER_NODE2_REMOTE_PORT:-2552}:2551"    # Pekko Remote
+    depends_on:
+      - command-api-1
+    environment:
+      <<: [*dynamodb-env, *cluster-env]
+      PEKKO_REMOTE_HOSTNAME: command-api-2
+      PEKKO_REMOTE_PORT: 2551
+      JAVA_OPTS: "-Dpekko.cluster.enabled=true -Dpekko.actor.provider=cluster -Dpekko.remote.artery.canonical.hostname=command-api-2 -Dpekko.remote.artery.canonical.port=2551 -Dpekko.cluster.seed-nodes.0=pekko://command-api-system@command-api-1:2551 -Dpekko.management.http.hostname=0.0.0.0 -Dpekko.management.http.port=8558 -Dcommand-api.detach-wait-duration=5s -Dcommand-api.health-check-grace-period=10s"
+
+  # Command API Cluster - Node 3
+  command-api-3:
+    <<: *command-api-base
+    ports:
+      - "${CLUSTER_NODE3_API_PORT:-50521}:18080"  # HTTP/gRPC
+      - "${CLUSTER_NODE3_MANAGEMENT_PORT:-8560}:8558"    # Pekko Management
+      - "${CLUSTER_NODE3_REMOTE_PORT:-2553}:2551"    # Pekko Remote
+    depends_on:
+      - command-api-1
+    environment:
+      <<: [*dynamodb-env, *cluster-env]
+      PEKKO_REMOTE_HOSTNAME: command-api-3
+      PEKKO_REMOTE_PORT: 2551
+      JAVA_OPTS: "-Dpekko.cluster.enabled=true -Dpekko.actor.provider=cluster -Dpekko.remote.artery.canonical.hostname=command-api-3 -Dpekko.remote.artery.canonical.port=2551 -Dpekko.cluster.seed-nodes.0=pekko://command-api-system@command-api-1:2551 -Dpekko.management.http.hostname=0.0.0.0 -Dpekko.management.http.port=8558 -Dcommand-api.detach-wait-duration=5s -Dcommand-api.health-check-grace-period=10s"
diff --git a/docker-compose-common.yml b/docker-compose-common.yml
new file mode 100644
index 0000000..29f67e4
--- /dev/null
+++ b/docker-compose-common.yml
@@ -0,0 +1,181 @@
+# ========================================
+# 共通のサービス定義とネットワーク設定
+# ========================================
+#
+# このファイルは全ての環境で共通となるサービス定義です。
+#
+# 使い方:
+#   - 開発環境: docker compose -f docker-compose-common.yml -f docker-compose-local.yml up -d
+#   - クラスター: docker compose -f docker-compose-common.yml -f docker-compose-cluster.yml up -d
+#
+# または以下のスクリプトを使用:
+#   - ./scripts/run-single.sh   # 単一ノード構成（Docker）
+#   - ./scripts/run-cluster.sh  # クラスター環境（3ノード）
+#
+services:
+  # LocalStack (DynamoDB, Lambda等のAWSサービスのエミュレータ)
+  localstack:
+    image: localstack/localstack:4.7
+    hostname: localstack
+    ports:
+      - "${DOCKER_LOCALSTACK_PORT:-50503}:4566"
+    environment:
+      - SERVICES=lambda,dynamodb
+      - DEBUG=1
+      - LAMBDA_EXECUTOR=docker
+      - DOCKER_HOST=unix:///var/run/docker.sock
+      - AWS_DEFAULT_REGION=ap-northeast-1
+      - AWS_ACCESS_KEY_ID=dummy
+      - AWS_SECRET_ACCESS_KEY=dummy
+      - LAMBDA_DOCKER_NETWORK=pcqrses_back_pcqrses-network
+      - AWS_ENDPOINT_URL=http://localstack:4566
+      - LOCALSTACK_HOST=localstack
+      - HOSTNAME_FROM_LAMBDA=localstack
+      - LAMBDA_DOCKER_DNS=127.0.0.11
+      - LAMBDA_RUNTIME_ENVIRONMENT_TIMEOUT=60
+      - LAMBDA_REMOVE_CONTAINERS=true
+      - LAMBDA_LIMITS_CODE_SIZE_ZIPPED=524288000
+      - LAMBDA_LIMITS_CODE_SIZE_UNZIPPED=2147483648
+      - LAMBDA_LIMITS_CREATE_FUNCTION_REQUEST_SIZE=314572800
+      - LAMBDA_DOCKER_FLAGS=--platform=${DOCKER_DEFAULT_PLATFORM:-linux/amd64}
+      - LAMBDA_IGNORE_ARCHITECTURE=1
+    volumes:
+      - "/var/run/docker.sock:/var/run/docker.sock"
+    networks:
+      - pcqrses-network
+    restart: unless-stopped
+    healthcheck:
+      test: ["CMD-SHELL", "python -c \"import socket,sys; s=socket.socket(); s.settimeout(2); s.connect(('localhost',4566)); sys.exit(0)\""]
+      interval: 5s
+      timeout: 3s
+      retries: 30
+      start_period: 5s
+
+  # DynamoDBテーブルセットアップ
+  dynamodb-setup:
+    build:
+      context: ./tools/dynamodb-setup
+    networks:
+      - pcqrses-network
+    environment:
+      AWS_ACCESS_KEY_ID: dummy
+      AWS_SECRET_ACCESS_KEY: dummy
+      AWS_DEFAULT_REGION: ap-northeast-1
+      DYNAMODB_ENDPOINT: http://localstack:4566
+    command: ["-e", "dev"]
+    depends_on:
+      localstack:
+        condition: service_healthy
+
+  # DynamoDB管理UI
+  dynamodb-admin:
+    image: aaronshaf/dynamodb-admin
+    ports:
+      - "${DOCKER_DYNAMODB_ADMIN_PORT:-50505}:8001"
+    networks:
+      - pcqrses-network
+    environment:
+      DYNAMO_ENDPOINT: http://localstack:4566
+      AWS_REGION: ap-northeast-1
+      AWS_ACCESS_KEY_ID: dummy
+      AWS_SECRET_ACCESS_KEY: dummy
+    depends_on:
+      localstack:
+        condition: service_healthy
+
+  # PostgreSQL (Read側データベース)
+  postgres:
+    image: postgres:16.4
+    environment:
+      POSTGRES_USER: postgres
+      POSTGRES_PASSWORD: postgres
+      POSTGRES_DB: pcqrses_development
+      # Simplify local dev: allow trust auth (no password prompt)
+      POSTGRES_HOST_AUTH_METHOD: trust
+    ports:
+      - "${DOCKER_POSTGRES_PORT:-50504}:5432"
+    restart: unless-stopped
+    networks:
+      pcqrses-network:
+        aliases:
+          - pcqrses_postgres
+    healthcheck:
+      test: ["CMD-SHELL", "pg_isready -U postgres"]
+      interval: 10s
+      timeout: 5s
+      retries: 5
+
+  # pgAdmin (PostgreSQL管理UI)
+  pgadmin:
+    image: dpage/pgadmin4:latest
+    environment:
+      PGADMIN_DEFAULT_EMAIL: admin@example.com
+      PGADMIN_DEFAULT_PASSWORD: admin
+      PGADMIN_CONFIG_SERVER_MODE: 'False'
+      PGADMIN_CONFIG_MASTER_PASSWORD_REQUIRED: 'False'
+      PGADMIN_SERVER_JSON_FILE: /pgadmin4/servers.json
+    ports:
+      - "${DOCKER_PGADMIN_PORT:-50506}:80"
+    volumes:
+      - ./tools/pgadmin/servers.json:/pgadmin4/servers.json:ro
+      - ./tools/pgadmin/pgpass:/tmp/pgpassfile:ro
+    depends_on:
+      - postgres
+    networks:
+      - pcqrses-network
+    restart: unless-stopped
+    entrypoint:
+      - "/bin/sh"
+      - "-c"
+      - |
+        set -e
+        EMAIL_DIR=$(echo "$${PGADMIN_DEFAULT_EMAIL:-admin@example.com}" | tr '@' '_')
+        mkdir -p "/var/lib/pgadmin/storage/$${EMAIL_DIR}"
+        cp /tmp/pgpassfile "/var/lib/pgadmin/storage/$${EMAIL_DIR}/pgpassfile"
+        chmod 600 "/var/lib/pgadmin/storage/$${EMAIL_DIR}/pgpassfile"
+        exec /entrypoint.sh
+
+  # Flyway (データベースマイグレーション)
+  flyway:
+    image: flyway/flyway:10
+    command: migrate
+    environment:
+      - FLYWAY_URL=jdbc:postgresql://postgres:5432/pcqrses_development
+      - FLYWAY_USER=postgres
+      - FLYWAY_PASSWORD=postgres
+      - FLYWAY_CONNECT_RETRIES=60
+      - FLYWAY_BASELINE_ON_MIGRATE=true
+      - FLYWAY_LOCATIONS=filesystem:/flyway/sql,filesystem:/flyway/seed
+    volumes:
+      - ./modules/query/flyway-migration/src/main/resources/db/migration:/flyway/sql
+      - ./tools/flyway/seed:/flyway/seed:ro
+    depends_on:
+      postgres:
+        condition: service_healthy
+    networks:
+      - pcqrses-network
+
+  # Query API (Read側API) - 単一ノード
+  query-api:
+    image: pcqrses-query-api:0.1.0
+    ports:
+      - "${DOCKER_QUERY_API_PORT:-50502}:18082"
+    depends_on:
+      flyway:
+        condition: service_completed_successfully
+    networks:
+      - pcqrses-network
+    environment:
+      # サーバー設定
+      QUERY_API_SERVER_HOST: 0.0.0.0
+      QUERY_API_SERVER_PORT: 18082
+      # データベース設定
+      DATABASE_URL: jdbc:postgresql://postgres:5432/pcqrses_development
+      DATABASE_USER: postgres
+      DATABASE_PASSWORD: postgres
+      # GraphQL設定
+      GRAPHIQL_ENABLED: "true"  # 開発環境でGraphiQLを有効化
+
+networks:
+  pcqrses-network:
+    driver: bridge
diff --git a/docker-compose-local.yml b/docker-compose-local.yml
new file mode 100644
index 0000000..86fc4a8
--- /dev/null
+++ b/docker-compose-local.yml
@@ -0,0 +1,24 @@
+# 開発環境用の単一ノード構成
+services:
+  # Command API - 単一ノード（ローカル開発用）
+  command-api-1:
+    image: pcqrses-command-api:0.1.0
+    ports:
+      - "${DOCKER_COMMAND_API_PORT:-50501}:18080"
+    depends_on:
+      dynamodb-setup:
+        condition: service_completed_successfully
+    networks:
+      - pcqrses-network
+    environment:
+      # DynamoDB設定
+      J5IK2O_DYNAMO_DB_JOURNAL_DYNAMO_DB_CLIENT_ENDPOINT: http://localstack:4566
+      J5IK2O_DYNAMO_DB_SNAPSHOT_DYNAMO_DB_CLIENT_ENDPOINT: http://localstack:4566
+      J5IK2O_DYNAMO_DB_STATE_DYNAMO_DB_CLIENT_ENDPOINT: http://localstack:4566
+      AWS_REGION: ap-northeast-1
+      AWS_ACCESS_KEY_ID: dummy
+      AWS_SECRET_ACCESS_KEY: dummy
+      # アプリケーション設定（クラスターなし）
+      PEKKO_CLUSTER_ENABLED: "false"
+      COMMAND_API_SERVER_HOST: 0.0.0.0
+      COMMAND_API_SERVER_PORT: 18080
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/basic/DateTime.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/basic/DateTime.scala
new file mode 100644
index 0000000..66bd140
--- /dev/null
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/basic/DateTime.scala
@@ -0,0 +1,20 @@
+package io.github.j5ik2o.pcqrses.domain.users
+
+import java.time.{Instant, LocalDateTime, ZoneId, ZonedDateTime}
+
+trait DateTime {
+  def asLocalDateTime: LocalDateTime
+  def asZonedDateTime(zoneId: ZoneId = ZoneId.systemDefault()): ZonedDateTime = asLocalDateTime.atZone(zoneId)
+  def asInstant(zoneId: ZoneId = ZoneId.systemDefault()): Instant = asZonedDateTime(zoneId).toInstant
+}
+
+object DateTime {
+  def apply(value: LocalDateTime): DateTime = DateTimeImpl(value)
+  def unapply(dateTime: DateTime): Option[LocalDateTime] = Some(dateTime.asLocalDateTime)
+
+  def now(): DateTime = DateTimeImpl(LocalDateTime.now())
+
+  private case class DateTimeImpl(value: LocalDateTime) extends DateTime {
+    override def asLocalDateTime: LocalDateTime = value
+  }
+}
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/basic/DateTimeError.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/basic/DateTimeError.scala
new file mode 100644
index 0000000..0fed815
--- /dev/null
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/basic/DateTimeError.scala
@@ -0,0 +1,5 @@
+package io.github.j5ik2o.pcqrses.domain.basic
+
+enum DateTimeError {
+
+}
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/DomainError.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/DomainError.scala
new file mode 100644
index 0000000..dd7c943
--- /dev/null
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/DomainError.scala
@@ -0,0 +1,5 @@
+package io.github.j5ik2o.pcqrses.domain.support
+
+trait DomainError {
+
+}
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/DomainEvent.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/DomainEvent.scala
new file mode 100644
index 0000000..cc7c9e5
--- /dev/null
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/DomainEvent.scala
@@ -0,0 +1,10 @@
+package io.github.j5ik2o.pcqrses.domain.support
+
+import java.time.Instant
+
+trait AggregateEvent {
+  type AggregateIdType <: AggregateId
+  def id: AggregateEventId
+  def aggregateId: AggregateIdType
+  def occurredAt: Instant
+}
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/DomainEventId.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/DomainEventId.scala
new file mode 100644
index 0000000..6377100
--- /dev/null
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/DomainEventId.scala
@@ -0,0 +1,27 @@
+package io.github.j5ik2o.pcqrses.domain.support
+
+import wvlet.airframe.ulid.ULID
+
+trait AggregateEventId {
+  def asString: String
+}
+
+object AggregateEventId {
+  def apply(value: ULID): AggregateEventId = AggregateEventIdImpl(value)
+
+  def from(value: String): AggregateEventId = AggregateEventIdImpl(ULID.fromString(value))
+
+  def generate(): AggregateEventId = AggregateEventIdImpl(ULID.newULID)
+
+  def parse(value: String): Either[Exception, AggregateEventId] =
+    try
+      Right(from(value))
+    catch {
+      case e: IllegalArgumentException => Left(e)
+    }
+
+  private final case class AggregateEventIdImpl(ulid: ULID) extends AggregateEventId {
+    override def asString: String = ulid.toString
+  }
+
+}
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/Entity.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/Entity.scala
new file mode 100644
index 0000000..77dee5f
--- /dev/null
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/Entity.scala
@@ -0,0 +1,6 @@
+package io.github.j5ik2o.pcqrses.domain.support
+
+trait AggregateRoot {
+  type IdType <: AggregateId
+  def id: IdType
+}
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/EntityId.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/EntityId.scala
new file mode 100644
index 0000000..c90a520
--- /dev/null
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/support/EntityId.scala
@@ -0,0 +1,6 @@
+package io.github.j5ik2o.pcqrses.domain.support
+
+trait AggregateId {
+  def aggregateTypeName: String
+  def asString: String
+}
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/DeleteError.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/DeleteError.scala
new file mode 100644
index 0000000..a5a8fb8
--- /dev/null
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/DeleteError.scala
@@ -0,0 +1,5 @@
+package io.github.j5ik2o.pcqrses.domain.users
+
+class DeleteError {
+
+}
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/EmailAddress.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/EmailAddress.scala
new file mode 100644
index 0000000..38e6637
--- /dev/null
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/EmailAddress.scala
@@ -0,0 +1,68 @@
+package io.github.j5ik2o.pcqrses.domain.staff
+
+/**
+ * メールアドレスを表現するValue Object。
+ *
+ * スタッフへの主要な連絡手段として機能し、 システム通知やパスワードリセット等の重要なプロセスで使用される。 RFC5322準拠のバリデーションにより有効性を保証する。
+ */
+trait EmailAddress {
+
+  /** 文字列表現として取得する。メール送信やUI表示で使用 */
+  def asString: String
+}
+
+/**
+ * EmailAddressのファクトリーオブジェクト。
+ *
+ * RFC5322準拠のバリデーション機能により、 有効なメールアドレスのみを生成することを保証する。
+ */
+object EmailAddress {
+
+  private[staff] final val MaxLength = 100
+
+  /**
+   * 文字列からEmailAddressを作成する。
+   *
+   * @param value
+   *   メールアドレスの文字列
+   * @return
+   *   作成されたEmailAddressインスタンス
+   * @throws IllegalArgumentException
+   *   バリデーション失敗時
+   */
+  def apply(value: String): EmailAddress =
+    parseFromString(value) match {
+      case Right(result) => result
+      case Left(error) => throw new IllegalArgumentException(error.toString)
+    }
+
+  def unapply(self: EmailAddress): Option[String] = Some(self.asString)
+
+  private final val EmailRegex = "^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$".r
+
+  /**
+   * バリデーション付きでEmailAddressをパースする。
+   *
+   * 外部入力値の検証が必要な場面で使用し、 型安全なエラーハンドリングを提供する。
+   *
+   * @param value
+   *   パース対象の文字列
+   * @return
+   *   パース結果。成功時はEmailAddress、失敗時はEmailAddressError
+   */
+  def parseFromString(value: String): Either[EmailAddressError, EmailAddress] =
+    if (value.isEmpty) {
+      Left(EmailAddressError.Empty)
+    } else if (value.length > MaxLength) {
+      Left(EmailAddressError.TooLong(value.length))
+    } else if (!EmailRegex.matches(value)) {
+      Left(EmailAddressError.InvalidFormat)
+    } else {
+      Right(EmailAddressImpl(value))
+    }
+
+  private final case class EmailAddressImpl(private val value: String) extends EmailAddress {
+    override def asString: String = value
+  }
+
+}
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/EmailAddressError.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/EmailAddressError.scala
new file mode 100644
index 0000000..d6384ab
--- /dev/null
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/EmailAddressError.scala
@@ -0,0 +1,19 @@
+package io.github.j5ik2o.pcqrses.domain.staff
+
+/**
+ * EmailAddress生成時のバリデーションエラー。
+ *
+ * メールアドレスの形式エラーを型安全に表現し、 不正なアドレスによるシステムエラーを防止する。
+ */
+enum EmailAddressError extends DomainError {
+  case Empty
+  case TooLong(actualLength: Int)
+  case InvalidFormat
+
+  def message: String = this match {
+    case Empty => "Email address cannot be empty"
+    case TooLong(actualLength) =>
+      s"Email address is too long: $actualLength characters (max ${EmailAddress.MaxLength} characters)"
+    case InvalidFormat => "Invalid email format"
+  }
+}
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/FirstName.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/FirstName.scala
new file mode 100644
index 0000000..671b600
--- /dev/null
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/FirstName.scala
@@ -0,0 +1,5 @@
+package io.github.j5ik2o.pcqrses.domain.users
+
+class FirstName {
+
+}
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/FirstNameError.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/FirstNameError.scala
new file mode 100644
index 0000000..08e9c3a
--- /dev/null
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/FirstNameError.scala
@@ -0,0 +1,5 @@
+package io.github.j5ik2o.pcqrses.domain.users
+
+class FirstNameError {
+
+}
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/LastName.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/LastName.scala
new file mode 100644
index 0000000..becc7df
--- /dev/null
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/LastName.scala
@@ -0,0 +1,5 @@
+package io.github.j5ik2o.pcqrses.domain.users
+
+trait LastName {
+
+}
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/LastNameError.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/LastNameError.scala
new file mode 100644
index 0000000..da9d26b
--- /dev/null
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/LastNameError.scala
@@ -0,0 +1,5 @@
+package io.github.j5ik2o.pcqrses.domain.users
+
+class LastNameError {
+
+}
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/RenameError.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/RenameError.scala
new file mode 100644
index 0000000..a2bbd26
--- /dev/null
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/RenameError.scala
@@ -0,0 +1,5 @@
+package io.github.j5ik2o.pcqrses.domain.users
+
+class RenameError {
+
+}
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccount.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccount.scala
new file mode 100644
index 0000000..1d398c2
--- /dev/null
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccount.scala
@@ -0,0 +1,5 @@
+package io.github.j5ik2o.pcqrses.domain.users
+
+class UserAccount {
+
+}
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccountEvent.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccountEvent.scala
new file mode 100644
index 0000000..acae138
--- /dev/null
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccountEvent.scala
@@ -0,0 +1,5 @@
+package io.github.j5ik2o.pcqrses.domain.users
+
+class UserAccountEvent {
+
+}
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccountId.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccountId.scala
new file mode 100644
index 0000000..b2c35d7
--- /dev/null
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccountId.scala
@@ -0,0 +1,5 @@
+package io.github.j5ik2o.pcqrses.domain.users
+
+class UserAccountId {
+
+}
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccountIdError.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccountIdError.scala
new file mode 100644
index 0000000..b8c8252
--- /dev/null
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccountIdError.scala
@@ -0,0 +1,5 @@
+package io.github.j5ik2o.pcqrses.domain.users
+
+class UserAccountIdError {
+
+}
diff --git a/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccountName.scala b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccountName.scala
new file mode 100644
index 0000000..cfb4911
--- /dev/null
+++ b/modules/command/domain/src/main/scala/io/github/j5ik2o/pcqrses/domain/users/UserAccountName.scala
@@ -0,0 +1,5 @@
+package io.github.j5ik2o.pcqrses.domain.users
+
+class UserAccountName {
+
+}
diff --git a/modules/command/interface-adapter-contract/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/contract/users/UserAccountProtocol.scala b/modules/command/interface-adapter-contract/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/contract/users/UserAccountProtocol.scala
new file mode 100644
index 0000000..129d049
--- /dev/null
+++ b/modules/command/interface-adapter-contract/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/contract/users/UserAccountProtocol.scala
@@ -0,0 +1,5 @@
+package io.github.j5ik2o.pcqrses.interfaceAdapter.contract.users
+
+object UserAccountProcotol {
+
+}
diff --git a/modules/command/interface-adapter/src/main/protobuf/users/basic.proto b/modules/command/interface-adapter/src/main/protobuf/users/basic.proto
new file mode 100644
index 0000000..e69de29
diff --git a/modules/command/interface-adapter/src/main/protobuf/users/snapshot.proto b/modules/command/interface-adapter/src/main/protobuf/users/snapshot.proto
new file mode 100644
index 0000000..e69de29
diff --git a/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountAggregate.scala b/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountAggregate.scala
new file mode 100644
index 0000000..8d0b2ed
--- /dev/null
+++ b/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountAggregate.scala
@@ -0,0 +1,5 @@
+package io.github.j5ik2o.pcqrses.interfaceAdapter.users
+
+class UserAccountAggregate {
+
+}
diff --git a/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountAggregateState.scala b/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountAggregateState.scala
new file mode 100644
index 0000000..a2dc621
--- /dev/null
+++ b/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountAggregateState.scala
@@ -0,0 +1,5 @@
+package io.github.j5ik2o.pcqrses.interfaceAdapter.users
+
+class UserAccountAggregateState {
+
+}
diff --git a/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountSnapshotSerializer.scala b/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountSnapshotSerializer.scala
new file mode 100644
index 0000000..6717c83
--- /dev/null
+++ b/modules/command/interface-adapter/src/main/scala/io/github/j5ik2o/pcqrses/interfaceAdapter/users/UserAccountSnapshotSerializer.scala
@@ -0,0 +1,5 @@
+package io.github.j5ik2o.pcqrses.interfaceAdapter.users
+
+class UserAccountSnapshotSerializer {
+
+}
diff --git a/scripts/cleanup-lambda-localstack.sh b/scripts/cleanup-lambda-localstack.sh
new file mode 100755
index 0000000..881c5f9
--- /dev/null
+++ b/scripts/cleanup-lambda-localstack.sh
@@ -0,0 +1,44 @@
+#!/bin/bash
+
+# LocalStack Lambda クリーンアップスクリプト
+# read-model-updater Lambda関数とイベントソースマッピングを削除します
+
+set -e
+
+# 環境変数の設定
+export AWS_ACCESS_KEY_ID=dummy
+export AWS_SECRET_ACCESS_KEY=dummy
+export AWS_DEFAULT_REGION=ap-northeast-1
+export ENDPOINT_URL=http://localhost:4566
+
+# Lambda関数名
+FUNCTION_NAME="pcqrses-read-model-updater"
+
+echo "🧹 LocalStack Lambda クリーンアップを開始します..."
+
+# イベントソースマッピングを削除
+echo "🔗 イベントソースマッピングを削除中..."
+aws lambda list-event-source-mappings \
+    --endpoint-url $ENDPOINT_URL \
+    --function-name $FUNCTION_NAME \
+    --query 'EventSourceMappings[].UUID' \
+    --output text | while read uuid; do
+    if [ -n "$uuid" ] && [ "$uuid" != "None" ]; then
+        echo "🗑️  イベントソースマッピング $uuid を削除中..."
+        aws lambda delete-event-source-mapping \
+            --endpoint-url $ENDPOINT_URL \
+            --uuid $uuid
+    fi
+done
+
+# Lambda関数を削除
+echo "🗑️  Lambda関数 $FUNCTION_NAME を削除中..."
+aws lambda delete-function \
+    --endpoint-url $ENDPOINT_URL \
+    --function-name $FUNCTION_NAME \
+    2>/dev/null \
+    && echo "✅ Lambda関数を削除しました" \
+    || echo "⚠️  Lambda関数が見つかりませんでした（既に削除済みの可能性があります）"
+
+echo ""
+echo "✅ クリーンアップが完了しました!"
\ No newline at end of file
diff --git a/scripts/common.sh b/scripts/common.sh
new file mode 100644
index 0000000..faf3575
--- /dev/null
+++ b/scripts/common.sh
@@ -0,0 +1,122 @@
+#!/bin/bash
+
+# Common helper functions for run scripts
+
+# Wait for an HTTP endpoint to return content matching a pattern
+# Usage: wait_for_http "Name" "http://host:port/path" "Pattern" [timeoutSeconds]
+wait_for_http() {
+  local name="$1"; local url="$2"; local pattern="$3"; local timeout="${4:-20}"
+  local waited=0
+  echo "  ⏳ Waiting for ${name}..."
+  while [ $waited -lt $timeout ]; do
+    if curl -s "$url" | grep -q "$pattern"; then
+      echo "  ✅ ${name} is ready"
+      return 0
+    fi
+    sleep 2
+    waited=$((waited+2))
+  done
+  echo "  ⚠️  ${name} is not responding yet"
+  return 1
+}
+
+# Check if Lambda function exists and is active in LocalStack
+# Usage: check_lambda_status "function-name" [endpoint-url] [max-retries]
+check_lambda_status() {
+  local function_name="$1"
+  local endpoint="${2:-http://localhost:${DOCKER_LOCALSTACK_PORT:-50503}}"
+  local max_retries="${3:-3}"
+  
+  echo "  🔍 Checking Lambda function: ${function_name}..."
+  
+  # LocalStack用のAWS認証情報を設定
+  export AWS_REGION=ap-northeast-1
+  export AWS_ACCESS_KEY_ID=dummy
+  export AWS_SECRET_ACCESS_KEY=dummy
+  
+  # リトライロジック
+  local retry_count=0
+  local found=false
+  
+  while [ $retry_count -lt $max_retries ]; do
+    # Lambda関数リストを取得
+    local all_functions=$(aws lambda list-functions \
+      --endpoint-url "$endpoint" \
+      --query 'Functions[*].FunctionName' \
+      --output text 2>/dev/null)
+    
+    if [ -n "$all_functions" ]; then
+      # 関数が見つかった場合
+      if echo "$all_functions" | grep -q "$function_name"; then
+        found=true
+        break
+      fi
+    fi
+    
+    # リトライが必要な場合
+    retry_count=$((retry_count + 1))
+    if [ $retry_count -lt $max_retries ]; then
+      echo "  ⏳ Waiting for Lambda to register... (attempt $retry_count/$max_retries)"
+      sleep 3
+    fi
+  done
+  
+  if [ "$found" = false ]; then
+    # 最終的に見つからなかった場合
+    if [ -z "$all_functions" ]; then
+      echo "  ⚠️  No Lambda functions found in LocalStack after $max_retries attempts"
+      echo "  💡 Hint: Lambda deployment may have failed or LocalStack is not ready"
+    else
+      echo "  ⚠️  Lambda function '${function_name}' not found after $max_retries attempts"
+      echo "  📋 Available functions: ${all_functions}"
+      echo "  💡 Try deploying with: ./scripts/deploy-lambda-localstack.sh"
+    fi
+    return 1
+  fi
+  
+  # Lambda関数の状態確認
+  local state=$(aws lambda get-function \
+    --endpoint-url "$endpoint" \
+    --function-name "$function_name" \
+    --query 'Configuration.State' \
+    --output text 2>/dev/null)
+  
+  if [ "$state" = "Active" ]; then
+    echo "  ✅ Lambda function is Active"
+    
+    # イベントソースマッピングの確認
+    local mappings=$(aws lambda list-event-source-mappings \
+      --endpoint-url "$endpoint" \
+      --function-name "$function_name" \
+      --query 'EventSourceMappings[*].State' \
+      --output text 2>/dev/null)
+    
+    if [ -n "$mappings" ]; then
+      echo "  📎 Event source mappings: ${mappings}"
+    else
+      echo "  ⚠️  No event source mappings found"
+    fi
+    
+    return 0
+  else
+    echo "  ⏳ Lambda function state: ${state}"
+    return 1
+  fi
+}
+
+# Check Lambda function logs in LocalStack
+# Usage: check_lambda_logs "function-name" [endpoint-url] [tail-lines]
+check_lambda_logs() {
+  local function_name="$1"
+  local endpoint="${2:-http://localhost:${DOCKER_LOCALSTACK_PORT:-50503}}"
+  local tail_lines="${3:-10}"
+  
+  echo "  📋 Recent Lambda logs (last ${tail_lines} lines):"
+  
+  # LocalStackのコンテナログから Lambda関数のログを抽出
+  docker logs localstack 2>&1 | grep -A2 "$function_name" | tail -n "$tail_lines" || {
+    echo "  ⚠️  No recent logs found for ${function_name}"
+    return 1
+  }
+}
+
diff --git a/scripts/deploy-lambda-localstack.sh b/scripts/deploy-lambda-localstack.sh
new file mode 100755
index 0000000..bfd617a
--- /dev/null
+++ b/scripts/deploy-lambda-localstack.sh
@@ -0,0 +1,311 @@
+#!/bin/bash
+
+# LocalStack Lambda デプロイスクリプト
+# read-model-updater を LocalStack Lambda にデプロイします
+
+set -e
+
+# 強制再作成オプションの確認
+FORCE_RECREATE=false
+if [ "$1" = "--force" ] || [ "$1" = "-f" ]; then
+    FORCE_RECREATE=true
+    echo "⚠️  強制再作成モードが有効です"
+fi
+
+# 環境変数の設定
+export AWS_ACCESS_KEY_ID=dummy
+export AWS_SECRET_ACCESS_KEY=dummy
+export AWS_DEFAULT_REGION=ap-northeast-1
+export PORT=50503
+export HOST=localhost
+export ENDPOINT_URL=http://${HOST}:${PORT}
+
+# Lambda関数名
+FUNCTION_NAME="pcqrses-read-model-updater"
+
+# DynamoDB テーブル名とストリームARN
+TABLE_NAME="Journal"
+
+# アーキテクチャの自動検出
+if [ "$(uname -m)" = "arm64" ] || [ "$(uname -m)" = "aarch64" ]; then
+    LAMBDA_ARCH="arm64"
+    echo "🔧 検出されたアーキテクチャ: ARM64"
+else
+    LAMBDA_ARCH="x86_64"
+    echo "🔧 検出されたアーキテクチャ: x86_64"
+fi
+
+# 環境変数でオーバーライド可能
+if [ -n "${LAMBDA_ARCHITECTURE}" ]; then
+    LAMBDA_ARCH="${LAMBDA_ARCHITECTURE}"
+    echo "⚙️  環境変数によるアーキテクチャ指定: ${LAMBDA_ARCH}"
+fi
+
+echo "🚀 LocalStack Lambda デプロイを開始します..."
+
+# プロジェクトルートに移動
+cd "$(dirname "$0")/.."
+
+echo "📦 read-model-updater をビルド中..."
+# sbt assembly で fat JAR を作成（バッチモードで実行、ページャーを無効化）
+export PAGER=cat
+sbt --batch "project readModelUpdater" assembly
+
+# Assembly JARのパス
+ASSEMBLY_JAR_PATH="apps/read-model-updater/target/scala-3.6.2/read-model-updater-lambda.jar"
+
+# Assembly JARが存在することを確認
+if [ ! -f "$ASSEMBLY_JAR_PATH" ]; then
+    echo "❌ エラー: Assembly JAR が見つかりません: $ASSEMBLY_JAR_PATH"
+    exit 1
+fi
+
+echo "✅ Assembly JAR が作成されました: $ASSEMBLY_JAR_PATH"
+
+# DynamoDB ストリーム ARN を取得
+echo "🔍 DynamoDB ストリーム ARN を取得中..."
+STREAM_ARN=$(aws dynamodb describe-table \
+    --endpoint-url $ENDPOINT_URL \
+    --table-name $TABLE_NAME \
+    --query 'Table.LatestStreamArn' \
+    --output text)
+
+if [ "$STREAM_ARN" = "None" ] || [ -z "$STREAM_ARN" ]; then
+    echo "❌ エラー: DynamoDB テーブル '$TABLE_NAME' のストリームが見つかりません"
+    echo "   テーブルにストリームが有効化されていることを確認してください"
+    exit 1
+fi
+
+echo "✅ ストリーム ARN: $STREAM_ARN"
+
+# LambdaのActive化を待機する関数（最大60秒）
+wait_for_lambda_active() {
+  local fn_name="$1"
+  local timeout=60
+  local waited=0
+  echo "⏳ Lambda関数のActive化を待機中... ($fn_name)"
+  while true; do
+    state=$(aws lambda get-function \
+      --endpoint-url $ENDPOINT_URL \
+      --function-name "$fn_name" \
+      --query 'Configuration.State' \
+      --output text 2>/dev/null || echo "")
+    if [ "$state" = "Active" ]; then
+      echo "✅ Lambda関数がActiveになりました: $fn_name"
+      break
+    fi
+    if [ "$state" = "Failed" ]; then
+      echo "❌ Lambda関数がFailed状態です: $fn_name"
+      exit 1
+    fi
+    sleep 2
+    waited=$((waited+2))
+    if [ $waited -ge $timeout ]; then
+      echo "⚠️  タイムアウト: Lambda関数がActiveになりませんでした ($fn_name, state=$state)"
+      break
+    fi
+  done
+}
+
+# Lambda関数の存在確認
+echo "🔧 Lambda関数の存在確認中..."
+if aws lambda get-function \
+    --endpoint-url $ENDPOINT_URL \
+    --function-name $FUNCTION_NAME \
+    --query 'Configuration.FunctionName' \
+    --output text 2>/dev/null; then
+    FUNCTION_EXISTS="true"
+else
+    FUNCTION_EXISTS="false"
+fi
+
+# 環境変数をファイルに書き出し
+ENV_JSON_FILE="/tmp/lambda-env.json"
+cat > $ENV_JSON_FILE << 'EOF'
+{
+  "Variables": {
+    "DATABASE_URL": "jdbc:postgresql://postgres:5432/pcqrses_development",
+    "DATABASE_USER": "postgres",
+    "DATABASE_PASSWORD": "postgres",
+    "AWS_DEFAULT_REGION": "ap-northeast-1",
+    "DYNAMODB_ENDPOINT_URI": "http://localstack:4566",
+    "KINESIS_ENDPOINT_URI": "http://localstack:4566",
+    "CLOUDWATCH_ENDPOINT_URI": "http://localstack:4566"
+  }
+}
+EOF
+
+if [ "$FUNCTION_EXISTS" = "true" ]; then
+    if [ "$FORCE_RECREATE" = "true" ]; then
+        echo "🗑️  既存のLambda関数を削除中..."
+        aws lambda delete-function \
+            --endpoint-url $ENDPOINT_URL \
+            --function-name $FUNCTION_NAME
+
+        echo "🆕 新しいLambda関数を作成中..."
+        aws lambda create-function \
+            --endpoint-url $ENDPOINT_URL \
+            --function-name $FUNCTION_NAME \
+            --runtime java17 \
+            --handler io.github.j5ik2o.pcqrses.readmodelupdater.LambdaHandler \
+            --role arn:aws:iam::000000000000:role/lambda-role \
+            --zip-file fileb://$ASSEMBLY_JAR_PATH \
+            --timeout 300 \
+            --memory-size 512 \
+            --architectures $LAMBDA_ARCH \
+            --environment file://$ENV_JSON_FILE
+        # Active化を待機
+        wait_for_lambda_active "$FUNCTION_NAME"
+    else
+        echo "🔄 既存のLambda関数を更新中..."
+        # 関数の設定を更新
+        aws lambda update-function-configuration \
+            --endpoint-url $ENDPOINT_URL \
+            --function-name $FUNCTION_NAME \
+            --runtime java17 \
+            --handler io.github.j5ik2o.pcqrses.readmodelupdater.LambdaHandler \
+            --timeout 300 \
+            --memory-size 512 \
+            --environment file://$ENV_JSON_FILE
+
+        # 設定の更新を待つ
+        sleep 2
+
+        # 関数のコードを更新
+        aws lambda update-function-code \
+            --endpoint-url $ENDPOINT_URL \
+            --function-name $FUNCTION_NAME \
+            --zip-file fileb://$ASSEMBLY_JAR_PATH
+        # Active化を待機
+        wait_for_lambda_active "$FUNCTION_NAME"
+    fi
+else
+    echo "🆕 新しいLambda関数を作成中..."
+    aws lambda create-function \
+        --endpoint-url $ENDPOINT_URL \
+        --function-name $FUNCTION_NAME \
+        --runtime java17 \
+        --handler io.github.j5ik2o.pcqrses.readmodelupdater.LambdaHandler \
+        --role arn:aws:iam::000000000000:role/lambda-role \
+        --zip-file fileb://$ASSEMBLY_JAR_PATH \
+        --timeout 300 \
+        --memory-size 512 \
+        --architectures $LAMBDA_ARCH \
+        --environment file://$ENV_JSON_FILE
+    # Active化を待機
+    wait_for_lambda_active "$FUNCTION_NAME"
+fi
+
+# 一時ファイルを削除
+rm $ENV_JSON_FILE
+
+# DynamoDB ストリームのイベントソースマッピングを作成
+echo "🔗 DynamoDB ストリームのイベントソースマッピングを作成中..."
+
+# 既存のイベントソースマッピングを確認して削除
+echo "📋 既存のイベントソースマッピングを確認中..."
+EXISTING_UUIDS=$(aws lambda list-event-source-mappings \
+    --endpoint-url $ENDPOINT_URL \
+    --function-name $FUNCTION_NAME \
+    --query 'EventSourceMappings[?EventSourceArn==`'$STREAM_ARN'`].UUID' \
+    --output text 2>/dev/null)
+
+MAPPING_DELETED=false
+if [ -n "$EXISTING_UUIDS" ] && [ "$EXISTING_UUIDS" != "None" ]; then
+    for uuid in $EXISTING_UUIDS; do
+        echo "🗑️  既存のイベントソースマッピング $uuid を削除中..."
+        # 削除コマンドを実行（出力を表示してエラーを確認）
+        if aws lambda delete-event-source-mapping \
+            --endpoint-url $ENDPOINT_URL \
+            --uuid $uuid 2>&1 | grep -v "ResourceNotFoundException"; then
+            echo "   ✓ 削除リクエスト送信完了: $uuid"
+            MAPPING_DELETED=true
+        fi
+    done
+
+    # 削除処理が完了するまで待機
+    if [ "$MAPPING_DELETED" = "true" ]; then
+        echo "⏳ イベントソースマッピングの削除完了を待機中..."
+
+        # 削除が完了したか確認（最大30秒待機）
+        RETRIES=0
+        while [ $RETRIES -lt 15 ]; do
+            sleep 2
+
+            # 該当するストリームARNのマッピングが存在するか確認
+            ALL_MAPPINGS=$(aws lambda list-event-source-mappings \
+                --endpoint-url $ENDPOINT_URL \
+                --function-name $FUNCTION_NAME \
+                --query 'EventSourceMappings[?EventSourceArn==`'$STREAM_ARN'`].[UUID, State]' \
+                --output text 2>/dev/null)
+
+            if [ -z "$ALL_MAPPINGS" ] || [ "$ALL_MAPPINGS" = "None" ]; then
+                echo "✅ 既存のマッピングが削除されました"
+                break
+            fi
+
+            # まだ存在する場合は状態を表示
+            echo "   待機中... ($((RETRIES+1))/15) - 状態: $ALL_MAPPINGS"
+            RETRIES=$((RETRIES+1))
+        done
+
+        # タイムアウト時の処理
+        if [ $RETRIES -eq 15 ]; then
+            echo "⚠️  警告: マッピング削除のタイムアウト"
+            echo "   強制的に再試行します..."
+
+            # 残っているマッピングを強制削除
+            REMAINING_UUIDS=$(aws lambda list-event-source-mappings \
+                --endpoint-url $ENDPOINT_URL \
+                --function-name $FUNCTION_NAME \
+                --query 'EventSourceMappings[?EventSourceArn==`'$STREAM_ARN'`].UUID' \
+                --output text 2>/dev/null)
+
+            if [ -n "$REMAINING_UUIDS" ] && [ "$REMAINING_UUIDS" != "None" ]; then
+                for uuid in $REMAINING_UUIDS; do
+                    echo "   🔄 強制削除: $uuid"
+                    aws lambda delete-event-source-mapping \
+                        --endpoint-url $ENDPOINT_URL \
+                        --uuid $uuid --force 2>/dev/null || true
+                done
+                sleep 5
+            fi
+        fi
+    fi
+else
+    echo "✅ 既存のイベントソースマッピングなし"
+fi
+
+# 新しいイベントソースマッピングを作成（LambdaがActiveであることを前提）
+echo "📝 新しいイベントソースマッピングを作成中..."
+aws lambda create-event-source-mapping \
+    --endpoint-url $ENDPOINT_URL \
+    --function-name $FUNCTION_NAME \
+    --event-source-arn $STREAM_ARN \
+    --starting-position LATEST \
+    --batch-size 10 \
+    --maximum-batching-window-in-seconds 5
+
+# Assembly JARはそのまま残す（デバッグ用に保持）
+echo "🧹 デプロイメント完了"
+
+echo ""
+echo "✅ Lambda関数のデプロイが完了しました!"
+echo "   関数名: $FUNCTION_NAME"
+echo "   ハンドラー: io.github.j5ik2o.pcqrses.readmodelupdater.LambdaHandler"
+echo "   ストリーム ARN: $STREAM_ARN"
+echo ""
+echo "📋 確認用コマンド:"
+echo "   aws lambda list-functions --endpoint-url $ENDPOINT_URL --query 'Functions[?FunctionName==\`$FUNCTION_NAME\`]'"
+echo "   aws lambda list-event-source-mappings --endpoint-url $ENDPOINT_URL --function-name $FUNCTION_NAME"
+echo ""
+echo "🧪 テスト用コマンド:"
+echo "   aws lambda invoke --endpoint-url $ENDPOINT_URL --function-name $FUNCTION_NAME --payload '{}' response.json"
+echo ""
+
+# 最終確認: 実際にデプロイされた関数を表示
+echo "🔍 最終確認: デプロイされたLambda関数"
+aws lambda list-functions \
+  --endpoint-url $ENDPOINT_URL \
+  --query "Functions[?FunctionName=='$FUNCTION_NAME'].{Name:FunctionName,State:State,Runtime:Runtime}" \
+  --output table 2>/dev/null || echo "  ⚠️  関数の確認に失敗しました"
diff --git a/scripts/lib/common.sh b/scripts/lib/common.sh
new file mode 100644
index 0000000..6a15148
--- /dev/null
+++ b/scripts/lib/common.sh
@@ -0,0 +1,134 @@
+#!/bin/bash
+
+# ===== 共通ライブラリ =====
+# Dockerビルドスクリプトで使用する共通関数と変数
+
+# 色付き出力用の定義
+export RED='\033[0;31m'
+export GREEN='\033[0;32m'
+export YELLOW='\033[1;33m'
+export BLUE='\033[0;34m'
+export NC='\033[0m' # No Color
+
+# 印刷関数
+print_header() {
+    echo -e "\n${BLUE}=== $1 ===${NC}"
+}
+
+print_success() {
+    echo -e "${GREEN}✓ $1${NC}"
+}
+
+print_error() {
+    echo -e "${RED}✗ $1${NC}"
+}
+
+print_info() {
+    echo -e "${YELLOW}ℹ $1${NC}"
+}
+
+print_warning() {
+    echo -e "${YELLOW}⚠ $1${NC}"
+}
+
+# エラーハンドリング
+check_command() {
+    local cmd=$1
+    local install_msg=$2
+    
+    if ! command -v "$cmd" &> /dev/null; then
+        print_error "エラー: $cmd が見つかりません"
+        [ -n "$install_msg" ] && echo "$install_msg"
+        exit 1
+    fi
+}
+
+# プロジェクトルートへの移動
+goto_project_root() {
+    # スクリプトから2階層上（scripts/lib -> プロジェクトルート）
+    cd "$(dirname "${BASH_SOURCE[1]}")/.." || exit 1
+}
+
+# sbtビルド実行
+run_sbt_build() {
+    local task=$1
+    local description=$2
+    
+    print_info "$description"
+    echo "これには数分かかる場合があります..."
+    
+    if sbt "$task"; then
+        print_success "$description が完了しました"
+        return 0
+    else
+        print_error "$description に失敗しました"
+        return 1
+    fi
+}
+
+# Dockerイメージの確認と表示
+show_docker_images() {
+    local image_patterns=("$@")
+    local grep_pattern="REPOSITORY"
+    
+    for pattern in "${image_patterns[@]}"; do
+        grep_pattern="$grep_pattern|$pattern"
+    done
+    
+    echo ""
+    echo "作成されたイメージ:"
+    docker images | grep -E "$grep_pattern" | head -$(( ${#image_patterns[@]} + 1 ))
+}
+
+# 共通ヘルプメッセージ
+show_common_help() {
+    local script_name=$1
+    local additional_help=$2
+    
+    echo "使用方法: $script_name [オプション]"
+    echo ""
+    echo "オプション:"
+    echo "  -c, --clean    クリーンビルド（sbt cleanを先に実行）"
+    echo "  -h, --help     このヘルプを表示"
+    
+    if [ -n "$additional_help" ]; then
+        echo ""
+        echo "$additional_help"
+    fi
+    
+    echo ""
+    echo "例:"
+    echo "  $script_name              # 通常のビルド"
+    echo "  $script_name --clean      # クリーンビルド"
+}
+
+# オプション解析
+parse_docker_build_options() {
+    CLEAN_BUILD=false
+    
+    while [[ $# -gt 0 ]]; do
+        case $1 in
+            -c|--clean)
+                CLEAN_BUILD=true
+                shift
+                ;;
+            -h|--help)
+                return 1  # ヘルプを表示するために1を返す
+                ;;
+            *)
+                print_error "エラー: 不明なオプション '$1'"
+                return 1
+                ;;
+        esac
+    done
+    
+    return 0
+}
+
+# クリーンビルドの実行
+perform_clean_if_needed() {
+    if [ "$CLEAN_BUILD" = true ]; then
+        print_info "プロジェクトをクリーンしています..."
+        sbt clean
+    fi
+}
\ No newline at end of file
diff --git a/scripts/run-cluster.sh b/scripts/run-cluster.sh
new file mode 100755
index 0000000..da93944
--- /dev/null
+++ b/scripts/run-cluster.sh
@@ -0,0 +1,218 @@
+#!/bin/bash
+# ========================================
+# クラスターモード起動スクリプト（3ノード）
+# ========================================
+# 使い方:
+#   ./run-cluster.sh [up]   # クラスターを起動（デフォルト）
+#   ./run-cluster.sh down   # クラスターを停止
+#   ./run-cluster.sh logs   # サービスのログを表示
+#   ./run-cluster.sh -h     # ヘルプ表示
+
+set -e
+
+# 共通関数の読み込み
+SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
+. "$SCRIPT_DIR/run-common.sh"
+
+# ========================================
+# クラスター用環境変数設定
+# ========================================
+setup_cluster_environment() {
+    # 基本環境変数設定
+    setup_environment
+    
+    # クラスターノード設定
+    export CLUSTER_NODE1_API_PORT="${CLUSTER_NODE1_API_PORT:-50501}"
+    export CLUSTER_NODE1_MANAGEMENT_PORT="${CLUSTER_NODE1_MANAGEMENT_PORT:-8558}"
+    export CLUSTER_NODE1_REMOTE_PORT="${CLUSTER_NODE1_REMOTE_PORT:-2551}"
+    
+    export CLUSTER_NODE2_API_PORT="${CLUSTER_NODE2_API_PORT:-50511}"
+    export CLUSTER_NODE2_MANAGEMENT_PORT="${CLUSTER_NODE2_MANAGEMENT_PORT:-8559}"
+    export CLUSTER_NODE2_REMOTE_PORT="${CLUSTER_NODE2_REMOTE_PORT:-2552}"
+    
+    export CLUSTER_NODE3_API_PORT="${CLUSTER_NODE3_API_PORT:-50521}"
+    export CLUSTER_NODE3_MANAGEMENT_PORT="${CLUSTER_NODE3_MANAGEMENT_PORT:-8560}"
+    export CLUSTER_NODE3_REMOTE_PORT="${CLUSTER_NODE3_REMOTE_PORT:-2553}"
+}
+
+# ========================================
+# ヘルプ表示
+# ========================================
+show_help() {
+    echo "Usage: $0 [COMMAND] [OPTIONS]"
+    echo ""
+    echo "Commands:"
+    echo "  up         Start cluster (default)"
+    echo "  down       Stop and remove containers"
+    echo "  logs       Show service logs"
+    echo ""
+    echo "Options:"
+    echo "  --attach     Run containers in foreground (default: background)"
+    echo "  --no-deploy  Do not auto-deploy LocalStack Lambda"
+    echo "  --deploy     Force auto-deploy (default)"
+    echo "  -h, --help   Show this help message"
+    echo ""
+    echo "Examples:"
+    echo "  $0           # Start cluster in background"
+    echo "  $0 up        # Start cluster in background (default)"
+    echo "  $0 up --attach # Start cluster in foreground"
+    echo "  $0 down      # Stop cluster"
+    echo "  $0 logs      # Show cluster logs"
+    echo "  $0 logs -f   # Follow cluster logs"
+    echo ""
+    echo "Environment variables:"
+    echo "  【共通設定】"
+    echo "  DOCKER_LOCALSTACK_PORT (default: 50503)"
+    echo "  DOCKER_DYNAMODB_ADMIN_PORT (default: 50505)"
+    echo "  DOCKER_POSTGRES_PORT (default: 50504)"
+    echo "  DOCKER_QUERY_API_PORT (default: 50502)"
+    echo ""
+    echo "  【クラスター設定】"
+    echo "  CLUSTER_NODE1_API_PORT (default: 50501)"
+    echo "  CLUSTER_NODE1_MANAGEMENT_PORT (default: 8558)"
+    echo "  CLUSTER_NODE2_API_PORT (default: 50511)"
+    echo "  CLUSTER_NODE2_MANAGEMENT_PORT (default: 8559)"
+    echo "  CLUSTER_NODE3_API_PORT (default: 50521)"
+    echo "  CLUSTER_NODE3_MANAGEMENT_PORT (default: 8560)"
+    exit 0
+}
+
+# ========================================
+# クラスターノードのヘルスチェック
+# ========================================
+check_cluster_nodes() {
+    local compose_files="$1"
+    
+    # ノード設定を配列で管理
+    declare -a API_PORTS=("$CLUSTER_NODE1_API_PORT" "$CLUSTER_NODE2_API_PORT" "$CLUSTER_NODE3_API_PORT")
+    declare -a MGMT_PORTS=("$CLUSTER_NODE1_MANAGEMENT_PORT" "$CLUSTER_NODE2_MANAGEMENT_PORT" "$CLUSTER_NODE3_MANAGEMENT_PORT")
+
+    for i in 0 1 2; do
+        node_num=$((i + 1))
+        api_port="${API_PORTS[$i]}"
+        mgmt_port="${MGMT_PORTS[$i]}"
+        
+        echo ""
+        echo "Node $node_num (API: $api_port, Management: $mgmt_port):"
+        
+        # コンテナが実行中か確認
+        if ! docker compose -f docker-compose-common.yml -f docker-compose-cluster.yml ps command-api-${node_num} | grep -q "Up\|running"; then
+            echo "  ❌ Node ${node_num} container is not running!"
+            echo "  📜 Showing recent logs:"
+            docker compose -f docker-compose-common.yml -f docker-compose-cluster.yml logs --tail=50 command-api-${node_num}
+            exit 1
+        fi
+        
+        # HTTPヘルスチェック
+        if ! wait_for_http "Node ${node_num} HTTP" "http://localhost:${api_port}/health" "Healthy" 120; then
+            echo "❌ Node ${node_num} Command API failed to start within 120 seconds"
+            echo "📜 Showing recent logs for node ${node_num}:"
+            docker compose $compose_files logs --tail=50 command-api-${node_num}
+            exit 1
+        fi
+        
+        # Pekko Management確認
+        if ! wait_for_http "Node ${node_num} Cluster" "http://localhost:${mgmt_port}/cluster/members" "Up" 120; then
+            echo "❌ Node ${node_num} Cluster Management failed to start within 120 seconds"
+            echo "📜 Showing recent logs for node ${node_num}:"
+            docker compose $compose_files logs --tail=50 command-api-${node_num}
+            exit 1
+        fi
+    done
+}
+
+# ========================================
+# クラスターアクセスポイント表示
+# ========================================
+show_cluster_access_points() {
+    echo "📍 Access points:"
+    echo "  - Command Node 1: http://localhost:${CLUSTER_NODE1_API_PORT}"
+    echo "    Command Health: http://localhost:${CLUSTER_NODE1_API_PORT}/health"
+    echo "    Command Management: http://localhost:${CLUSTER_NODE1_MANAGEMENT_PORT}"
+    echo ""
+    echo "  - Command Node 2: http://localhost:${CLUSTER_NODE2_API_PORT}"
+    echo "    Command Health: http://localhost:${CLUSTER_NODE2_API_PORT}/health"
+    echo "    Command Management: http://localhost:${CLUSTER_NODE2_MANAGEMENT_PORT}"
+    echo ""
+    echo "  - Command Node 3: http://localhost:${CLUSTER_NODE3_API_PORT}"
+    echo "    Command Health: http://localhost:${CLUSTER_NODE3_API_PORT}/health"
+    echo "    Command Management: http://localhost:${CLUSTER_NODE3_MANAGEMENT_PORT}"
+    echo ""
+    echo "📊 Cluster Management UI:"
+    echo "  - http://localhost:${CLUSTER_NODE1_MANAGEMENT_PORT}/cluster/members"
+    echo ""
+}
+
+# ========================================
+# クラスター起動処理
+# ========================================
+start_cluster_services() {
+    echo "🌐 Starting Command API Cluster (3 nodes)..."
+    echo ""
+
+    prepare_docker_environment "-f docker-compose-common.yml -f docker-compose-cluster.yml"
+
+    # クラスターの起動
+    echo "🚀 Starting cluster nodes..."
+    if [ "$ATTACH_MODE" = true ]; then
+        echo "📎 Running in foreground mode (Ctrl+C to stop)..."
+        docker compose -f docker-compose-common.yml -f docker-compose-cluster.yml up "$@"
+    else
+        docker compose -f docker-compose-common.yml -f docker-compose-cluster.yml up $DETACHED "$@"
+
+        # ヘルスチェック
+        echo "⏳ Waiting for cluster to be ready..."
+        sleep 10
+
+        # 各ノードの状態を確認
+        echo "📊 Checking cluster status..."
+        check_cluster_nodes "-f docker-compose-common.yml -f docker-compose-cluster.yml"
+
+        # Query API の状態確認
+        check_query_api "-f docker-compose-common.yml -f docker-compose-cluster.yml"
+
+        post_startup_tasks "-f docker-compose-common.yml -f docker-compose-cluster.yml"
+
+        # アクセスポイント表示
+        show_cluster_access_points
+        show_common_access_points
+    fi
+}
+
+# ========================================
+# メイン処理
+# ========================================
+main() {
+    # デフォルト設定
+    setup_defaults
+    
+    # 引数処理（--db-onlyはクラスターモードでは無効）
+    DB_ONLY=false
+    parse_arguments "$@"
+    
+    # 環境変数設定
+    setup_cluster_environment
+
+    # ヘルプ表示
+    if [ "$SHOW_HELP" = true ]; then
+        show_help
+    fi
+
+    # コマンド処理
+    case "$COMMAND" in
+        down)
+            handle_down_command dummy -f docker-compose-common.yml -f docker-compose-cluster.yml
+            ;;
+
+        logs)
+            handle_logs_command dummy -f docker-compose-common.yml -f docker-compose-cluster.yml
+            ;;
+
+        up)
+            start_cluster_services
+            ;;
+    esac
+}
+
+# スクリプト実行
+main "$@"
\ No newline at end of file
diff --git a/scripts/run-common.sh b/scripts/run-common.sh
new file mode 100755
index 0000000..ed05547
--- /dev/null
+++ b/scripts/run-common.sh
@@ -0,0 +1,299 @@
+#!/bin/bash
+# ========================================
+# 共通起動スクリプト関数
+# ========================================
+# run-single.sh と run-cluster.sh で共通利用される関数群
+
+# 共通関数の読み込み
+SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
+. "$SCRIPT_DIR/common.sh"
+
+# ========================================
+# デフォルト設定
+# ========================================
+setup_defaults() {
+    COMMAND="${COMMAND:-up}"
+    DB_ONLY="${DB_ONLY:-false}"
+    SHOW_HELP="${SHOW_HELP:-false}"
+    DETACHED="${DETACHED:--d}"
+    ATTACH_MODE="${ATTACH_MODE:-false}"
+    AUTO_DEPLOY="${AUTO_DEPLOY:-true}"
+}
+
+# ========================================
+# 環境変数設定
+# ========================================
+setup_environment() {
+    export DOCKER_COMMAND_API_PORT="${DOCKER_COMMAND_API_PORT:-50501}"
+    export DOCKER_QUERY_API_PORT="${DOCKER_QUERY_API_PORT:-50502}"
+    export DOCKER_POSTGRES_PORT="${DOCKER_POSTGRES_PORT:-50504}"
+    export DOCKER_LOCALSTACK_PORT="${DOCKER_LOCALSTACK_PORT:-50503}"
+    export DOCKER_DYNAMODB_ADMIN_PORT="${DOCKER_DYNAMODB_ADMIN_PORT:-50505}"
+    export DOCKER_PGADMIN_PORT="${DOCKER_PGADMIN_PORT:-50506}"
+}
+
+# ========================================
+# 引数処理
+# ========================================
+parse_arguments() {
+    # 第一引数がコマンドの場合は取得
+    if [[ "$1" =~ ^(up|down|logs)$ ]]; then
+        COMMAND=$1
+        shift
+    fi
+
+    # その他の引数処理
+    while [[ "$#" -gt 0 ]]; do
+        case $1 in
+            --attach) DETACHED=""; ATTACH_MODE=true; shift ;;
+            --db-only) DB_ONLY=true; shift ;;
+            --no-deploy) AUTO_DEPLOY=false; shift ;;
+            --deploy) AUTO_DEPLOY=true; shift ;;
+            -h|--help) SHOW_HELP=true; shift ;;
+            *)
+                # logsコマンドの場合は追加の引数を許可
+                if [ "$COMMAND" = "logs" ]; then
+                    break
+                else
+                    echo "Unknown option: $1"
+                    exit 1
+                fi
+                ;;
+        esac
+    done
+}
+
+# ========================================
+# downコマンド処理
+# ========================================
+handle_down_command() {
+    echo "🛑 Stopping services..."
+    shift  # 最初の引数（compose_files）を除去
+    docker compose "$@" down
+    echo "✅ Services stopped"
+    exit 0
+}
+
+# ========================================
+# logsコマンド処理
+# ========================================
+handle_logs_command() {
+    echo "📜 Showing service logs..."
+    shift  # 最初の引数（compose_files）を除去
+    docker compose "$@" logs
+    exit 0
+}
+
+# ========================================
+# DB_ONLYモード実行
+# ========================================
+run_db_only_mode() {
+    echo "🗄️  Starting Database Services Only..."
+    echo "   (DBs run in Docker, APIs will be started separately)"
+    echo ""
+
+    # 既存のコンテナを停止・削除
+    echo "🧹 Cleaning up existing containers..."
+    docker compose -f docker-compose-common.yml down
+
+    # データベースサービスのみ起動
+    echo "🚀 Starting database services..."
+    if [ "$ATTACH_MODE" = true ]; then
+        echo "📎 Running in foreground mode (Ctrl+C to stop)..."
+        docker compose -f docker-compose-common.yml up "$@" localstack dynamodb-setup dynamodb-admin postgres flyway
+    else
+        docker compose -f docker-compose-common.yml up $DETACHED "$@" localstack dynamodb-setup dynamodb-admin postgres flyway
+
+        echo "⏳ Waiting for services to be ready..."
+        sleep 10
+
+        # サービスの状態確認
+        check_db_services
+
+        echo ""
+        echo "🎉 Database services are running!"
+        echo ""
+        show_manual_start_instructions
+
+        # Lambda自動デプロイ
+        deploy_lambda_if_enabled
+
+        echo ""
+        echo "🛑 To stop databases: $0 down"
+        echo ""
+        show_db_only_access_points
+    fi
+}
+
+# ========================================
+# データベースサービスの状態確認
+# ========================================
+check_db_services() {
+    echo "📊 Checking services status..."
+
+    # LocalStackの確認
+    if curl -s "http://localhost:${DOCKER_LOCALSTACK_PORT}/_localstack/health" | grep -q "running"; then
+        echo "  ✅ LocalStack is running"
+    else
+        echo "  ❌ LocalStack is not responding"
+    fi
+
+    # PostgreSQLの確認
+    if pg_isready -h localhost -p ${DOCKER_POSTGRES_PORT} > /dev/null 2>&1; then
+        echo "  ✅ PostgreSQL is ready"
+    else
+        echo "  ⚠️  PostgreSQL is not responding"
+    fi
+
+    # DynamoDB Adminの確認
+    if curl -s "http://localhost:${DOCKER_DYNAMODB_ADMIN_PORT}" > /dev/null 2>&1; then
+        echo "  ✅ DynamoDB Admin UI is available"
+    else
+        echo "  ⚠️  DynamoDB Admin UI is not responding"
+    fi
+}
+
+# ========================================
+# 手動起動手順の表示
+# ========================================
+show_manual_start_instructions() {
+    echo "🔧 To start APIs manually:"
+    echo "  1. Command API:"
+    echo "     - From IntelliJ: Run 'io.github.j5ik2o.pcqrses.commandapi.Main'"
+    echo "     - From sbt: sbt \"commandApi/run\""
+    echo "  2. Query API:"
+    echo "     - From IntelliJ: Run 'io.github.j5ik2o.pcqrses.queryapi.Main'"
+    echo "     - From sbt: sbt \"queryApi/run\""
+    echo ""
+    echo "💡 Debug configuration for IntelliJ:"
+    echo "  - Set these environment variables:"
+    echo "    J5IK2O_DYNAMO_DB_JOURNAL_DYNAMO_DB_CLIENT_ENDPOINT=http://localhost:${DOCKER_LOCALSTACK_PORT}"
+    echo "    J5IK2O_DYNAMO_DB_SNAPSHOT_DYNAMO_DB_CLIENT_ENDPOINT=http://localhost:${DOCKER_LOCALSTACK_PORT}"
+    echo "    J5IK2O_DYNAMO_DB_STATE_DYNAMO_DB_CLIENT_ENDPOINT=http://localhost:${DOCKER_LOCALSTACK_PORT}"
+    echo "    AWS_REGION=ap-northeast-1"
+    echo "    AWS_ACCESS_KEY_ID=dummy"
+    echo "    AWS_SECRET_ACCESS_KEY=dummy"
+    echo "    PEKKO_CLUSTER_ENABLED=false"
+}
+
+# ========================================
+# Lambda デプロイ処理
+# ========================================
+deploy_lambda_if_enabled() {
+    if [ "$AUTO_DEPLOY" = true ]; then
+        echo ""
+        echo "🪄 Deploying Lambda to LocalStack..."
+        export PORT="$DOCKER_LOCALSTACK_PORT"
+        tries=0; max_tries=10
+        until ./scripts/deploy-lambda-localstack.sh; do
+            tries=$((tries+1))
+            if [ $tries -ge $max_tries ]; then
+                echo "❌ Lambda deploy failed after ${max_tries} attempts" >&2
+                break
+            fi
+            echo "⏳ Retry deploy in 3s... ($tries/$max_tries)"
+            sleep 3
+        done
+        
+        # Lambda関数の状態確認
+        echo ""
+        echo "⏳ Waiting for Lambda to be fully registered..."
+        sleep 5
+        echo "📊 Checking Lambda function status..."
+        if ! check_lambda_status "pcqrses-read-model-updater" "http://localhost:${DOCKER_LOCALSTACK_PORT}"; then
+            echo "⚠️  Lambda function may not be ready yet, but continuing..."
+        fi
+    else
+        echo "ℹ️  Skipping Lambda auto-deploy (--no-deploy)"
+    fi
+}
+
+# ========================================
+# DB_ONLYモードのアクセスポイント表示
+# ========================================
+show_db_only_access_points() {
+    echo "📍 Access points:"
+    echo "  - PostgreSQL: localhost:${DOCKER_POSTGRES_PORT}"
+    echo "  - DynamoDB Admin: http://localhost:${DOCKER_DYNAMODB_ADMIN_PORT}"
+    echo "  - pgAdmin: http://localhost:${DOCKER_PGADMIN_PORT}"
+    echo "  - LocalStack: http://localhost:${DOCKER_LOCALSTACK_PORT}"
+    echo ""
+    echo "🔄 Read Model Updater (Lambda):"
+    echo "  - Function: pcqrses-read-model-updater"
+    echo "  - Trigger: DynamoDB Streams (automatic)"
+    echo "  - Check status: aws lambda get-function --endpoint-url http://localhost:${DOCKER_LOCALSTACK_PORT} --function-name pcqrses-read-model-updater"
+}
+
+# ========================================
+# Query API のヘルスチェック
+# ========================================
+check_query_api() {
+    echo ""
+    echo "📊 Checking Query API status..."
+    if ! wait_for_http "Query API" "http://localhost:${DOCKER_QUERY_API_PORT}/health" "Healthy" 120; then
+        echo "❌ Query API failed to start within 120 seconds"
+        echo "📜 Showing recent logs:"
+        docker compose $1 logs --tail=50 query-api
+        exit 1
+    fi
+}
+
+# ========================================
+# DynamoDB Admin UI のチェック（オプション）
+# ========================================
+check_dynamodb_admin() {
+    if ! wait_for_http "DynamoDB Admin UI" "http://localhost:${DOCKER_DYNAMODB_ADMIN_PORT}" ".*" 30; then
+        echo "  ⚠️  DynamoDB Admin UI is not available (optional service)"
+    fi
+}
+
+# ========================================
+# 共通アクセスポイント表示
+# ========================================
+show_common_access_points() {
+    echo "📍 Other services:"
+    echo "  - Query API: http://localhost:${DOCKER_QUERY_API_PORT}"
+    echo "  - Query Health Check: http://localhost:${DOCKER_QUERY_API_PORT}/health"
+    echo "  - GraphQL IDE (GraphiQL): http://localhost:${DOCKER_QUERY_API_PORT}/graphql"
+    echo "  - DynamoDB Admin: http://localhost:${DOCKER_DYNAMODB_ADMIN_PORT}"
+    echo "  - pgAdmin: http://localhost:${DOCKER_PGADMIN_PORT}"
+    echo "  - PostgreSQL: localhost:${DOCKER_POSTGRES_PORT}"
+    echo "  - LocalStack: http://localhost:${DOCKER_LOCALSTACK_PORT}"
+    echo ""
+    echo "🔄 Read Model Updater (Lambda):"
+    echo "  - Function: pcqrses-read-model-updater"
+    echo "  - Trigger: DynamoDB Streams (automatic)"
+    echo "  - Check status: aws lambda get-function --endpoint-url http://localhost:${DOCKER_LOCALSTACK_PORT} --function-name pcqrses-read-model-updater"
+}
+
+# ========================================
+# Dockerイメージビルドと環境準備
+# ========================================
+prepare_docker_environment() {
+    local compose_files="$1"
+    
+    # Dockerイメージのビルド
+    echo "🏗️  Building Docker images..."
+    sbt dockerBuildAll
+
+    # 既存のコンテナを停止・削除
+    echo "🧹 Cleaning up existing containers..."
+    docker compose $compose_files down
+}
+
+# ========================================
+# サービス起動後の共通処理
+# ========================================
+post_startup_tasks() {
+    local compose_files="$1"
+    
+    echo ""
+    echo "🎉 Services are running!"
+
+    # Lambda自動デプロイ
+    deploy_lambda_if_enabled
+
+    echo ""
+    echo "🛑 To stop: $0 down"
+    echo ""
+}
\ No newline at end of file
diff --git a/scripts/run-single.sh b/scripts/run-single.sh
new file mode 100755
index 0000000..716d33c
--- /dev/null
+++ b/scripts/run-single.sh
@@ -0,0 +1,148 @@
+#!/bin/bash
+# ========================================
+# 単一ノード構成起動スクリプト
+# ========================================
+# 使い方:
+#   ./run-single.sh [up]      # 全サービスをDockerで起動（デフォルト）
+#   ./run-single.sh down      # 全サービスを停止
+#   ./run-single.sh logs      # サービスのログを表示
+#   ./run-single.sh --db-only # データベースのみ起動（デバッグ用）
+#   ./run-single.sh -h        # ヘルプ表示
+
+set -e
+
+# 共通関数の読み込み
+SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
+. "$SCRIPT_DIR/run-common.sh"
+
+# ========================================
+# ヘルプ表示
+# ========================================
+show_help() {
+    echo "Usage: $0 [COMMAND] [OPTIONS]"
+    echo ""
+    echo "Commands:"
+    echo "  up         Start services (default)"
+    echo "  down       Stop and remove containers"
+    echo "  logs       Show service logs"
+    echo ""
+    echo "Options:"
+    echo "  --attach     Run containers in foreground (default: background)"
+    echo "  --db-only    Run only database services in Docker (for debugging)"
+    echo "  --no-deploy  Do not auto-deploy LocalStack Lambda"
+    echo "  --deploy     Force auto-deploy (default)"
+    echo "  -h, --help   Show this help message"
+    echo ""
+    echo "Examples:"
+    echo "  $0           # Start all services in background"
+    echo "  $0 up        # Start all services in background (default)"
+    echo "  $0 up --attach # Start all services in foreground"
+    echo "  $0 down      # Stop all services"
+    echo "  $0 logs      # Show service logs"
+    echo "  $0 logs -f   # Follow service logs"
+    echo "  $0 --db-only # Run only DBs, start APIs from IDE"
+    echo ""
+    echo "Environment variables:"
+    echo "  DOCKER_COMMAND_API_PORT (default: 50501)"
+    echo "  DOCKER_QUERY_API_PORT (default: 50502)"
+    echo "  DOCKER_POSTGRES_PORT (default: 50504)"
+    echo "  DOCKER_LOCALSTACK_PORT (default: 50503)"
+    echo "  DOCKER_DYNAMODB_ADMIN_PORT (default: 50505)"
+    exit 0
+}
+
+# ========================================
+# Command API起動（単一ノードモード）
+# ========================================
+start_single_node_services() {
+    echo "🐳 Starting Development Environment with Docker..."
+    echo "   (All services run in containers)"
+    echo ""
+
+    prepare_docker_environment "-f docker-compose-common.yml -f docker-compose-local.yml"
+
+    # 開発環境の起動
+    echo "🚀 Starting services..."
+    if [ "$ATTACH_MODE" = true ]; then
+        echo "📎 Running in foreground mode (Ctrl+C to stop)..."
+        docker compose -f docker-compose-common.yml -f docker-compose-local.yml up "$@"
+    else
+        docker compose -f docker-compose-common.yml -f docker-compose-local.yml up $DETACHED "$@"
+
+        # ヘルスチェック
+        echo "⏳ Waiting for services to be ready..."
+        sleep 5
+
+        # Command API の状態確認
+        echo "📊 Checking services status..."
+        if ! wait_for_http "Command API" "http://localhost:${DOCKER_COMMAND_API_PORT}/health" "Healthy" 120; then
+            echo "❌ Command API failed to start within 120 seconds"
+            echo "📜 Showing recent logs:"
+            docker compose -f docker-compose-common.yml -f docker-compose-local.yml logs --tail=50 command-api
+            exit 1
+        fi
+
+        # Query API の状態確認
+        check_query_api "-f docker-compose-common.yml -f docker-compose-local.yml"
+        
+        # DynamoDB Admin UI の確認（オプション）
+        check_dynamodb_admin
+
+        post_startup_tasks "-f docker-compose-common.yml -f docker-compose-local.yml"
+
+        # アクセスポイント表示
+        echo "📍 Access points:"
+        echo "  - Command API: http://localhost:${DOCKER_COMMAND_API_PORT}"
+        echo "  - Command Health Check: http://localhost:${DOCKER_COMMAND_API_PORT}/health"
+        show_common_access_points
+    fi
+}
+
+# ========================================
+# メイン処理
+# ========================================
+main() {
+    # デフォルト設定
+    setup_defaults
+    
+    # 引数処理
+    parse_arguments "$@"
+    
+    # 環境変数設定
+    setup_environment
+
+    # ヘルプ表示
+    if [ "$SHOW_HELP" = true ]; then
+        show_help
+    fi
+
+    # コマンド処理
+    case "$COMMAND" in
+        down)
+            if [ "$DB_ONLY" = true ]; then
+                handle_down_command dummy -f docker-compose-common.yml
+            else
+                handle_down_command dummy -f docker-compose-common.yml -f docker-compose-local.yml
+            fi
+            ;;
+
+        logs)
+            if [ "$DB_ONLY" = true ]; then
+                handle_logs_command dummy -f docker-compose-common.yml
+            else
+                handle_logs_command dummy -f docker-compose-common.yml -f docker-compose-local.yml
+            fi
+            ;;
+
+        up)
+            if [ "$DB_ONLY" = true ]; then
+                run_db_only_mode
+            else
+                start_single_node_services
+            fi
+            ;;
+    esac
+}
+
+# スクリプト実行
+main "$@"
\ No newline at end of file
diff --git a/scripts/test-e2e.sh b/scripts/test-e2e.sh
new file mode 100755
index 0000000..8cfcc8c
--- /dev/null
+++ b/scripts/test-e2e.sh
@@ -0,0 +1,355 @@
+#!/bin/bash
+
+# End-to-End Test: Create Staff via gRPC and Query via GraphQL
+# このスクリプトは、gRPC経由でスタッフを作成し、GraphQL経由で取得するE2Eテストを実行します
+
+set -e
+
+# 設定
+# 可変の待機/リトライ（環境変数で上書き可能）
+E2E_MAX_RETRIES="${E2E_MAX_RETRIES:-10}"
+E2E_RETRY_DELAY="${E2E_RETRY_DELAY:-3}"
+E2E_WAIT_AFTER_CREATE="${E2E_WAIT_AFTER_CREATE:-8}"
+
+GRPC_HOST="${GRPC_HOST:-localhost}"
+GRPC_PORT="${GRPC_PORT:-50501}"
+GRAPHQL_HOST="${GRAPHQL_HOST:-localhost}"
+GRAPHQL_PORT="${GRAPHQL_PORT:-50502}"
+GRAPHQL_ENDPOINT="http://$GRAPHQL_HOST:$GRAPHQL_PORT/graphql"
+GRPCURL_IMAGE="fullstorydev/grpcurl:latest"
+
+# テストデータ生成用のタイムスタンプ
+TIMESTAMP=$(date +%s)
+TEST_STAFF_NO="TEST${TIMESTAMP}"
+TEST_GIVEN_NAME="太郎"
+TEST_FAMILY_NAME="テスト"
+TEST_EMAIL="test${TIMESTAMP}@example.com"
+TEST_BIRTHDAY="1990-01-15"
+TEST_HIRED_DATE="2024-04-01"
+
+# 色付き出力用の関数
+print_header() {
+    echo -e "\n\033[1;34m=== $1 ===\033[0m"
+}
+
+print_success() {
+    echo -e "\033[1;32m✓ $1\033[0m"
+}
+
+print_error() {
+    echo -e "\033[1;31m✗ $1\033[0m"
+}
+
+print_info() {
+    echo -e "\033[1;33mℹ $1\033[0m"
+}
+
+print_json() {
+    echo "$1" | jq '.' 2>/dev/null || echo "$1"
+}
+
+# grpcurlコマンドを実行する関数
+run_grpcurl() {
+    docker run --rm \
+        --network host \
+        $GRPCURL_IMAGE \
+        -plaintext \
+        "$@"
+}
+
+# GraphQL クエリを実行する関数
+execute_graphql() {
+    local query="$1"
+    local variables="${2:-{}}"
+
+    # クエリ内の改行をスペースに置換
+    query=$(echo "$query" | tr '\n' ' ' | sed 's/  */ /g')
+
+    # jqでJSONペイロードを作成
+    local payload
+    if [ -z "$variables" ] || [ "$variables" = "{}" ]; then
+        payload=$(jq -n --arg q "$query" '{query: $q}')
+    else
+        payload=$(echo "$variables" | jq --arg q "$query" '{query: $q, variables: .}' 2>/dev/null)
+        if [ -z "$payload" ]; then
+            payload="{\"query\": \"$query\", \"variables\": $variables}"
+        fi
+    fi
+
+    # curlで実行
+    curl -s -X POST \
+        -H "Content-Type: application/json" \
+        -d "$payload" \
+        "$GRAPHQL_ENDPOINT"
+}
+
+# ヘルスチェック
+health_check() {
+    print_header "Health Check"
+    
+    # gRPC Health Check
+    print_info "Checking Command API (gRPC) health..."
+    if run_grpcurl $GRPC_HOST:$GRPC_PORT list > /dev/null 2>&1; then
+        print_success "Command API is healthy"
+    else
+        print_error "Command API is not responding"
+        exit 1
+    fi
+    
+    # GraphQL Health Check
+    print_info "Checking Query API (GraphQL) health..."
+    RESPONSE=$(curl -s -w "\n%{http_code}" "http://$GRAPHQL_HOST:$GRAPHQL_PORT/health")
+    HTTP_CODE=$(echo "$RESPONSE" | tail -n 1)
+    
+    if [ "$HTTP_CODE" = "200" ]; then
+        print_success "Query API is healthy"
+    else
+        print_error "Query API health check failed (HTTP $HTTP_CODE)"
+        exit 1
+    fi
+}
+
+# Step 1: Create Staff via gRPC
+create_staff_via_grpc() {
+    print_header "Step 1: Create Staff via gRPC"
+    print_info "Creating staff with the following details:"
+    echo "  - Staff No: $TEST_STAFF_NO"
+    echo "  - Name: $TEST_FAMILY_NAME $TEST_GIVEN_NAME"
+    echo "  - Email: $TEST_EMAIL"
+    echo "  - Birthday: $TEST_BIRTHDAY"
+    echo "  - Hired Date: $TEST_HIRED_DATE"
+    echo ""
+    
+    # CreateStaffリクエストを送信
+    RESPONSE=$(run_grpcurl \
+        -format text \
+        -d "staff_no:\"$TEST_STAFF_NO\" given_name:\"$TEST_GIVEN_NAME\" family_name:\"$TEST_FAMILY_NAME\" email:\"$TEST_EMAIL\" birthday:\"$TEST_BIRTHDAY\" hired_date:\"$TEST_HIRED_DATE\"" \
+        $GRPC_HOST:$GRPC_PORT \
+        io.github.j5ik2o.pcqrses.proto.staff.StaffService/CreateStaff 2>&1) || true
+    
+    echo "$RESPONSE"
+    
+    # レスポンスの確認
+    if echo "$RESPONSE" | grep -q "ERROR"; then
+        if echo "$RESPONSE" | grep -q "AlreadyExists"; then
+            print_error "Staff with StaffNo $TEST_STAFF_NO already exists"
+            print_info "This might be from a previous test run. Continuing with query test..."
+            return 0
+        else
+            print_error "Failed to create staff"
+            return 1
+        fi
+    elif echo "$RESPONSE" | grep -q "staff_id:"; then
+        # スタッフIDを抽出
+        CREATED_STAFF_ID=$(echo "$RESPONSE" | grep -o 'staff_id: *"[^"]*"' | sed 's/.*: *"\([^"]*\)".*/\1/')
+        print_success "Staff created successfully!"
+        print_info "Created Staff ID: $CREATED_STAFF_ID"
+        return 0
+    else
+        print_error "Unexpected response"
+        return 1
+    fi
+}
+
+# Step 2: Wait for eventual consistency
+wait_for_consistency() {
+    print_header "Step 2: Wait for Event Processing"
+    print_info "Waiting for DynamoDB stream to process and update PostgreSQL..."
+    
+    # Lambda関数がイベントを処理するまで待機
+    local wait_time=$E2E_WAIT_AFTER_CREATE
+    for i in $(seq $wait_time -1 1); do
+        echo -ne "\r  Waiting... $i seconds remaining"
+        sleep 1
+    done
+    echo -e "\r  Waiting... Done!                    "
+    print_success "Event processing time elapsed"
+}
+
+# Step 3: Query Staff via GraphQL
+query_staff_via_graphql() {
+    print_header "Step 3: Query Staff via GraphQL"
+    
+    # 3.1: Query by StaffNo
+    print_info "Querying staff by StaffNo: $TEST_STAFF_NO"
+    
+    local query='query GetStaff($staffNo: String!) { 
+        staffByNo(staffNo: $staffNo) { 
+            id 
+            staffNo 
+            globalFamilyName 
+            globalGivenName 
+            localFamilyName 
+            localGivenName 
+            nameLocale 
+            createdAt 
+            updatedAt 
+        } 
+    }'
+    
+    local variables="{\"staffNo\": \"$TEST_STAFF_NO\"}"
+    
+    RESPONSE=$(execute_graphql "$query" "$variables")
+    
+    if echo "$RESPONSE" | jq -e '.data.staffByNo' > /dev/null 2>&1; then
+        STAFF_DATA=$(echo "$RESPONSE" | jq '.data.staffByNo')
+        if [ "$STAFF_DATA" != "null" ]; then
+            print_success "Staff found via GraphQL!"
+            print_json "$RESPONSE"
+            
+            # データの検証
+            QUERIED_STAFF_NO=$(echo "$STAFF_DATA" | jq -r '.staffNo')
+            if [ "$QUERIED_STAFF_NO" = "$TEST_STAFF_NO" ]; then
+                print_success "Staff No matches: $QUERIED_STAFF_NO"
+            else
+                print_error "Staff No mismatch! Expected: $TEST_STAFF_NO, Got: $QUERIED_STAFF_NO"
+            fi
+        else
+            print_error "Staff not found in database"
+            print_info "The event might not have been processed yet"
+            return 1
+        fi
+    else
+        print_error "GraphQL query failed"
+        print_json "$RESPONSE"
+        return 1
+    fi
+    
+    # 3.2: Query all staff to verify the new staff is in the list
+    print_info "Verifying staff appears in allStaff query..."
+    
+    local all_query='{ 
+        allStaff { 
+            staffNo 
+            globalFamilyName 
+            globalGivenName 
+        } 
+    }'
+    
+    RESPONSE=$(execute_graphql "$all_query")
+    
+    if echo "$RESPONSE" | jq -e '.data.allStaff' > /dev/null 2>&1; then
+        # テストスタッフが含まれているか確認
+        if echo "$RESPONSE" | jq ".data.allStaff[] | select(.staffNo == \"$TEST_STAFF_NO\")" > /dev/null 2>&1; then
+            print_success "Staff appears in allStaff query"
+            TOTAL_COUNT=$(echo "$RESPONSE" | jq '.data.allStaff | length')
+            print_info "Total staff count: $TOTAL_COUNT"
+        else
+            print_error "Staff not found in allStaff query"
+        fi
+    fi
+}
+
+# Step 4: Verify data consistency
+verify_data_consistency() {
+    print_header "Step 4: Data Consistency Verification"
+    
+    # 検索クエリでも確認
+    print_info "Searching staff by family name..."
+    
+    local search_query='query SearchStaff($familyName: String) { 
+        searchStaff(globalFamilyName: $familyName) { 
+            staffNo 
+            globalFamilyName 
+            globalGivenName 
+        } 
+    }'
+    
+    local variables="{\"familyName\": \"$TEST_FAMILY_NAME\"}"
+    
+    RESPONSE=$(execute_graphql "$search_query" "$variables")
+    
+    if echo "$RESPONSE" | jq -e '.data.searchStaff' > /dev/null 2>&1; then
+        if echo "$RESPONSE" | jq ".data.searchStaff[] | select(.staffNo == \"$TEST_STAFF_NO\")" > /dev/null 2>&1; then
+            print_success "Staff found via search query"
+        else
+            print_error "Staff not found via search query"
+        fi
+    fi
+}
+
+# オプション: クリーンアップ（退職処理）
+cleanup_test_staff() {
+    print_header "Optional: Cleanup Test Data"
+    print_info "Scheduling retirement for test staff..."
+    
+    # 明日の日付を退職日として設定
+    RETIREMENT_DATE=$(date -v+1d +%Y-%m-%d 2>/dev/null || date -d "+1 day" +%Y-%m-%d)
+    
+    RESPONSE=$(run_grpcurl \
+        -format text \
+        -d "staff_no:\"$TEST_STAFF_NO\" retirement_date:\"$RETIREMENT_DATE\"" \
+        $GRPC_HOST:$GRPC_PORT \
+        io.github.j5ik2o.pcqrses.proto.staff.StaffService/ScheduleRetirementStaff 2>&1) || true
+    
+    echo "$RESPONSE"
+    
+    if echo "$RESPONSE" | grep -q "staff_id:"; then
+        print_success "Test staff retirement scheduled for $RETIREMENT_DATE"
+    else
+        print_info "Could not schedule retirement (this is optional)"
+    fi
+}
+
+# メイン処理
+main() {
+    print_header "End-to-End Test Suite"
+    print_info "Testing flow: gRPC Create → Event Processing → GraphQL Query"
+    print_info "Test ID: $TIMESTAMP"
+    echo ""
+    
+    # ヘルスチェック
+    health_check
+    
+    # E2Eテストの実行
+    if create_staff_via_grpc; then
+        wait_for_consistency
+        
+        # リトライロジック付きでクエリを実行
+        MAX_RETRIES=$E2E_MAX_RETRIES
+        RETRY_COUNT=0
+        SUCCESS=false
+        
+        while [ $RETRY_COUNT -lt $MAX_RETRIES ] && [ "$SUCCESS" = false ]; do
+            if [ $RETRY_COUNT -gt 0 ]; then
+                print_info "Retry attempt $RETRY_COUNT/$MAX_RETRIES... (sleep ${E2E_RETRY_DELAY}s)"
+                sleep "$E2E_RETRY_DELAY"
+            fi
+            
+            if query_staff_via_graphql; then
+                SUCCESS=true
+                verify_data_consistency
+            else
+                RETRY_COUNT=$((RETRY_COUNT + 1))
+            fi
+        done
+        
+        if [ "$SUCCESS" = false ]; then
+            print_error "Failed to query staff after $MAX_RETRIES retries"
+            print_info "Possible causes:"
+            echo "  - Lambda function not deployed or not running"
+            echo "  - DynamoDB streams not configured"
+            echo "  - Database connection issues"
+            exit 1
+        fi
+    else
+        print_error "Failed to create staff, aborting test"
+        exit 1
+    fi
+    
+    # オプション: クリーンアップ
+    if [ "${CLEANUP:-false}" = "true" ]; then
+        cleanup_test_staff
+    fi
+    
+    print_header "Test Summary"
+    print_success "End-to-End test completed successfully!"
+    print_info "Staff No: $TEST_STAFF_NO was created via gRPC and retrieved via GraphQL"
+    echo ""
+    print_info "To run cleanup: CLEANUP=true $0"
+}
+
+# スクリプト実行
+if [ "${BASH_SOURCE[0]}" = "${0}" ]; then
+    main "$@"
+fi
diff --git a/scripts/test-graphql.sh b/scripts/test-graphql.sh
new file mode 100755
index 0000000..ab6521d
--- /dev/null
+++ b/scripts/test-graphql.sh
@@ -0,0 +1,439 @@
+#!/bin/bash
+
+# GraphQL エンドポイントをテストするスクリプト
+
+set -e
+
+# 設定
+GRAPHQL_HOST="${GRAPHQL_HOST:-localhost}"
+GRAPHQL_PORT="${GRAPHQL_PORT:-50502}"
+GRAPHQL_ENDPOINT="http://$GRAPHQL_HOST:$GRAPHQL_PORT/graphql"
+
+# 色付き出力用の関数
+print_header() {
+    echo -e "\n\033[1;34m=== $1 ===\033[0m"
+}
+
+print_success() {
+    echo -e "\033[1;32m✓ $1\033[0m"
+}
+
+print_error() {
+    echo -e "\033[1;31m✗ $1\033[0m"
+}
+
+print_info() {
+    echo -e "\033[1;33mℹ $1\033[0m"
+}
+
+print_json() {
+    echo "$1" | jq '.' 2>/dev/null || echo "$1"
+}
+
+# GraphQL クエリを実行する関数
+execute_graphql() {
+    local query="$1"
+    local variables="${2:-{}}"
+
+    # クエリ内の改行をスペースに置換
+    query=$(echo "$query" | tr '\n' ' ' | sed 's/  */ /g')
+
+    # jqでJSONペイロードを作成
+    local payload
+    if [ -z "$variables" ] || [ "$variables" = "{}" ]; then
+        payload=$(jq -n --arg q "$query" '{query: $q}')
+    else
+        # variablesをstdinから読み込み、queryと結合（エラーを抑制）
+        payload=$(echo "$variables" | jq --arg q "$query" '{query: $q, variables: .}' 2>/dev/null)
+        # エラーが発生した場合のフォールバック
+        if [ -z "$payload" ]; then
+            # 直接JSON文字列を構築
+            payload="{\"query\": \"$query\", \"variables\": $variables}"
+        fi
+    fi
+
+    # curlで実行
+    curl -s -X POST \
+        -H "Content-Type: application/json" \
+        -d "$payload" \
+        "$GRAPHQL_ENDPOINT"
+}
+
+# ヘルスチェック
+health_check() {
+    print_header "Health Check"
+    print_info "Checking Query API health..."
+
+    RESPONSE=$(curl -s -w "\n%{http_code}" "http://$GRAPHQL_HOST:$GRAPHQL_PORT/health")
+    HTTP_CODE=$(echo "$RESPONSE" | tail -n 1)
+    BODY=$(echo "$RESPONSE" | sed '$d')
+
+    if [ "$HTTP_CODE" = "200" ]; then
+        print_success "Query API is healthy: $BODY"
+    else
+        print_error "Query API health check failed (HTTP $HTTP_CODE)"
+        exit 1
+    fi
+}
+
+# GraphiQL の確認
+check_graphiql() {
+    print_header "GraphiQL Interface Check"
+    print_info "Checking if GraphiQL is available..."
+
+    HTTP_CODE=$(curl -s -o /dev/null -w "%{http_code}" "$GRAPHQL_ENDPOINT")
+
+    if [ "$HTTP_CODE" = "200" ]; then
+        print_success "GraphiQL is available at $GRAPHQL_ENDPOINT"
+    elif [ "$HTTP_CODE" = "404" ]; then
+        print_info "GraphiQL is disabled (production mode)"
+    else
+        print_error "Unexpected response (HTTP $HTTP_CODE)"
+    fi
+}
+
+# イントロスペクションクエリ
+introspection_query() {
+    print_header "Schema Introspection"
+    print_info "Fetching GraphQL schema..."
+
+    local query='
+    {
+        __schema {
+            types {
+                name
+                kind
+                description
+            }
+        }
+    }'
+
+    RESPONSE=$(execute_graphql "$query")
+
+    if echo "$RESPONSE" | jq -e '.data.__schema.types' > /dev/null 2>&1; then
+        print_success "Schema introspection successful"
+        echo "$RESPONSE" | jq '.data.__schema.types[] | select(.name | startswith("Staff"))' 2>/dev/null
+    else
+        print_error "Schema introspection failed"
+        print_json "$RESPONSE"
+    fi
+}
+
+# 利用可能なクエリの一覧取得
+list_queries() {
+    print_header "Available Queries"
+    print_info "Listing all available queries..."
+
+    local query='
+    {
+        __schema {
+            queryType {
+                fields {
+                    name
+                    description
+                    args {
+                        name
+                        type {
+                            name
+                            kind
+                        }
+                    }
+                }
+            }
+        }
+    }'
+
+    RESPONSE=$(execute_graphql "$query")
+
+    if echo "$RESPONSE" | jq -e '.data.__schema.queryType.fields' > /dev/null 2>&1; then
+        print_success "Query list retrieved"
+        echo "$RESPONSE" | jq '.data.__schema.queryType.fields[] | {name: .name, description: .description}'
+    else
+        print_error "Failed to retrieve query list"
+        print_json "$RESPONSE"
+    fi
+}
+
+# 全スタッフ取得クエリ
+test_all_staff() {
+    print_header "Test: Get All Staff"
+    print_info "Executing allStaff query..."
+
+    local query='
+    {
+        allStaff {
+            id
+            staffNo
+            globalFamilyName
+            globalMiddleName
+            globalGivenName
+            localFamilyName
+            localMiddleName
+            localGivenName
+            nameLocale
+            createdAt
+            updatedAt
+        }
+    }'
+
+    RESPONSE=$(execute_graphql "$query")
+
+    if echo "$RESPONSE" | jq -e '.data.allStaff' > /dev/null 2>&1; then
+        COUNT=$(echo "$RESPONSE" | jq '.data.allStaff | length')
+        print_success "Query executed successfully (Found $COUNT staff members)"
+        echo "$RESPONSE" | jq '.data.allStaff[:2]' 2>/dev/null  # 最初の2件だけ表示
+    else
+        if echo "$RESPONSE" | jq -e '.errors' > /dev/null 2>&1; then
+            print_error "Query failed with errors:"
+            echo "$RESPONSE" | jq '.errors'
+        else
+            print_info "No staff data found (empty result)"
+            print_json "$RESPONSE"
+        fi
+    fi
+}
+
+# 特定スタッフ取得クエリ
+test_staff_by_no() {
+    print_header "Test: Get Staff by Staff Number"
+    print_info "Executing staff query with staffNo parameter..."
+
+    local query='query GetStaff($staffNo: String!) { staffByNo(staffNo: $staffNo) { id staffNo globalFamilyName globalGivenName localFamilyName localGivenName nameLocale } }'
+
+    local variables='{"staffNo": "STF001"}'
+
+    # デバッグ: execute_graphql呼び出し前に確認
+    # echo "DEBUG Query: $query" >&2
+    # echo "DEBUG Variables: $variables" >&2
+    
+    RESPONSE=$(execute_graphql "$query" "$variables")
+
+    if echo "$RESPONSE" | jq -e '.data.staffByNo' > /dev/null 2>&1; then
+        if [ "$(echo "$RESPONSE" | jq '.data.staffByNo')" != "null" ]; then
+            print_success "Staff found:"
+            print_json "$RESPONSE"
+        else
+            print_info "No staff found with staffNo: STF001"
+        fi
+    else
+        print_error "Query failed"
+        print_json "$RESPONSE"
+    fi
+}
+
+# ロケールによるスタッフ検索
+test_staff_by_locale() {
+    print_header "Test: Get Staff by Locale"
+    print_info "Executing staffByLocale query..."
+
+    local query='query GetStaffByLocale($locale: String) { staffByLocale(nameLocale: $locale) { staffNo nameLocale globalFamilyName globalGivenName } }'
+
+    local variables='{"locale": "ja_JP"}'
+
+    RESPONSE=$(execute_graphql "$query" "$variables")
+
+    if echo "$RESPONSE" | jq -e '.data.staffByLocale' > /dev/null 2>&1; then
+        COUNT=$(echo "$RESPONSE" | jq '.data.staffByLocale | length')
+        print_success "Query executed successfully (Found $COUNT staff members with locale ja_JP)"
+    else
+        print_error "Query failed"
+        print_json "$RESPONSE"
+    fi
+}
+
+# 名前検索テスト
+test_search_staff() {
+    print_header "Test: Search Staff by Name"
+    print_info "Executing searchStaff query..."
+
+    local query='query SearchStaff($globalFamily: String, $localFamily: String) { searchStaff(globalFamilyName: $globalFamily, localFamilyName: $localFamily) { staffNo globalFamilyName globalGivenName localFamilyName localGivenName } }'
+
+    local variables='{"globalFamily": "Yamada"}'
+
+    RESPONSE=$(execute_graphql "$query" "$variables")
+
+    if echo "$RESPONSE" | jq -e '.data.searchStaff' > /dev/null 2>&1; then
+        COUNT=$(echo "$RESPONSE" | jq '.data.searchStaff | length')
+        print_success "Search executed successfully (Found $COUNT matches)"
+        if [ "$COUNT" -gt 0 ]; then
+            echo "$RESPONSE" | jq '.data.searchStaff[:2]' 2>/dev/null
+        fi
+    else
+        print_error "Search failed"
+        print_json "$RESPONSE"
+    fi
+}
+
+# バッチクエリテスト（複数クエリの同時実行）
+test_batch_query() {
+    print_header "Test: Batch Query"
+    print_info "Executing multiple queries in single request..."
+
+    local query='
+    {
+        allStaffCount: allStaff {
+            staffNo
+        }
+        japaneseStaff: staffByLocale(nameLocale: "ja_JP") {
+            staffNo
+            nameLocale
+        }
+        searchYamada: searchStaff(globalFamilyName: "Yamada") {
+            staffNo
+            globalFamilyName
+        }
+    }'
+
+    RESPONSE=$(execute_graphql "$query")
+
+    if echo "$RESPONSE" | jq -e '.data' > /dev/null 2>&1; then
+        print_success "Batch query executed successfully"
+        echo "Results summary:"
+        echo "  - All staff count: $(echo "$RESPONSE" | jq '.data.allStaffCount | length')"
+        echo "  - Japanese staff: $(echo "$RESPONSE" | jq '.data.japaneseStaff | length')"
+        echo "  - Search results: $(echo "$RESPONSE" | jq '.data.searchYamada | length')"
+    else
+        print_error "Batch query failed"
+        print_json "$RESPONSE"
+    fi
+}
+
+# フラグメント使用のテスト
+test_with_fragments() {
+    print_header "Test: Query with Fragments"
+    print_info "Testing GraphQL fragments..."
+
+    local query='
+    fragment StaffBasicInfo on Staff {
+        staffNo
+        nameLocale
+    }
+
+    fragment StaffNameInfo on Staff {
+        globalFamilyName
+        globalGivenName
+        localFamilyName
+        localGivenName
+    }
+
+    {
+        allStaff {
+            ...StaffBasicInfo
+            ...StaffNameInfo
+            createdAt
+        }
+    }'
+
+    RESPONSE=$(execute_graphql "$query")
+
+    if echo "$RESPONSE" | jq -e '.data.allStaff' > /dev/null 2>&1; then
+        print_success "Fragment query executed successfully"
+    else
+        print_error "Fragment query failed"
+        print_json "$RESPONSE"
+    fi
+}
+
+# エラーハンドリングテスト
+test_error_handling() {
+    print_header "Test: Error Handling"
+    print_info "Testing error responses..."
+
+    # 1. 不正なクエリ
+    print_info "Testing malformed query..."
+    local bad_query='{ invalid query }'
+    RESPONSE=$(execute_graphql "$bad_query")
+
+    if echo "$RESPONSE" | jq -e '.errors' > /dev/null 2>&1; then
+        print_success "Error handled correctly for malformed query"
+    else
+        print_error "Expected error not returned"
+    fi
+
+    # 2. 存在しないフィールド
+    print_info "Testing non-existent field..."
+    local invalid_field_query='
+    {
+        allStaff {
+            staffNo
+            nonExistentField
+        }
+    }'
+
+    RESPONSE=$(execute_graphql "$invalid_field_query")
+
+    if echo "$RESPONSE" | jq -e '.errors' > /dev/null 2>&1; then
+        print_success "Error handled correctly for non-existent field"
+    else
+        print_error "Expected error not returned"
+    fi
+}
+
+# パフォーマンステスト
+performance_test() {
+    print_header "Performance Test"
+    print_info "Measuring query response times..."
+
+    local query='{ allStaff { staffNo } }'
+
+    # 5回実行して平均を取る
+    local total_time=0
+    local iterations=5
+
+    for i in $(seq 1 $iterations); do
+        START=$(date +%s%N)
+        execute_graphql "$query" > /dev/null
+        END=$(date +%s%N)
+        ELAPSED=$((($END - $START) / 1000000))  # ミリ秒に変換
+        total_time=$((total_time + ELAPSED))
+        echo "  Run $i: ${ELAPSED}ms"
+    done
+
+    AVG=$((total_time / iterations))
+    print_info "Average response time: ${AVG}ms"
+
+    if [ $AVG -lt 100 ]; then
+        print_success "Excellent performance (< 100ms)"
+    elif [ $AVG -lt 500 ]; then
+        print_success "Good performance (< 500ms)"
+    else
+        print_error "Poor performance (>= 500ms)"
+    fi
+}
+
+# メイン処理
+main() {
+    print_header "GraphQL API Test Suite"
+    print_info "Target: $GRAPHQL_ENDPOINT"
+
+    # 基本的な接続確認
+    health_check
+    check_graphiql
+
+    # スキーマテスト
+    introspection_query
+    list_queries
+
+    # クエリテスト
+    test_all_staff
+    test_staff_by_no
+    test_staff_by_locale
+    test_search_staff
+
+    # 高度なテスト
+    test_batch_query
+    test_with_fragments
+    test_error_handling
+
+    # パフォーマンステスト
+    performance_test
+
+    print_header "Test Summary"
+    print_success "All GraphQL API tests completed"
+    print_info "GraphiQL interface available at: $GRAPHQL_ENDPOINT"
+}
+
+# スクリプト実行（直接実行時のみ）
+if [ "${BASH_SOURCE[0]}" = "${0}" ]; then
+    main "$@"
+fi
diff --git a/tools/dynamodb-setup/Dockerfile b/tools/dynamodb-setup/Dockerfile
new file mode 100644
index 0000000..8fb296c
--- /dev/null
+++ b/tools/dynamodb-setup/Dockerfile
@@ -0,0 +1,19 @@
+FROM --platform=$BUILDPLATFORM amazonlinux:2
+
+# AWS CLIとその他必要なパッケージのインストール（アーキテクチャ自動検出）
+RUN yum update -y && \
+    yum install -y unzip curl python3 python3-pip && \
+    pip3 install awscli && \
+    yum clean all
+
+# 作業ディレクトリの作成と設定
+WORKDIR /setup
+
+# ファイルのコピー
+COPY *.json ./
+COPY *.sh ./
+
+# 実行権限の付与
+RUN chmod +x *.sh
+
+ENTRYPOINT ["./create-table.sh"]
diff --git a/tools/dynamodb-setup/Makefile b/tools/dynamodb-setup/Makefile
new file mode 100644
index 0000000..3823188
--- /dev/null
+++ b/tools/dynamodb-setup/Makefile
@@ -0,0 +1,92 @@
+# aws-cli/2.0.4 Python/3.8.2 Darwin/19.3.0 botocore/2.0.0dev8
+
+# import config.
+# You can change the default config with `make cnf="config_special.env" build`
+cnf ?= config.env
+include $(cnf)
+export $(shell sed 's/=.*//' $(cnf))
+
+# import deploy config
+# You can change the default deploy config with `make cnf="deploy_special.env" release`
+dpl ?= deploy.env
+include $(dpl)
+export $(shell sed 's/=.*//' $(dpl))
+
+# grep the version from the mix file
+VERSION=$(shell ./version.sh)
+
+ACCOUNT_ID=$(shell aws sts get-caller-identity --profile $(AWS_CLI_PROFILE) | jq -r '.Account')
+DOCKER_REPO=$(ACCOUNT_ID).dkr.ecr.$(AWS_CLI_REGION).amazonaws.com
+
+# HELP
+# This will output the help for each task
+# thanks to https://marmelab.com/blog/2016/02/29/auto-documented-makefile.html
+.PHONY: help
+
+help: ## This help.
+	@awk 'BEGIN {FS = ":.*?## "} /^[a-zA-Z_-]+:.*?## / {printf "\033[36m%-30s\033[0m %s\n", $$1, $$2}' $(MAKEFILE_LIST)
+
+.DEFAULT_GOAL := help
+
+
+# DOCKER TASKS
+# Build the container
+build: ## Build the container
+	docker build -t $(APP_NAME) .
+
+build-nc: ## Build the container without caching
+	docker build --no-cache -t $(APP_NAME) .
+
+run: ## Run container on port configured in `config.env`
+	docker run -i -t --rm --env-file=./config.env -p=$(PORT):$(PORT) --name="$(APP_NAME)" $(APP_NAME)
+
+
+up: build run ## Run container on port configured in `config.env` (Alias to run)
+
+stop: ## Stop and remove a running container
+	docker stop $(APP_NAME); docker rm $(APP_NAME)
+
+release: build-nc publish ## Make a release by building and publishing the `{version}` ans `latest` tagged containers to ECR
+
+# Docker publish
+publish: repo-login publish-latest publish-version ## Publish the `{version}` ans `latest` tagged containers to ECR
+
+publish-latest: tag-latest ## Publish the `latest` taged container to ECR
+	@echo 'publish latest to $(DOCKER_REPO)'
+	docker push $(DOCKER_REPO)/$(APP_NAME):latest
+
+publish-version: tag-version ## Publish the `{version}` taged container to ECR
+	@echo 'publish $(VERSION) to $(DOCKER_REPO)'
+	docker push $(DOCKER_REPO)/$(APP_NAME):$(VERSION)
+
+# Docker tagging
+tag: tag-latest tag-version ## Generate container tags for the `{version}` ans `latest` tags
+
+tag-latest: ## Generate container `{version}` tag
+	@echo 'create tag latest'
+	docker tag $(APP_NAME) $(DOCKER_REPO)/$(APP_NAME):latest
+
+tag-version: ## Generate container `latest` tag
+	@echo 'create tag $(VERSION)'
+	docker tag $(APP_NAME) $(DOCKER_REPO)/$(APP_NAME):$(VERSION)
+
+# generate script to login to aws docker repo
+CMD_REPOLOGIN := "aws ecr get-login-password"
+ifdef AWS_CLI_PROFILE
+CMD_REPOLOGIN += " --profile $(AWS_CLI_PROFILE)"
+endif
+ifdef AWS_CLI_REGION
+CMD_REPOLOGIN += " --region $(AWS_CLI_REGION)"
+endif
+CMD_REPOLOGIN += " | docker login --username AWS --password-stdin $(ACCOUNT_ID).dkr.ecr.$(AWS_CLI_REGION).amazonaws.com/$(APP_NAME)"
+
+# login to AWS-ECR
+repo-login: ## Auto login to AWS-ECR unsing aws-cli
+	@eval $(CMD_REPOLOGIN)
+
+# HELPERS
+account-id: ## Output the current version
+	@echo $(ACCOUNT_ID)
+
+version: ## Output the current version
+	@echo $(VERSION)
\ No newline at end of file
diff --git a/tools/dynamodb-setup/account-table.json b/tools/dynamodb-setup/account-table.json
new file mode 100644
index 0000000..a950310
--- /dev/null
+++ b/tools/dynamodb-setup/account-table.json
@@ -0,0 +1,19 @@
+{
+  "TableName": "Account",
+  "AttributeDefinitions": [
+    {
+      "AttributeName": "id",
+      "AttributeType": "S"
+    }
+  ],
+  "KeySchema": [
+    {
+      "KeyType": "HASH",
+      "AttributeName": "id"
+    }
+  ],
+  "ProvisionedThroughput": {
+    "WriteCapacityUnits": 10,
+    "ReadCapacityUnits": 10
+  }
+}
\ No newline at end of file
diff --git a/tools/dynamodb-setup/config.env b/tools/dynamodb-setup/config.env
new file mode 100644
index 0000000..5bda22d
--- /dev/null
+++ b/tools/dynamodb-setup/config.env
@@ -0,0 +1,5 @@
+APP_NAME=dynamodb-setup
+# Port to run the container
+PORT=4000
+
+# Until here you can define all the individual configurations for your app
diff --git a/tools/dynamodb-setup/create-table.sh b/tools/dynamodb-setup/create-table.sh
new file mode 100755
index 0000000..ff3c228
--- /dev/null
+++ b/tools/dynamodb-setup/create-table.sh
@@ -0,0 +1,104 @@
+#!/bin/bash
+
+set -e
+
+# 作業ディレクトリの確認
+pwd
+ls -la
+
+# 定数定義
+readonly TABLES=("journal" "snapshot" "state")
+readonly DEFAULT_ENDPOINT="http://localhost:8000"
+
+# 使用方法の表示
+usage() {
+    echo "Usage: $0 -e <environment>"
+    echo "  -e: Environment (prod or dev/local)"
+    exit 1
+}
+
+# エラーハンドリング関数
+handle_error() {
+    echo "Error: $1" >&2
+    exit 1
+}
+
+# 環境変数の設定
+setup_aws_env() {
+    export AWS_ACCESS_KEY_ID=${AWS_ACCESS_KEY_ID:-x}
+    export AWS_SECRET_ACCESS_KEY=${AWS_SECRET_ACCESS_KEY:-x}
+    export AWS_PAGER=""
+}
+
+# テーブル作成関数
+create_table() {
+    local table_name=$1
+    local endpoint_url=$2
+    local endpoint_param=""
+
+    if [ -n "$endpoint_url" ]; then
+        endpoint_param="--endpoint-url $endpoint_url"
+    fi
+
+    echo "Creating $table_name table..."
+    echo "Current directory: $(pwd)"
+    echo "Table JSON content:"
+    cat "./${table_name}-table.json"
+    echo "Running command: aws dynamodb create-table $endpoint_param --cli-input-json file:./${table_name}-table.json"
+    # JSONファイルの内容を変数に保存
+    local json_content
+    json_content=$(cat "./${table_name}-table.json")
+    
+    echo "Endpoint parameter: [$endpoint_param]"
+    echo "JSON content: $json_content"
+    
+    if ! aws dynamodb create-table \
+        $endpoint_param \
+        --cli-input-json "$json_content"; then
+        handle_error "Failed to create $table_name table"
+    fi
+}
+
+# メイン処理
+main() {
+    local env_name=""
+
+    echo 'Sleeping for 3 seconds to allow DynamoDB to stabilize...'
+    sleep 3
+
+    # パラメーターの解析
+    while getopts "e:" opt; do
+        case $opt in
+            e) env_name="$OPTARG" ;;
+            *) usage ;;
+        esac
+    done
+
+    # 必須パラメーターのチェック
+    if [ -z "$env_name" ]; then
+        handle_error "Environment parameter (-e) is required"
+    fi
+
+    # AWS環境変数の設定
+    setup_aws_env
+
+    # 環境に応じたエンドポイントの設定
+    local endpoint=""
+    if [ "$env_name" != "prod" ]; then
+        endpoint=${DYNAMODB_ENDPOINT:-$DEFAULT_ENDPOINT}
+        echo "Using endpoint: $endpoint"
+    fi
+
+    # テーブルの作成
+    for table in "${TABLES[@]}"; do
+        create_table "$table" "$endpoint"
+    done
+    
+    echo 'Sleeping for 3 seconds to allow DynamoDB to stabilize...'
+    sleep 3
+
+    echo "All tables created successfully"
+}
+
+# メイン処理の実行
+main "$@"
diff --git a/tools/dynamodb-setup/deploy.env b/tools/dynamodb-setup/deploy.env
new file mode 100644
index 0000000..98cef25
--- /dev/null
+++ b/tools/dynamodb-setup/deploy.env
@@ -0,0 +1,2 @@
+AWS_CLI_PROFILE=xxxxx
+AWS_CLI_REGION=ap-northeast-1
\ No newline at end of file
diff --git a/tools/dynamodb-setup/journal-table.json b/tools/dynamodb-setup/journal-table.json
new file mode 100644
index 0000000..549a21f
--- /dev/null
+++ b/tools/dynamodb-setup/journal-table.json
@@ -0,0 +1,61 @@
+{
+  "TableName": "Journal",
+  "AttributeDefinitions": [
+    {
+      "AttributeName": "pkey",
+      "AttributeType": "S"
+    },
+    {
+      "AttributeName": "skey",
+      "AttributeType": "S"
+    },
+    {
+      "AttributeName": "persistence-id",
+      "AttributeType": "S"
+    },
+    {
+      "AttributeName": "sequence-nr",
+      "AttributeType": "N"
+    }
+  ],
+  "KeySchema": [
+    {
+      "KeyType": "HASH",
+      "AttributeName": "pkey"
+    },
+    {
+      "KeyType": "RANGE",
+      "AttributeName": "skey"
+    }
+  ],
+  "ProvisionedThroughput": {
+    "WriteCapacityUnits": 10,
+    "ReadCapacityUnits": 10
+  },
+  "GlobalSecondaryIndexes": [
+    {
+      "IndexName": "GetJournalRowsIndex",
+      "KeySchema": [
+        {
+          "AttributeName": "persistence-id",
+          "KeyType": "HASH"
+        },
+        {
+          "AttributeName": "sequence-nr",
+          "KeyType": "RANGE"
+        }
+      ],
+      "Projection": {
+        "ProjectionType": "ALL"
+      },
+      "ProvisionedThroughput": {
+        "ReadCapacityUnits": 10,
+        "WriteCapacityUnits": 10
+      }
+    }
+  ],
+  "StreamSpecification": {
+    "StreamEnabled": true,
+    "StreamViewType" : "NEW_IMAGE"
+  }
+}
diff --git a/tools/dynamodb-setup/scan.sh b/tools/dynamodb-setup/scan.sh
new file mode 100644
index 0000000..3e91f9e
--- /dev/null
+++ b/tools/dynamodb-setup/scan.sh
@@ -0,0 +1,8 @@
+#!/bin/sh
+
+DYNAMODB_LOCAL=${DYNAMODB_LOCAL:-localhost}
+
+echo "host = ${DYNAMODB_LOCAL}"
+
+AWS_PAGER="" AWS_ACCESS_KEY_ID=x AWS_SECRET_ACCESS_KEY=x \
+  aws dynamodb --endpoint-url http://${DYNAMODB_LOCAL}:8000 scan --table-name Account
diff --git a/tools/dynamodb-setup/snapshot-table.json b/tools/dynamodb-setup/snapshot-table.json
new file mode 100644
index 0000000..9c1d93e
--- /dev/null
+++ b/tools/dynamodb-setup/snapshot-table.json
@@ -0,0 +1,57 @@
+{
+  "TableName": "Snapshot",
+  "AttributeDefinitions": [
+    {
+      "AttributeName": "pkey",
+      "AttributeType": "S"
+    },
+    {
+      "AttributeName": "skey",
+      "AttributeType": "S"
+    },
+    {
+      "AttributeName": "persistence-id",
+      "AttributeType": "S"
+    },
+    {
+      "AttributeName": "sequence-nr",
+      "AttributeType": "N"
+    }
+  ],
+  "KeySchema": [
+    {
+      "KeyType": "HASH",
+      "AttributeName": "pkey"
+    },
+    {
+      "KeyType": "RANGE",
+      "AttributeName": "skey"
+    }
+  ],
+  "GlobalSecondaryIndexes": [
+    {
+      "IndexName": "GetSnapshotRowsIndex",
+      "KeySchema": [
+        {
+          "AttributeName": "persistence-id",
+          "KeyType": "HASH"
+        },
+        {
+          "AttributeName": "sequence-nr",
+          "KeyType": "RANGE"
+        }
+      ],
+      "Projection": {
+        "ProjectionType": "ALL"
+      },
+      "ProvisionedThroughput": {
+        "ReadCapacityUnits": 10,
+        "WriteCapacityUnits": 10
+      }
+    }
+  ],
+  "ProvisionedThroughput": {
+    "WriteCapacityUnits": 10,
+    "ReadCapacityUnits": 10
+  }
+}
\ No newline at end of file
diff --git a/tools/dynamodb-setup/state-table.json b/tools/dynamodb-setup/state-table.json
new file mode 100644
index 0000000..e7b94f5
--- /dev/null
+++ b/tools/dynamodb-setup/state-table.json
@@ -0,0 +1,27 @@
+{
+  "TableName": "State",
+  "AttributeDefinitions": [
+    {
+      "AttributeName": "pkey",
+      "AttributeType": "S"
+    },
+    {
+      "AttributeName": "skey",
+      "AttributeType": "S"
+    }
+  ],
+  "KeySchema": [
+    {
+      "KeyType": "HASH",
+      "AttributeName": "pkey"
+    },
+    {
+      "KeyType": "RANGE",
+      "AttributeName": "skey"
+    }
+  ],
+  "ProvisionedThroughput": {
+    "WriteCapacityUnits": 10,
+    "ReadCapacityUnits": 10
+  }
+}
diff --git a/tools/flyway/seed/V2__insert_staff_test_data.sql b/tools/flyway/seed/V2__insert_staff_test_data.sql
new file mode 100644
index 0000000..7504096
--- /dev/null
+++ b/tools/flyway/seed/V2__insert_staff_test_data.sql
@@ -0,0 +1,70 @@
+-- これはテストデータで後で削除する。本来は dynamodb から rmu が insert する
+
+-- テストデータ: 日本人スタッフ
+INSERT INTO staff (
+    id,
+    staff_no,
+    global_family_name,
+    global_middle_name,
+    global_given_name,
+    local_family_name,
+    local_middle_name,
+    local_given_name,
+    name_locale
+) VALUES (
+    '01J79Z8X000000000000000001',
+    'STF001',
+    'Yamada',
+    NULL,
+    'Taro',
+    '山田',
+    NULL,
+    '太郎',
+    'ja_JP'
+);
+
+-- テストデータ: アメリカ人スタッフ
+INSERT INTO staff (
+    id,
+    staff_no,
+    global_family_name,
+    global_middle_name,
+    global_given_name,
+    local_family_name,
+    local_middle_name,
+    local_given_name,
+    name_locale
+) VALUES (
+    '01J79Z8X000000000000000002',
+    'STF002',
+    'Smith',
+    'James',
+    'John',
+    'Smith',
+    'James',
+    'John',
+    'en_US'
+);
+
+-- テストデータ: 中国人スタッフ
+INSERT INTO staff (
+    id,
+    staff_no,
+    global_family_name,
+    global_middle_name,
+    global_given_name,
+    local_family_name,
+    local_middle_name,
+    local_given_name,
+    name_locale
+) VALUES (
+    '01J79Z8X000000000000000003',
+    'STF003',
+    'Wang',
+    NULL,
+    'Wei',
+    '王',
+    NULL,
+    '偉',
+    'zh_CN'
+);
diff --git a/tools/pgadmin/pgpass b/tools/pgadmin/pgpass
new file mode 100644
index 0000000..8755b48
--- /dev/null
+++ b/tools/pgadmin/pgpass
@@ -0,0 +1 @@
+postgres:5432:*:postgres:postgres
diff --git a/tools/pgadmin/servers.json b/tools/pgadmin/servers.json
new file mode 100644
index 0000000..f5c986c
--- /dev/null
+++ b/tools/pgadmin/servers.json
@@ -0,0 +1,14 @@
+{
+  "Servers": {
+    "1": {
+      "Name": "PCQRSES PostgreSQL",
+      "Group": "Servers",
+      "Host": "postgres",
+      "Port": 5432,
+      "MaintenanceDB": "pcqrses_development",
+      "Username": "postgres",
+      "SSLMode": "prefer",
+      "PassFile": "/var/lib/pgadmin/storage/admin_example.com/pgpassfile"
+    }
+  }
+}

```

